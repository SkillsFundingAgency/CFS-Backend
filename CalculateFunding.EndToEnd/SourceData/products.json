[{"Name":"TEST","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\nDim ESGProtection_P01 As Decimal = Products.1718_ESG_Protection.ESGProtection_P01_1617RtoPost16\r\nDim ESGProtection_P02 As Decimal = Products.1718_ESG_Protection.ESGProtection_P02_1617NORlessHN\r\nDim ESGProtection_P03 As Decimal = Products.1718_ESG_Protection.ESGProtection_P03_1718RtoPost16\r\nDim ESGProtection_P04 As Decimal = Products.1718_ESG_Protection.ESGProtection_P04_1718NORlessHN\r\nDim ESGProtection_P05a As Decimal = Products.1718_ESG_Protection.ESGProtection_P05a_Mainstream_Ratio\r\nDim ESGProtection_P06 As Decimal = Products.1718_ESG_Protection.ESGProtection_P06_Place_Ratio\r\nDim ESGProtection_P07 As Decimal = Products.1718_ESG_Protection.ESGProtection_P07_1617SBS\r\nDim ESGProtection_P08 As Decimal = Products.1718_ESG_Protection.ESGProtection_P08_1617MFG                        \r\nDim ESGProtection_P09 As Decimal = Products.1718_ESG_Protection.ESGProtection_P09_1617ESGRecalc\r\nDim ESGProtection_P10 As Decimal = Products.1718_ESG_Protection.ESGProtection_P10_1617ESGProt_AP\r\nDim ESGProtection_P13 As Decimal = Products.1718_ESG_Protection.ESGProtection_P13_1617Post16ExlBursary\r\nDim ESGProtection_P14 As Decimal = Products.1718_ESG_Protection.ESGProtection_P14_1617AdjustUnitVal                     \r\nDim ESGProtection_P15 As Decimal = Products.1718_ESG_Protection.ESGProtection_P15_ESGRateChange        \r\nDim ESGProtection_P17 As Decimal = Products.1718_ESG_Protection.ESGProtection_P17_1718AdjustReductUnitVal                                   \r\nDim ESGProtection_P18 As Decimal = Products.1718_ESG_Protection.ESGProtection_P18_1718ReductionRate\r\nDim ESGProtection_P19 As Decimal = Products.1718_ESG_Protection.ESGProtection_P19_1617FundingRate\r\nDim ESGProtection_P20 As Decimal = Products.1718_ESG_Protection.ESGProtection_P20_TaperCond1                            \r\nDim ESGProtection_P21 As Decimal = Products.1718_ESG_Protection.ESGProtection_P21_TaperThresh1\r\nDim ESGProtection_P22 As Decimal = Products.1718_ESG_Protection.ESGProtection_P22_TaperCond2\r\nDim ESGProtection_P23 As Decimal = Products.1718_ESG_Protection.ESGProtection_P23_TaperThresh2\r\nDim ESGProtection_P24 As Decimal = Products.1718_ESG_Protection.ESGProtection_P24_TaperCond3\r\nDim ESGProtection_P27 As Decimal = Products.1718_ESG_Protection.ESGProtection_P27_FundingRate1\r\nDim ESGProtection_P28 As Decimal = Products.1718_ESG_Protection.ESGProtection_P28_FundingRate2\r\nDim ESGProtection_P29 As Decimal = Products.1718_ESG_Protection.ESGProtection_P29_FundingRate3\r\nDim ESGProtection_P30 As Decimal = Products.1718_ESG_Protection.ESGProtection_P30_AllocRedFloor\r\nDim ESGProtection_P31 As Decimal = Products.1718_ESG_Protection.ESGProtection_P31_FallBelowFloor\r\nDim ESGProtection_P32 As Decimal = Products.1718_ESG_Protection.ESGProtection_P32_ESG_MainstreamProtection\r\nDim ESGProtection_P33 As Decimal = Products.1718_ESG_Protection.ESGProtection_P33_Total1617HNPlaces\r\nDim ESGProtection_P34 As Decimal = Products.1718_ESG_Protection.ESGProtection_P34_1617SpecHospHNPlaces\r\nDim ESGProtection_P35 As Decimal = Products.1718_ESG_Protection.ESGProtection_P35_1617APPlaces\r\nDim ESGProtection_P37 As Decimal = Products.1718_ESG_Protection.ESGProtection_P37_1718SpecHospHNPlaces\r\nDim ESGProtection_P38 As Decimal = Products.1718_ESG_Protection.ESGProtection_P38_1718APPlaces\r\nDim ESGProtection_P39a As Decimal = Products.1718_ESG_Protection.ESGProtection_P39a_1617SpHopsHNBAlloc\r\nDim ESGProtection_P39b As Decimal = Products.1718_ESG_Protection.ESGProtection_P39b_1617APHNBAlloc\r\nDim ESGProtection_P40 As Decimal = Products.1718_ESG_Protection.ESGProtection_P40_1617SPHospESGRecalc\r\nDim ESGProtection_P41 As Decimal = Products.1718_ESG_Protection.ESGProtection_P41_1617APESGRecalc\r\nDim ESGProtection_P42 As Decimal = Products.1718_ESG_Protection.ESGProtection_P42_1617ESGProt\r\nDim ESGProtection_P45 As Decimal = Products.1718_ESG_Protection.ESGProtection_P45_1617Post16ExlBursary\r\nDim ESGProtection_P46 As Decimal = Products.1718_ESG_Protection.ESGProtection_P46_1617SpTotalAdjustUnitVal\r\nDim ESGProtection_P47 As Decimal = Products.1718_ESG_Protection.ESGProtection_P47_1617APTotalAdjustUnitVal\r\nDim ESGProtection_P48 As Decimal = Products.1718_ESG_Protection.ESGProtection_P48_SpHospESGRateChange\r\nDim ESGProtection_P49 As Decimal = Products.1718_ESG_Protection.ESGProtection_P49_APESGRateChange\r\nDim ESGProtection_P50 As Decimal = Products.1718_ESG_Protection.ESGProtection_P50_SpHosp1617ESGProt\r\nDim ESGProtection_P51 As Decimal = Products.1718_ESG_Protection.ESGProtection_P51_AP1617ESGProt\r\nDim ESGProtection_P52 As Decimal = Products.1718_ESG_Protection.ESGProtection_P52_SpHospAdjReductUnitValu\r\nDim ESGProtection_P53 As Decimal = Products.1718_ESG_Protection.ESGProtection_P53_APAdjReductUnitVal\r\nDim ESGProtection_P54 As Decimal = Products.1718_ESG_Protection.ESGProtection_P54_SpHosp1718ReductionRate\r\nDim ESGProtection_P55 As Decimal = Products.1718_ESG_Protection.ESGProtection_P55_AP1718ReductionRate\r\nDim ESGProtection_P56 As Decimal = Products.1718_ESG_Protection.ESGProtection_P56_SpHosp1617FundingRate\r\nDim ESGProtection_P57 As Decimal = Products.1718_ESG_Protection.ESGProtection_P57_AP1617FundingRate\r\nDim ESGProtection_P58 As Decimal = Products.1718_ESG_Protection.ESGProtection_P58_SpHospTaperThresh1\r\nDim ESGProtection_P59 As Decimal = Products.1718_ESG_Protection.ESGProtection_P59_APTaperThresh1\r\nDim ESGProtection_P60 As Decimal = Products.1718_ESG_Protection.ESGProtection_P60_SpHospTaperThresh2\r\nDim ESGProtection_P61 As Decimal = Products.1718_ESG_Protection.ESGProtection_P61_APTaperThresh2\r\nDim ESGProtection_P62 As Decimal = Products.1718_ESG_Protection.ESGProtection_P62_SpHospFundingRate1\r\nDim ESGProtection_P63 As Decimal = Products.1718_ESG_Protection.ESGProtection_P63_APFundingRate1\r\nDim ESGProtection_P64 As Decimal = Products.1718_ESG_Protection.ESGProtection_P64_SpHospFundingRate2\r\nDim ESGProtection_P65 As Decimal = Products.1718_ESG_Protection.ESGProtection_P65_APFundingRate2\r\nDim ESGProtection_P66 As Decimal = Products.1718_ESG_Protection.ESGProtection_P66_SpHospFundingRate3\r\nDim ESGProtection_P67 As Decimal = Products.1718_ESG_Protection.ESGProtection_P67_APFundingRate3\r\nDim ESGProtection_P68 As Decimal = Products.1718_ESG_Protection.ESGProtection_P68_SpHospAllocRedFloor\r\nDim ESGProtection_P69 As Decimal = Products.1718_ESG_Protection.ESGProtection_P69_APAllocRedFloor\r\nDim ESGProtection_P70 As Decimal = Products.1718_ESG_Protection.ESGProtection_P70_SpHospFallBelowFloor\r\nDim ESGProtection_P71 As Decimal = Products.1718_ESG_Protection.ESGProtection_P71_APFallBelowFloor\r\nDim ESGProtection_P72 As Decimal = Products.1718_ESG_Protection.ESGProtection_P72_SpHospESGProtection\r\nDim ESGProtection_P73 As Decimal = Products.1718_ESG_Protection.ESGProtection_P73_APESGProtection\r\nDim ESGProtection_P74 As Decimal = Products.1718_ESG_Protection.ESGProtection_P74_TotalESG_PlaceLedProtection\r\nDim ESGProtection_P75 As Decimal = Products.1718_ESG_Protection.ESGProtection_P75_Overall_ESGPAllocation\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"My Products","DecimalPlaces":0},{"Name":"ESGProtection_P01_1617RtoPost16","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Post16_AP_Prov As Decimal = Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    Dim acadfilter As Decimal =     Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim OpeningDate As Date =       Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim NOR35 As Decimal =          Products.1718_NOR.NOR_P35_1617_BaseNOR_ESGProt\r\n    Dim NOR35b As Decimal =         Products.1718_NOR.NOR_P35b_1617_BaseNOR_ESGProtincHN\r\n    Dim HNPlaces As Decimal =       [DataSets.Academy_Allocations.AY_2016/17.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2015/16]\r\n    Dim NOR18 As Decimal =          Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P18_NOR_HNP_HN_Pre16\r\n    Dim NOR19 As Decimal =          Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P19_NOR_HNP_AP_Pre16\r\n    Dim NOR20 As Decimal =          Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P20_NOR_HNP_Hosp_Pl\r\n    Dim TotalESGNOR As Decimal =    999 \r\n    Dim NORReceptionUplift As Decimal = 999  \r\n    Dim NurseryNOR As Decimal =     999             \r\n          \r\nIf acadfilter = 1 Then\r\n\r\n    If Post16_AP_Prov = 1 Then \r\n    \r\n        result = NOR35\r\n\r\n    Else \r\n\r\n        If OpeningDate > \"31 March 2016\" And OpeningDate < \"01 April 2017\" THEN                  \r\n        \r\n            result = ((NOR35b - HNPlaces) + (NOR18 + NOR19 + NOR20))\r\n\r\n        ELSE\r\n\r\n            If  OpeningDate > \"31 March 2017\" And OpeningDate < \"01 September 2017\" THEN\r\n\r\n                result = (TotalESGNOR + NORReceptionUplift - NurseryNOR)\r\n\r\n            ELSE         \r\n   \r\n                    result = NOR35b \r\n                \r\n            End If \r\n        \r\n        End If \r\n        \r\n    End If     \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P02_1617NORlessHN","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR35 As Decimal = Products.1718_NOR.NOR_P35_1617_BaseNOR_ESGProt\r\n    Dim TotalESGNOR As Decimal = 999\r\n    Dim ReceptionUplift As Decimal = 999 \r\n    Dim HNPlaces As Decimal = 999 \r\n    Dim NurseryNOR As Decimal = 999\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim OpenDate As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    If OpenDate > \"31 March 2017\" And OpenDate < \"01 September 2017\" THEN\r\n \r\n        result = (TotalESGNOR + ReceptionUplift - HNPlaces - NurseryNOR) \r\n\r\n    Else\r\n\r\n        result = NOR35                                         \r\n\r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n\r\n    Return result \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P05a_Mainstream_Ratio","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal =     Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim Post16APFilter As Decimal = Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    Dim NORHNPHosp As Decimal =     Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P20_NOR_HNP_Hosp_Pl\r\n    Dim NORP16HN As Decimal =       Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P21b_NOR_P16_HN\r\n    Dim NORP16 As Decimal =         Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P21_NOR_P16\r\n    Dim NORHNPHNPre16 As Decimal =  Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P18_NOR_HNP_HN_Pre16\r\n    Dim NORHNPAPPre16 As Decimal =  Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P19_NOR_HNP_AP_Pre16 \r\n    \r\nIf acadfilter = 1 Then \r\n\r\n        If Post16APFilter = 1 Then \r\n            result = (NORP16 / (NORP16 + NORHNPAPPre16 + NORHNPHNPre16 + NORHNPHosp + NORP16HN)) \r\n\r\n        ELSE\r\n\r\n            result = 1\r\n    \r\n        End If \r\n\r\nElse \r\n    \r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n                                                                                                  ","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P06_Place_Ratio","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR36 As Decimal = 999\r\n    Dim NOR37 As Decimal = 999\r\n    Dim NOR38 As Decimal = 999\r\n    Dim NOR41 As Decimal = 999\r\n    Dim NOR40 As Decimal = 999\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\n    If acadfilter = 1 Then     \r\n     \r\n        result = ((NOR36 + NOR37 + NOR38 + NOR41) / (NOR40 + NOR36 + NOR37 + NOR38 + NOR41))  \r\n    \r\n    Else \r\n    \r\n        exclude(rid)\r\n        \r\n    End If     \r\n\r\n    Return result\r\n\r\nEnd Function\r\n                                                                                     ","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P07_1617SBS","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim acadfilter As Decimal =         Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim SBSFundingTotal As Decimal =    Persisted.Report_AY1617_Acad_SBS:Totals_Report.P288_SBSFundingTotal\r\n    Dim TotalSchoolBudgetShare As Decimal = 999\r\n    Dim DateOpened As Date =            Datasets.Administration.Providers.Provider_Information.Date_Opened \r\n\r\nIf acadfilter = 1 Then \r\n        \r\n        If DateOpened > \"31 March 2017\" And DateOpened < \"01 September 2017\" THEN    \r\n    \r\n            result = TotalSchoolBudgetShare\r\n\r\n        ELSE\r\n \r\n            result = SBSFundingTotal \r\n        \r\n        End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\n\r\nEnd Function                                                                                    ","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P08_1617MFG","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result = 0 'change to As String if text product\r\n    \r\n    Dim OpeningDate As Date =                   Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim MFG_TotalOverallNetAdj As Decimal =     Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P65_TotalOverallNetAdj\r\n    Dim MFG_IYNetAdjFromAPT As Decimal =        Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P61_IYNetAdjFromAPT\r\n    Dim MFG_NORfromAPT As Decimal =             Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P55_NORfromAPT \r\n    Dim MFG_IY1617AdjNOR As Decimal =           Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P60_IY1617AdjNOR\r\n    Dim MFG_Funding As Decimal =                999 \r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    \r\n    print(OpeningDate,\"OpeningDate\",rid)\r\n    print(MFG_TotalOverallNetAdj,\"MFG1617IYOfullyear\",rid)\r\n    print(MFG_IYNetAdjFromAPT,\"MFG1617InYearAdjust\",rid)\r\n    print(MFG_NORfromAPT,\"NORfromAPT\",rid)\r\n    print(MFG_IY1617AdjNOR,\"AdjustNOR\",rid)\r\n    print(acadfilter,\"Acadfilter\",rid)\r\n    \r\nIf acadfilter = 1 Then \r\n\r\n    If OpeningDate < \"01 April 2016\" THEN   \r\n\r\n        result = MFG_TotalOverallNetAdj    \r\n    \r\n    Else    \r\n\r\n        If OpeningDate > \"31 March 2016\" And OpeningDate < \"31 March 2017\" THEN\r\n            \r\n            result = MFG_IYNetAdjFromAPT * MFG_IY1617AdjNOR / MFG_NORfromAPT\r\n        \r\n        Else\r\n\r\n            If OpeningDate > \"31 March 2017\" And OpeningDate < \"01 September 2017\" THEN\r\n\r\n                result = MFG_Funding\r\n    \r\n            Else \r\n            \r\n                exclude(rid)\r\n\r\n            End If \r\n\r\n        End If\r\n    \r\n    End If     \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n                                                   \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P09_1617ESGRecalc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar18 As Decimal = Products.1718_Global_Variables.P018_ESG_Main_APP_1617\r\n    Dim ESGP1_RtoPost16 As Decimal = Products.1718_ESG_Protection.ESGProtection_P01_1617RtoPost16\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n   \r\nIf acadfilter = 1 Then \r\n\r\n    result = ESGP1_RtoPost16 * GVar18\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P10_1617ESGProt_AP","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim APFilter As Decimal = Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    \r\n    Dim ESG_MainstreamProtection As Decimal =   Persisted.Report_AY1617_Acad_ESGProtection:Data_Output.P32_ESG_MainstreamProtection\r\n    Dim SpHospESGProtection As Decimal =        Persisted.Report_AY1617_Acad_ESGProtection:Data_Output.P72_SpHospESGProtection\r\n    Dim APESGProtection As Decimal =            Persisted.Report_AY1617_Acad_ESGProtection:Data_Output.P73_APESGProtection\r\n    Dim OutcomeAdjTotal As Decimal =            DataSets.Academy_Allocations.AY_2016/17.EFA_Adjustments.EFA_Adjustments.ESG_protection_outcome_adjustment_total\r\n    Dim ESGP_MainstreamRatio As Decimal =       Products.1718_ESG_Protection.ESGProtection_P05a_Mainstream_Ratio\r\n    Dim Sum As Decimal = ESG_MainstreamProtection + SpHospESGProtection + APESGProtection + OutcomeAdjTotal\r\n    Dim Prov_SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n\r\n\r\n \r\nPrint(acadFilter, \"AcadFilter\", rid)\r\nPrint(APFilter, \"APFilter\", rid)\r\nPrint(ESGP_MainstreamRatio, \"Ratio\", rid)\r\nPrint(Sum, \"Sum\", rid)\r\n\r\nIf acadfilter = 1 then\r\n\r\n        If APFilter = 1 Then \r\n        \r\n            result = ESGP_MainstreamRatio * Sum\r\n\r\n        Else \r\n\r\n            result = Sum\r\n                                                                                                                   \r\n        End If  \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n                                                                                        ","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P13_1617Post16ExlBursary","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Allocation1619 As Decimal = Persisted.Report_AY1617_Acad_Post16:Post16_AY201617_Report.P08_1619Allocation\r\n    Dim PostApril_Allocation16to19 As Decimal = 999\r\n    Dim acadfilter As Decimal =     Products.1718_Global_Variables.F602_ESGProtection_Mainstream   \r\n\r\n    Dim ConvertDate As Date =       Datasets.Administration.Providers.Provider_Information.Convert_Date\r\n    Dim OpenDate As Date =          Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim DateUsed As Date =          \"1 September 2017\"\r\n    Dim DaysOpen1617 As Decimal =   Persisted.Report_AY1617_Acad_GlobalVariables:Data_Output_Variables.P27_DaysOpen\r\n    Dim MonthsOpen1617 As Decimal = 0  \r\n    Dim MonthsUsed As Decimal =     0 \r\n    \r\nIf ConvertDate >= OpenDate Then \r\n    DateUsed = ConvertDate\r\nElse \r\n    DateUsed = OpenDate\r\nEnd If \r\n\r\nMonthsOpen1617 = DateDiff(\"m\", DateUsed, \"1 September 2017\")\r\n\r\nIf acadfilter = 1 Then\r\n\r\n        If OpenDate > \"31 March 2017\" And OpenDate < \"01 September 2017\" THEN\r\n    \r\n            result = PostApril_Allocation16to19 / MonthsOpen1617 * 12\r\n        \r\n        ELSE\r\n           \r\n           If MonthsOpen1617 < 12 THEN\r\n                \r\n                result = (Allocation1619 / MonthsOpen1617 * 12)\r\n    \r\n           ELSE            \r\n    \r\n                result = Allocation1619  \r\n        \r\n           End If \r\n            \r\n        End If \r\n \r\n Else \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P14_1617AdjustUnitVal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_NORlessHN As Decimal =         Products.1718_ESG_Protection.ESGProtection_P02_1617NORlessHN\r\n    Dim ESGP_RtoPost16 As Decimal =         Products.1718_ESG_Protection.ESGProtection_P01_1617RtoPost16\r\n    Dim ESGP_SBS As Decimal =               Products.1718_ESG_Protection.ESGProtection_P07_1617SBS\r\n    Dim ESGP_MFG As Decimal =               Products.1718_ESG_Protection.ESGProtection_P08_1617MFG\r\n    Dim ESGP_ESGRecalc As Decimal =         Products.1718_ESG_Protection.ESGProtection_P09_1617ESGRecalc\r\n    Dim ESGP_AllocProt As Decimal =         Products.1718_ESG_Protection.ESGProtection_P10_1617ESGProt_AP\r\n    Dim ESGP_Post16ExlBursary As Decimal =  Products.1718_ESG_Protection.ESGProtection_P13_1617Post16ExlBursary\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n              \r\n    If ESGP_RtoPost16 = 0 AND ESGP_NORlessHN = 0 THEN    \r\n\r\n        result = 0\r\n\r\n    ELSE\r\n            \r\n        result = ((ESGP_SBS + ESGP_MFG + ESGP_Post16ExlBursary) / ESGP_NORlessHN) + ((ESGP_ESGRecalc + ESGP_AllocProt) / ESGP_RtoPost16)\r\n       \r\n    End If \r\n \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n                                                      ","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"1_Mainstream Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P03_1718RtoPost16","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Post16_AP_Prov As Decimal = Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    Dim NOR32b As Decimal = Products.1718_NOR.NOR_P32b_TOTAL_ESGProt_incHN\r\n    Dim NOR32 As Decimal = Products.1718_NOR.NOR_P32_Total_NOR_ESGProt\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n        \r\nIf acadfilter = 1 Then         \r\n        \r\n    If Post16_AP_Prov = 1 THEN\r\n    \r\n        result = NOR32\r\n\r\n    ELSE\r\n \r\n        result = NOR32b\r\n        \r\n    End If \r\n \r\n Else \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P04_1718NORlessHN","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR32 As Decimal =  Products.1718_NOR.NOR_P32_Total_NOR_ESGProt\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n   \r\nIf acadfilter = 1 Then \r\n\r\n    result = NOR32\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n    \r\n    Return result\r\nEnd Function\r\n                                                                                        ","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P15_ESGRateChange","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar19 As Decimal =  Products.1718_Global_Variables.P019_ESGP_Main_Rate_Change\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    result = GVar19\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n    \r\n    Return result\r\nEnd Function\r\n                           ","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P17_1718AdjustReductUnitVal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_ESGRateChange As Decimal = Products.1718_ESG_Protection.ESGProtection_P15_ESGRateChange\r\n    Dim ESGP_AllocProt As Decimal = Products.1718_ESG_Protection.ESGProtection_P10_1617ESGProt_AP\r\n    Dim ESGP_RtoPost16 As Decimal = Products.1718_ESG_Protection.ESGProtection_P03_1718RtoPost16\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    \r\nIf acadfilter = 1 Then     \r\n     \r\n    If ESGP_RtoPost16 = 0 THEN\r\n        \r\n        result = 0\r\n    \r\n    ELSE\r\n            \r\n        result = ESGP_ESGRateChange + ((ESGP_AllocProt * -1) / ESGP_RtoPost16)\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P18_1718ReductionRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_AdjustUnitVal As Decimal =     Products.1718_ESG_Protection.ESGProtection_P17_1718AdjustReductUnitVal\r\n    Dim ESGP_AdjustUnitValue As Decimal =   Products.1718_ESG_Protection.ESGProtection_P14_1617AdjustUnitVal\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then  \r\n \r\n    If ESGP_AdjustUnitValue = 0 THEN\r\n        \r\n        result = 0\r\n    \r\n    ELSE\r\n\r\n        result = (ESGP_AdjustUnitVal / ESGP_AdjustUnitValue)\r\n\r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P19_1617FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_ESGRecalc As Decimal = Products.1718_ESG_Protection.ESGProtection_P09_1617ESGRecalc\r\n    Dim ESGP_AllocProt As Decimal = Products.1718_ESG_Protection.ESGProtection_P10_1617ESGProt_AP\r\n    Dim ESGP_RtoPost16 As Decimal = Products.1718_ESG_Protection.ESGProtection_P01_1617RtoPost16\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n                 \r\nIf acadfilter = 1 Then                  \r\n                 \r\n    If ESGP_RtoPost16 = 0 THEN\r\n        \r\n        result = 0    \r\n\r\n    ELSE\r\n            \r\n        result = (ESGP_ESGRecalc + ESGP_AllocProt) /  ESGP_RtoPost16\r\n\r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P20_TaperCond1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar07 As Decimal =Products.1718_Global_Variables.P007_ESGP_Cond1\r\n    'Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n \r\n'If acadfilter = 1 Then \r\n\r\n    result = GVar07\r\n\r\n'Else \r\n\r\n'    exclude(rid)\r\n    \r\n'End If\r\n\r\n    Return result\r\nEnd Function\r\n                                                                                ","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P21_TaperThresh1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar10 As Decimal =Products.1718_Global_Variables.P010_ESGP_Main_Thresh1\r\n    Dim acadfilter  As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n\r\n        result = GVar10\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n    \r\n    Return result\r\nEnd Function                                \r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGPRotection_P22_TaperCond2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar8 As Decimal = Products.1718_Global_Variables.P008_ESGP_Cond2\r\n    'Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\n'If acadfilter = 1 Then \r\n    \r\n    result = GVar8\r\n \r\n'Else \r\n\r\n'    exclude(rid)\r\n    \r\n'End If\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P23_TaperThresh2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar11 As Decimal =Products.1718_Global_Variables.P011_ESGP_Main_Thresh2\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n\r\n        result = GVar11\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P24_TaperCond3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar09 As Decimal =Products.1718_Global_Variables.P009_ESGP_Cond3\r\n   ' Dim acadfilter As Decimal = Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    \r\n'If acadfilter = 1 Then     \r\n             \r\n    result = GVar09\r\n \r\n'Else \r\n\r\n'    exclude(rid)\r\n    \r\n'End If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"2_Mainstream Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P27_FundingRate1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_FundingRate As Decimal =   Products.1718_ESG_Protection.ESGProtection_P19_1617FundingRate\r\n    Dim ESGP_TaperCond1 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P20_TaperCond1\r\n    Dim ESGP_TaperThresh1 As Decimal =  Products.1718_ESG_Protection.ESGProtection_P21_TaperThresh1\r\n    Dim acadfilter As Decimal =         Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim Minimum As Decimal =            0\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    If ESGP_FundingRate = 0 THEN\r\n        \r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        If ESGP_TaperThresh1 > ESGP_FundingRate Then \r\n            Minimum = ESGP_FundingRate\r\n        Else \r\n            Minimum = ESGP_TaperThresh1\r\n        End If \r\n        \r\n        Result = -1 * ( Minimum / ESGP_FundingRate) * ESGP_TaperCond1\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"3_Mainstream ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P28_FundingRate2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_FundingRate As Decimal =   Products.1718_ESG_Protection.ESGProtection_P19_1617FundingRate\r\n    Dim ESGP_TaperThresh1 As Decimal =  Products.1718_ESG_Protection.ESGProtection_P21_TaperThresh1\r\n    Dim ESGP_TaperCond2 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P22_TaperCond2\r\n    Dim ESGP_TaperThresh2 As Decimal =  Products.1718_ESG_Protection.ESGProtection_P23_TaperThresh2\r\n    Dim acadfilter As Decimal =         Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim Minimum As Decimal = 0 \r\n\r\nIf acadfilter = 1 Then \r\n\r\n    If ESGP_FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        If (ESGP_TaperThresh2 - ESGP_TaperThresh1) > (ESGP_FundingRate - ESGP_TaperThresh1) Then \r\n            \r\n            Minimum = ESGP_FundingRate - ESGP_TaperThresh1\r\n            \r\n        Else \r\n\r\n            Minimum = ESGP_TaperThresh2 - ESGP_TaperThresh1\r\n        \r\n        End If \r\n\r\n        result = -1 * (Minimum / ESGP_FundingRate) * ESGP_TaperCond2  \r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"3_Mainstream ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P29_FundingRate3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_FundingRate As Decimal =   Products.1718_ESG_Protection.ESGProtection_P19_1617FundingRate\r\n    Dim ESGP_TaperThresh2 As Decimal =  Products.1718_ESG_Protection.ESGProtection_P23_TaperThresh2\r\n    Dim ESGP_TaperCond3 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P24_TaperCond3\r\n    Dim acadfilter As Decimal =         Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    Dim Maximum As Decimal =            0\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    If ESGP_FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n    \r\n        If 0 > (ESGP_FundingRate - ESGP_TaperThresh2) Then \r\n            \r\n            Maximum  = 0\r\n        \r\n        Else \r\n            \r\n            Maximum = (ESGP_FundingRate - ESGP_TaperThresh2) \r\n        \r\n        End If \r\n\r\n        result = -1 * (Maximum / ESGP_FundingRate) * ESGP_TaperCond3\r\n        'result = -1 * (Math.Max(0, ESGP_FundingRate - ESGP_TaperThresh2) / ESGP_FundingRate) * ESGP_TaperCond3\r\n    \r\n    End If \r\n \r\n Else \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"3_Mainstream ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P30_AllocRedFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product \r\n    Dim ESGP_FundingRate1 As Decimal = Products.1718_ESG_Protection.ESGProtection_P27_FundingRate1\r\n    Dim ESGP_FundingRate2 As Decimal = Products.1718_ESG_Protection.ESGProtection_P28_FundingRate2\r\n    Dim ESGP_FundingRate3 As Decimal = Products.1718_ESG_Protection.ESGProtection_P29_FundingRate3\r\n    Dim acadfilter As Decimal =        Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    result = (ESGP_FundingRate1 + ESGP_FundingRate2 + ESGP_FundingRate3)\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"3_Mainstream ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P31_FallBelowFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_ReductionRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P18_1718ReductionRate\r\n    Dim ESGP_AllocRedFloor As Decimal = Products.1718_ESG_Protection.ESGProtection_P30_AllocRedFloor\r\n    Dim acadfilter As Decimal =         Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n\r\nIf acadfilter = 1 Then \r\n        \r\n    If ESGP_AllocRedFloor < ESGP_ReductionRate THEN \r\n\r\n        result = 0 \r\n\r\n    ELSE\r\n\r\n        result = ESGP_AllocRedFloor - ESGP_ReductionRate\r\n     \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"3_Mainstream ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P32_ESG_MainstreamProtection","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_RtoPost16 As Decimal =         Products.1718_ESG_Protection.ESGProtection_P03_1718RtoPost16\r\n    Dim ESGP_AdjustUnitVal As Decimal =     Products.1718_ESG_Protection.ESGProtection_P14_1617AdjustUnitVal\r\n    Dim ESGP_FallBelowFloor As Decimal =    Products.1718_ESG_Protection.ESGProtection_P31_FallBelowFloor\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F602_ESGProtection_Mainstream\r\n    \r\nIf acadfilter = 1 Then     \r\n         \r\n    result = ESGP_FallBelowFloor * ESGP_AdjustUnitVal * ESGP_RtoPost16\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"4_Mainstream Totals","DecimalPlaces":10},{"Name":"ESGProtection_P33_Total1617HNPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_Pre16HN As Decimal = Products.1718_NOR.NOR_P36_1617_pre16_HN\r\n    Dim NOR_Pre16AP As Decimal = Products.1718_NOR.NOR_P37_1617_pre16_AP\r\n    Dim NOR_HospPlaces As Decimal = Products.1718_NOR.NOR_P38_1617_HN_Hosp_Pl\r\n    Dim NOR_Post16HN As Decimal = Products.1718_NOR.NOR_P41_1617_Post16_HN\r\n    Dim HN_Places As Decimal = 999\r\n    Dim Post16_HN_Places As Decimal = 999\r\n    Dim AP_PLaces As Decimal = 999\r\n    Dim Hospital_Places As Decimal = 999\r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n\r\nIf acadfilter = 1 Then \r\n\r\n    If DateOpened > \"31 March 2017\" And DateOpened < \"01 September 2017\" THEN\r\n\r\n        result = HN_Places + Post16_HN_Places + AP_Places + Hospital_Places\r\n\r\n    ELSE            \r\n\r\n        result = NOR_Pre16HN + NOR_Pre16AP + NOR_HospPlaces + NOR_Post16HN\r\n    \r\n    End If\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P34_1617SpecHospHNPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_Pre16HN As Decimal =Products.1718_NOR.NOR_P36_1617_pre16_HN\r\n    Dim NOR_HospPlaces As Decimal =Products.1718_NOR.NOR_P38_1617_HN_Hosp_Pl\r\n    Dim NOR_Post16HN As Decimal =Products.1718_NOR.NOR_P41_1617_Post16_HN\r\n    Dim HN_Places As Decimal = 999\r\n    Dim Post16_HN_Places As Decimal = 999\r\n    Dim Hospital_Places As Decimal = 999\r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    If DateOpened > \"31 March 2017\" And DateOpened < \"01 September 2017\" THEN \r\n\r\n        result = HN_Places + Post16_HN_Places + Hospital_Places\r\n\r\n    ELSE\r\n                     \r\n        result = NOR_Pre16HN + NOR_HospPlaces + NOR_Post16HN\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P35_1617APPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_pre16AP As Decimal = Products.1718_NOR.NOR_P37_1617_pre16_AP\r\n    Dim AP_Places As Decimal = 999\r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    If DateOpened > \"31 March 2017\" And DateOpened < \"01 September 2017\" THEN\r\n\r\n        result = AP_Places\r\n\r\n    ELSE\r\n    \r\n        result = NOR_pre16AP\r\n    \r\n    End if\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P39a_1617SpHopsHNBAlloc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim MonthsOpen As Decimal = Products.1718_Global_Variables.P028_MonthsOpen\r\n    Dim Hosp_Funding As Decimal = Persisted.Report_AY1617_Acad_HN:High_Needs_AY201617_Report.P10_Hosp_Funding_FY\r\n    Dim HN_Pre16FYFunding As Decimal = Persisted.Report_AY1617_Acad_HN:High_Needs_AY201617_Report.P15_HN_Pre16_FYFunding\r\n    Dim HN_Post16FYFunding As Decimal = Persisted.Report_AY1617_Acad_HN:High_Needs_AY201617_Report.P23_HN_Post16_IYFunding\r\n    Dim HN_Funding As Decimal = 999\r\n    Dim Post16HN_TotalAllocationFY As Decimal = 999\r\n    Dim PostAprilHosp As Decimal = 999 \r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim ConvertDate As Date = Datasets.Administration.Providers.Provider_Information.Convert_Date\r\n    Dim DateUsed As Date = \"1 September 2017\"\r\n    Dim MonthsOpen1617 As Decimal = 0\r\n    Dim HNPost16 As Decimal = 0\r\n    \r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n\r\nIf ConvertDate >= DateOpened Then \r\n    DateUsed = ConvertDate\r\nElse \r\n    DateUsed = DateOpened\r\nEnd If \r\n\r\nMonthsOpen1617 = DateDiff(\"m\", DateUsed, \"1 September 2017\")\r\n\r\nIf MonthsOpen1617 < 12 Then \r\n    HNPost16 = HN_Post16FYFunding / MonthsOpen1617 * 12\r\nElse \r\n    HNPost16 = HN_Post16FYFunding\r\nEnd If \r\n\r\nDim HNFunding16 As Decimal = HN_Pre16FYFunding + HNPost16\r\n\r\n\r\nIf acadfilter = 1 Then\r\n    \r\n    If DateOpened > \"31 March 2017\" And DateOpened < \"01 September 2017\" THEN\r\n\r\n        result = HN_Funding + Post16HN_TotalAllocationFY + PostAprilHosp\r\n\r\n    Else\r\n     \r\n        result = HNFunding16 + Hosp_Funding\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P39b_1617APHNBAlloc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim FY_Funding As Decimal = Persisted.Report_AY1617_Acad_HN:High_Needs_AY201617_Report.P17_AP_Pre16_FYFunding\r\n    Dim AP_Funding As Decimal = 999\r\n    Dim DateOpen As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If DateOpen > \"31 March 2017\" And DateOpen < \"01 September 2017\" THEN\r\n\r\n        result = AP_Funding\r\n\r\n    ELSE\r\n\r\n        result = FY_Funding\r\n        \r\n    End if\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P40_1617SPHospESGRecalc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SpecHospHNPlaces As Decimal = Products.1718_ESG_Protection.ESGProtection_P34_1617SpecHospHNPlaces\r\n    Dim GVar23 As Decimal =Products.1718_Global_Variables.P023_ESG_HN_APP_1617\r\n        Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    result = ESGP_SpecHospHNPlaces * GVar23\r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P41_1617APESGRecalc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APPlaces As Decimal = Products.1718_ESG_Protection.ESGProtection_P35_1617APPlaces\r\n    Dim GVar24 As Decimal =Products.1718_Global_Variables.P024_ESG_AP_APP_1617\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result = ESGP_APPlaces * GVar24\r\n\r\nElse \r\n    \r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P42_1617ESGProt","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ESGP_PlaceRatio As Decimal =            Products.1718_ESG_Protection.ESGProtection_P06_Place_Ratio\r\n    Dim ESG_MainstreamProtection As Decimal =   Persisted.Report_AY1617_Acad_ESGProtection:Data_Output_Mainstream.P32_ESG_MainstreamProtection\r\n    Dim SpHospESGProtection As Decimal =        Persisted.Report_AY1617_Acad_ESGProtection:Data_Output.P72_SpHospESGProtection\r\n    Dim APESGProtection As Decimal =            Persisted.Report_AY1617_Acad_ESGProtection:Data_Output.P73_APESGProtection\r\n    Dim OutcomeAdjTotal As Decimal =            DataSets.Academy_Allocations.AY_2016/17.EFA_Adjustments.EFA_Adjustments.ESG_protection_outcome_adjustment_total\r\n    Dim AP_Post16_Provider As Decimal =         Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    'Dim Subtype As String =                    Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim Sum As Decimal =                        ESG_MainstreamProtection + SpHospESGProtection + APESGProtection + OutcomeAdjTotal\r\n    \r\nPrint(ESGP_PlaceRatio, \"P06\", rid)\r\nPrint(ESG_MainstreamProtection, \"PersistedP32\", rid)\r\nPrint(SpHospESGProtection, \"PersistedP72\", rid)\r\nPrint(APESGProtection, \"PersistedP73\", rid)\r\nPrint(OutcomeAdjTotal, \"DatasetsOutcomeAdjTotal\", rid)\r\nPrint(AP_Post16_Provider, \"F601\", rid)\r\nPrint(acadfilter, \"F603\", rid)\r\n'Print(Subtype, \"Subtype\", rid)\r\nPrint(Sum, \"Sum\", rid)\r\n    \r\n\r\n    If AP_Post16_Provider = 1 Then\r\n    \r\n        result = Sum * ESGP_PlaceRatio\r\n    \r\n    Else\r\n        \r\n        If acadfilter = 1 Then \r\n        \r\n            result = Sum\r\n    \r\n        Else \r\n        \r\n            exclude(rid)\r\n            \r\n        End If \r\n        \r\n    End If \r\n\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P45_1617Post16ExlBursary","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Allocation1619 As Decimal = Persisted.Report_AY1617_Acad_Post16:Post16_AY201617_Report.P08_1619Allocation\r\n    Dim MonthsOpen As Decimal = Products.1718_Global_Variables.P028_MonthsOpen\r\n    Dim AP_Post16_Provider As Decimal = Products.1718_Global_Variables.F601_ESGProtection_Post16onlyAP\r\n    Dim Allocation16to19 As Decimal =  999\r\n    Dim OpenDate As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim ConvertDate As Date = Datasets.Administration.Providers.Provider_Information.Convert_Date\r\n    Dim DateUsed As Date = \"1 September 2017\"\r\n    Dim MonthsOpen1617 As Decimal = 0\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n\r\n If ConvertDate >= OpenDate Then\r\n        DateUsed = ConvertDate\r\n        Else\r\n        DateUsed = OpenDate\r\n        End If\r\n        \r\nMonthsOpen1617 = DateDiff(\"m\", DateUsed, \"1 September 2017\")\r\n\r\nIf AP_Post16_Provider = 1 Then\r\n\r\n    result = 0\r\n\r\n    If acadfilter = 1 Then    \r\n       \r\n        ElseIf OpenDate > \"31 March 2017\" And OpenDate < \"01 September 2017\" THEN\r\n    \r\n            result = Allocation16to19 / MonthsOpen1617 * 12        \r\n    \r\n        ElseIf MonthsOpen1617 < 12 THEN\r\n        \r\n                result =  Allocation1619 / MonthsOpen1617 * 12\r\n            \r\n        Else\r\n                result = Allocation1619\r\n            \r\n        End If   \r\n    \r\n    Else \r\n    \r\n        exclude(rid)\r\n        \r\n    End If \r\n\r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P47_1617APTotalAdjustUnitVal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APHNB As Decimal =         Products.1718_ESG_Protection.ESGProtection_P39b_1617APHNBAlloc\r\n    Dim ESGP_APESGRecalc As Decimal =   Products.1718_ESG_Protection.ESGProtection_P41_1617APESGRecalc\r\n    Dim ESGP_ExclBursary As Decimal =   Products.1718_ESG_Protection.ESGProtection_P45_1617Post16ExlBursary\r\n    Dim ESGP_APPlaces As Decimal =      Products.1718_ESG_Protection.ESGProtection_P35_1617APPlaces\r\n    Dim ESGP_AllocProt As Decimal =     Products.1718_ESG_Protection.ESGProtection_P42_1617ESGProt\r\n    Dim ESGP_TotalHNPlaces As Decimal = Products.1718_ESG_Protection.ESGProtection_P33_Total1617HNPlaces\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    IF ESGP_APPlaces = 0 OR ESGP_TotalHNPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = ((ESGP_APHNB + ESGP_APESGRecalc) / ESGP_APPlaces) + ((ESGP_AllocProt + ESGP_ExclBursary) / ESGP_TotalHNPlaces)\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P46_1617SpTotalAdjustUnitVal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SpecHospHNB As Decimal =       Products.1718_ESG_Protection.ESGProtection_P39a_1617SpHopsHNBAlloc\r\n    Dim ESGP_SpecHospESGRecalc As Decimal = Products.1718_ESG_Protection.ESGProtection_P40_1617SPHospESGRecalc\r\n    Dim ESGP_ExclBursary As Decimal =       Products.1718_ESG_Protection.ESGProtection_P45_1617Post16ExlBursary\r\n    Dim ESGP_SpecHospHNPlaces As Decimal =  Products.1718_ESG_Protection.ESGProtection_P34_1617SpecHospHNPlaces\r\n    Dim ESGP_AllocProt As Decimal =         Products.1718_ESG_Protection.ESGProtection_P42_1617ESGProt\r\n    Dim ESGP_TotalHNPlaces As Decimal =     Products.1718_ESG_Protection.ESGProtection_P33_Total1617HNPlaces\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_SpecHospHNPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = ((ESGP_SpecHospHNB + ESGP_SpecHospESGRecalc) / ESGP_SpecHospHNPlaces) + ((ESGP_AllocProt + ESGP_ExclBursary) / ESGP_TotalHNPlaces) \r\n     \r\n    End If                                                        \r\n\r\nElse \r\n    \r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P50_SpHosp1617ESGProt","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SpecHospHNPlaces As Decimal =  Products.1718_ESG_Protection.ESGProtection_P34_1617SpecHospHNPlaces\r\n    Dim ESGP_ESGProt As Decimal =           Products.1718_ESG_Protection.ESGProtection_P42_1617ESGProt\r\n    Dim ESGP_HNPlaces As Decimal =          Products.1718_ESG_Protection.ESGProtection_P33_Total1617HNPlaces\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_HNPlaces = 0 OR ESGP_SpecHospHNPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_ESGProt / ESGP_HNPlaces) * ESGP_SpecHospHNPlaces\r\n        \r\n    End if\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P51_AP1617ESGProt","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APPlaces As Decimal =          Products.1718_ESG_Protection.ESGProtection_P35_1617APPlaces\r\n    Dim ESGP_ESGProt As Decimal =           Products.1718_ESG_Protection.ESGProtection_P42_1617ESGProt\r\n    Dim ESGP_Total1617HNPlaces As Decimal = Products.1718_ESG_Protection.ESGProtection_P33_Total1617HNPlaces\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_Total1617HNPlaces = 0 OR ESGP_APPlaces = 0 THEN \r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_ESGProt / ESGP_Total1617HNPlaces) * ESGP_APPlaces\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P52_SpHospAdjReductUnitValu","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_1718SpecHospHNPlaces As Decimal =  Products.1718_ESG_Protection.ESGProtection_P37_1718SpecHospHNPlaces\r\n    Dim ESGP_SpHospESGRateChange As Decimal =   Products.1718_ESG_Protection.ESGProtection_P48_SpHospESGRateChange\r\n    Dim ESGP_SpHosp1617ESGProt As Decimal =     Products.1718_ESG_Protection.ESGProtection_P50_SpHosp1617ESGProt\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_1718SpecHospHNPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_SpHospESGRateChange - (ESGP_SpHosp1617ESGProt / ESGP_1718SpecHospHNPlaces))\r\n    \r\n    End If \r\n     \r\n    Return result\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P53_APAdjReductUnitVal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APPlaces As Decimal =          Products.1718_ESG_Protection.ESGProtection_P38_1718APPlaces\r\n    Dim ESGP_APESGRateChange As Decimal =   Products.1718_ESG_Protection.ESGProtection_P49_APESGRateChange\r\n    Dim ESGP_AP1617ESGProt As Decimal =     Products.1718_ESG_Protection.ESGProtection_P51_AP1617ESGProt\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_APPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_APESGRateChange - (ESGP_AP1617ESGProt / ESGP_APPlaces))\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid) \r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P54_SpHosp1718ReductionRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_1617SpTotalAdjustUnitVal As Decimal = Products.1718_ESG_Protection.ESGProtection_P46_1617SpTotalAdjustUnitVal\r\n    Dim ESGP_SpHospAdjReductUnitValue As Decimal = Products.1718_ESG_Protection.ESGProtection_P52_SpHospAdjReductUnitValu\r\n    Dim acadfilter As Decimal =                    Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_1617SpTotalAdjustUnitVal = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_SpHospAdjReductUnitValue / ESGP_1617SpTotalAdjustUnitVal)\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P55_AP1718ReductionRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APTotalAdjUnitVal As Decimal = Products.1718_ESG_Protection.ESGProtection_P47_1617APTotalAdjustUnitVal\r\n    Dim ESGP_APAdjReductUnitVal As Decimal = Products.1718_ESG_Protection.ESGProtection_P53_APAdjReductUnitVal\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_APTotalAdjUnitVal = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_APAdjReductUnitVal / ESGP_APTotalAdjUnitVal)\r\n     \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"5_Place Led Baselines","DecimalPlaces":10},{"Name":"ESGProtection_P37_1718SpecHospHNPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR18 As Decimal =  Products.1718_NOR.NOR_P18_HND_HN_Pre16\r\n    Dim NOR20 As Decimal =  Products.1718_NOR.NOR_P20_HND_Hosp_Pl\r\n    Dim NOR21b As Decimal = Products.1718_NOR.NOR_P21b_P16_HN\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = NOR18 + NOR20 + NOR21b \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P38_1718APPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR19 As Decimal = Products.1718_NOR.NOR_P19_HND_AP_Pre16\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = NOR19\r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P48_SpHospESGRateChange","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVal20 As Decimal = Products.1718_Global_Variables.P020_ESGP_Special_Rate_Change\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = GVal20\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P49_APESGRateChange","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar21 As Decimal = Products.1718_Global_Variables.P021_ESGP_AP_Rate_Change\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result = GVar21\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P56_SpHosp1617FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_1617SpecHospHNPlaces As Decimal =  Products.1718_ESG_Protection.ESGProtection_P34_1617SpecHospHNPlaces\r\n    Dim ESGP_1617SPHospESGRecalc As Decimal =   Products.1718_ESG_Protection.ESGProtection_P40_1617SPHospESGRecalc\r\n    Dim ESGP_SpHosp1617AllocProt As Decimal =   Products.1718_ESG_Protection.ESGProtection_P50_SpHosp1617ESGProt\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    If ESGP_1617SpecHospHNPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_1617SPHospESGRecalc + ESGP_SpHosp1617AllocProt) / ESGP_1617SpecHospHNPlaces\r\n   \r\n    End If \r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P57_AP1617FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_1617APPlaces As Decimal =      Products.1718_ESG_Protection.ESGProtection_P35_1617APPlaces\r\n    Dim ESGP_1617APESGRecalc As Decimal =   Products.1718_ESG_Protection.ESGProtection_P41_1617APESGRecalc\r\n    Dim ESGP_AP1617ESGProt As Decimal =     Products.1718_ESG_Protection.ESGProtection_P51_AP1617ESGProt\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_1617APPlaces = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = (ESGP_1617APESGRecalc + ESGP_AP1617ESGProt) / ESGP_1617APPlaces\r\n\r\n    End If \r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"6_Place Led Current Year","DecimalPlaces":10},{"Name":"ESGProtection_P58_SpHospTaperThresh1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar14 As Decimal = Products.1718_Global_Variables.P014_ESGP_Special_Thresh1\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    result = GVar14\r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n\r\nEnd If \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"7_Place Led Protection","DecimalPlaces":10},{"Name":"ESGProtection_P59_APTaperThresh1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar12 As Decimal = Products.1718_Global_Variables.P012_ESGP_AP_Thresh1\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = GVar12 \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"7_Place Led Protection","DecimalPlaces":10},{"Name":"ESGProtection_P60_SpHospTaperThresh2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar15 As Decimal = Products.1718_Global_Variables.P015_ESGP_Special_Thresh2\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = GVar15\r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"7_Place Led Protection","DecimalPlaces":10},{"Name":"ESGProtection_P61_APTaperThresh2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GVar13 As Decimal = Products.1718_Global_Variables.P013_ESGP_AP_Thresh2\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    result = GVar13\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"7_Place Led Protection","DecimalPlaces":10},{"Name":"ESGProtection_P72_SpHospESGProtection","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SpecHospHNPlaces As Decimal =      Products.1718_ESG_Protection.ESGProtection_P37_1718SpecHospHNPlaces\r\n    Dim ESGP_SpTotalAdjustUnitVal As Decimal =  Products.1718_ESG_Protection.ESGProtection_P46_1617SpTotalAdjustUnitVal\r\n    Dim ESGP_SPHospFallBelowFloor As Decimal =  Products.1718_ESG_Protection.ESGProtection_P70_SpHospFallBelowFloor\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result = ESGP_SpHospFallBelowFloor * ESGP_SpTotalAdjustUnitVal * ESGP_SpecHospHNPlaces\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"9_Place Led Totals","DecimalPlaces":10},{"Name":"ESGProtection_P73_APESGProtection","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_1718APPlaces As Decimal = Products.1718_ESG_Protection.ESGProtection_P38_1718APPlaces\r\n    Dim ESGP_1617APTotalAdjustUnitVal As Decimal = Products.1718_ESG_Protection.ESGProtection_P47_1617APTotalAdjustUnitVal\r\n    Dim ESGP_APFallBelowFloor As Decimal = Products.1718_ESG_Protection.ESGProtection_P71_APFallBelowFloor\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then   \r\n    \r\n    result = ESGP_1718APPlaces * ESGP_1617APTotalAdjustUnitVal * ESGP_APFallBelowFloor\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"9_Place Led Totals","DecimalPlaces":10},{"Name":"ESGProtection_P74_TotalESG_PlaceLedProtection","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SPHospESGProtection As Decimal =   Products.1718_ESG_Protection.ESGProtection_P72_SpHospESGProtection\r\n    Dim ESGP_APESGProtection As Decimal =       Products.1718_ESG_Protection.ESGProtection_P73_APESGProtection\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result = ESGP_SPHospESGProtection + ESGP_APESGProtection\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"9_Place Led Totals","DecimalPlaces":10},{"Name":"ESGProtection_P75_Overall_ESGPAllocation","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_ESGMainstreamProtection As Decimal = Products.1718_ESG_Protection.ESGProtection_P32_ESG_MainstreamProtection\r\n    Dim ESGP_TotalESGProtection As Decimal = Products.1718_ESG_Protection.ESGProtection_P74_TotalESG_PlaceLedProtection\r\n    Dim ESGP_OutcomeAdjTotal As Decimal = [DataSets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.ESG_protection_outcome_adjustment_total]\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F600_ESGProtection_Academies\r\n   \r\n\r\nIf acadfilter = 1 Then \r\n    \r\n    result = ESGP_ESGMainstreamProtection + ESGP_TotalESGProtection + ESGP_OutcomeAdjTotal\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_ESG_Protection","FolderName":"10_ESG Protection Allocation","DecimalPlaces":10},{"Name":"ESGProtection_P62_SpHospFundingRate1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond1 As Decimal =            Products.1718_ESG_Protection.ESGProtection_P20_TaperCond1\r\n    Dim ESGP_SpHosp1617FundingRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P56_SpHosp1617FundingRate\r\n    Dim ESGP_SpHospTaperThresh1 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P58_SpHospTaperThresh1\r\n    Dim Minimum As Decimal =                    0\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_SpHosp1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    Else\r\n        \r\n        If ESGP_SpHospTaperThresh1 > ESGP_SpHosp1617FundingRate Then \r\n\r\n            Minimum = ESGP_SpHosp1617FundingRate\r\n        \r\n        Else \r\n        \r\n            Minimum = ESGP_SpHospTaperThresh1\r\n            \r\n        End If \r\n                   \r\n        result = -1 * (Minimum / ESGP_SpHosp1617FundingRate) * ESGP_TaperCond1\r\n    \r\n    End If \r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If  \r\n     \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P63_APFundingRate1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond1 As Decimal =Products.1718_ESG_Protection.ESGProtection_P20_TaperCond1\r\n    Dim ESGP_AP1617FundingRate As Decimal =Products.1718_ESG_Protection.ESGProtection_P57_AP1617FundingRate\r\n    Dim ESGP_APTaperThresh1 As Decimal =Products.1718_ESG_Protection.ESGProtection_P59_APTaperThresh1\r\n    Dim Minimum As Decimal = 0\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_AP1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    Else\r\n        \r\n        If ESGP_APTaperThresh1 > ESGP_AP1617FundingRate Then \r\n        \r\n            Minimum =  ESGP_AP1617FundingRate \r\n            \r\n        Else\r\n        \r\n            Minimum = ESGP_APTaperThresh1\r\n        \r\n        End If \r\n        \r\n        result = -1 * (Minimum / ESGP_AP1617FundingRate) * ESGP_TaperCond1\r\n    \r\n    End If \r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P64_SpHospFundingRate2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond2 As Decimal =Products.1718_ESG_Protection.ESGPRotection_P22_TaperCond2\r\n    Dim ESGP_SpHosp1617FundingRate As Decimal =Products.1718_ESG_Protection.ESGProtection_P56_SpHosp1617FundingRate\r\n    Dim ESGP_SpHospTaperThresh1 As Decimal =Products.1718_ESG_Protection.ESGProtection_P58_SpHospTaperThresh1\r\n    Dim ESGP_SpHospTaperThresh2 As Decimal =Products.1718_ESG_Protection.ESGProtection_P60_SpHospTaperThresh2\r\n    Dim Minimum As Decimal = 0\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_SpHosp1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        If ESGP_SpHospTaperThresh2 - ESGP_SpHospTaperThresh1 > ESGP_SpHosp1617FundingRate - ESGP_SpHospTaperThresh1 Then \r\n        \r\n            Minimum = ESGP_SpHosp1617FundingRate - ESGP_SpHospTaperThresh1\r\n            \r\n        Else \r\n        \r\n            Minimum = ESGP_SpHospTaperThresh2 - ESGP_SpHospTaperThresh1\r\n\r\n        End If \r\n        \r\n        result = -1 * (Minimum / ESGP_SpHosp1617FundingRate) * ESGP_TaperCond2\r\n    \r\n    End If\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P65_APFundingRate2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond2 As Decimal =Products.1718_ESG_Protection.ESGPRotection_P22_TaperCond2\r\n    Dim ESGP_AP1617FundingRate As Decimal =Products.1718_ESG_Protection.ESGProtection_P57_AP1617FundingRate\r\n    Dim ESGP_APTaperThresh1 As Decimal =Products.1718_ESG_Protection.ESGProtection_P59_APTaperThresh1\r\n    Dim ESGP_APTaperThresh2 As Decimal =Products.1718_ESG_Protection.ESGProtection_P61_APTaperThresh2\r\n    Dim Minimum As Decimal = 0\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n    \r\n    If ESGP_AP1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        If ESGP_APTaperThresh2 - ESGP_APTaperThresh1 > ESGP_AP1617FundingRate - ESGP_APTaperThresh1 Then \r\n        \r\n            Minimum = ESGP_AP1617FundingRate - ESGP_APTaperThresh1\r\n            \r\n        Else \r\n        \r\n            Minimum = ESGP_APTaperThresh2 - ESGP_APTaperThresh1\r\n            \r\n        End If \r\n        \r\n        result = -1 * (Minimum / ESGP_AP1617FundingRate) * ESGP_TaperCond2\r\n    \r\n    End If\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P66_SpHospFundingRate3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond3 As Decimal =            Products.1718_ESG_Protection.ESGProtection_P24_TaperCond3\r\n    Dim ESGP_SpHosp1617FundingRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P56_SpHosp1617FundingRate\r\n    Dim ESGP_SpHospTaperThresh2 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P60_SpHospTaperThresh2\r\n    Dim Maximum As Decimal =                    0\r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_SpHosp1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        'If 0 > ESGP_SpHosp1617FundingRate - ESGP_SpHospTaperThresh2 Then \r\n        \r\n        '    Maximum = ESGP_SpHosp1617FundingRate - ESGP_SpHospTaperThresh2\r\n        'Else \r\n        \r\n        '    Maximum = 0\r\n            \r\n        'End If \r\n        \r\n        'result = -1 * (Maximum / ESGP_SpHosp1617FundingRate) * ESGP_TaperCond3\r\n    \r\n         result = -1 * (Math.Max(0, ESGP_SpHosp1617FundingRate - ESGP_SpHospTaperThresh2) / ESGP_SpHosp1617FundingRate) * ESGP_TaperCond3\r\n    \r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P67_APFundingRate3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_TaperCond3 As Decimal =        Products.1718_ESG_Protection.ESGProtection_P24_TaperCond3\r\n    Dim ESGP_AP1617FundingRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P57_AP1617FundingRate\r\n    Dim ESGP_APTaperThresh2 As Decimal =    Products.1718_ESG_Protection.ESGProtection_P61_APTaperThresh2\r\n    Dim Maximum As Decimal =                0\r\n    Dim acadfilter As Decimal =             Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then    \r\n    \r\n    If ESGP_AP1617FundingRate = 0 THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        'If 0 > ESGP_AP1617FundingRate - ESGP_APTaperThresh2 Then \r\n\r\n        '    Maximum = ESGP_AP1617FundingRate - ESGP_APTaperThresh2\r\n            \r\n        'Else \r\n        \r\n        '    Maximum = 0\r\n             \r\n        'End If \r\n        \r\n        'result = -1 * (Maximum / ESGP_AP1617FundingRate) * ESGP_TaperCond3\r\n        result = -1 * (Math.Max(0, ESGP_AP1617FundingRate - ESGP_APTaperThresh2) / ESGP_AP1617FundingRate) * ESGP_TaperCond3  \r\n     \r\n    End If \r\n    \r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If     \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P68_SpHospAllocRedFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SpHospFundingRate1 As Decimal = Products.1718_ESG_Protection.ESGProtection_P62_SpHospFundingRate1\r\n    Dim ESGP_SPHospFundingRate2 As Decimal = Products.1718_ESG_Protection.ESGProtection_P64_SpHospFundingRate2\r\n    Dim ESGP_SPHospFundingRate3 As Decimal = Products.1718_ESG_Protection.ESGProtection_P66_SpHospFundingRate3\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result =  (ESGP_SpHospFundingRate1 + ESGP_SpHospFundingRate2 + ESGP_SpHospFundingRate3)\r\n\r\nElse \r\n    \r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P69_APAllocRedFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_APFundingRate1 As Decimal = Products.1718_ESG_Protection.ESGProtection_P63_APFundingRate1\r\n    Dim ESGP_APFundingRate2 As Decimal = Products.1718_ESG_Protection.ESGProtection_P65_APFundingRate2\r\n    Dim ESGP_APFundingRate3 As Decimal = Products.1718_ESG_Protection.ESGProtection_P67_APFundingRate3\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    result =  (ESGP_APFundingRate1 + ESGP_APFundingRate2 + ESGP_APFundingRate3)\r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P70_SpHospFallBelowFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_SPHosp1718ReductionRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P54_SpHosp1718ReductionRate\r\n    Dim ESGP_SPHospAllocRedFloor As Decimal = Products.1718_ESG_Protection.ESGProtection_P68_SpHospAllocRedFloor\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_SpHospAllocRedFloor < ESGP_SpHosp1718ReductionRate THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = ESGP_SpHospAllocRedFloor - ESGP_SpHosp1718ReductionRate\r\n    \r\n    End If \r\n\r\nElse \r\n\r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"ESGProtection_P71_APFallBelowFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim ESGP_AP1718ReductionRate As Decimal = Products.1718_ESG_Protection.ESGProtection_P55_AP1718ReductionRate\r\n    Dim ESGP_APAllocRedfloor As Decimal = Products.1718_ESG_Protection.ESGProtection_P69_APAllocRedFloor\r\n    Dim acadfilter As Decimal = Products.1718_Global_Variables.F603_ESGProtection_PlaceLed\r\n    \r\nIf acadfilter = 1 Then\r\n\r\n    If ESGP_APAllocRedFloor < ESGP_AP1718ReductionRate THEN\r\n\r\n        result = 0\r\n\r\n    ELSE\r\n\r\n        result = ESGP_APAllocRedFloor - ESGP_AP1718ReductionRate\r\n    \r\n    End If \r\n\r\nElse \r\n    \r\n    exclude(rid)\r\n    \r\nEnd If \r\n\r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_ESG_Protection","FolderName":"8_Place Led ESG Protection","DecimalPlaces":10},{"Name":"HN_P01_Spec_Pri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n    Dim NOR12 As Decimal =  Products.1718_NOR.NOR_P12_HND_HNP_HN_PRI\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n        \r\n        result =  NOR12\r\n    \r\n    Else Exclude(rid) \r\n    \r\n    End If\r\n   \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P02_Spec_KS3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR13 As Decimal = Products.1718_NOR.NOR_P13_HND_HNP_HN_KS3\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n        \r\n        result = NOR13\r\n\r\n    Else Exclude(rid)\r\n\r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P03_Spec_KS4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR14_HND As Decimal =  Products.1718_NOR.NOR_P14_HND_HNP_HN_KS4\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        result = NOR14_HND \r\n    \r\n    Else Exclude(rid)\r\n\r\n    End If    \r\n        \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P04_APP_Pri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR15_HND As Decimal =  Products.1718_NOR.NOR_P15_HND_HNP_AP_PRI\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n        \r\n        result = NOR15_HND\r\n    \r\n    Else Exclude(rid)\r\n    \r\n    End If\r\n\r\n    Return result\r\n\r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P05_APP_KS3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR16_HND As Decimal = Products.1718_NOR.NOR_P16_HND_HNP_AP_KS3                                                          \r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n        \r\n        result = NOR16_HND\r\n    \r\n    Else Exclude(rid)\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P06_APP_KS4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR17_HND As Decimal =   Products.1718_NOR.NOR_P17_HND_HNP_AP_KS4\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        result = NOR17_HND\r\n\r\n    Else Exclude(rid)\r\n\r\n    End If\r\n        \r\n    Return result\r\n\r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P07_HNP_Pre16_TotalPlaces","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN1_Pri As Decimal = Products.1718_HighNeeds.HN_P01_Spec_Pri\r\n    Dim HN2_KS3 As Decimal = Products.1718_HighNeeds.HN_P02_Spec_KS3\r\n    Dim HN3_KS4 As Decimal = Products.1718_HighNeeds.HN_P03_Spec_KS4\r\n    Dim Number_Count As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n        If HN1_Pri + HN2_KS3 + HN3_KS4 = Number_Count Then\r\n             \r\n            result = HN1_Pri + HN2_KS3 + HN3_KS4\r\n    \r\n        Else\r\n\r\n            result = Number_Count\r\n    \r\n        End If\r\n\r\n    Else Exclude(rid)\r\n       \r\n    End If\r\n\r\n    Return result\r\n\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P08_APP_Pre16_TotalPlaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN4_Pri As Decimal = Products.1718_HighNeeds.HN_P04_APP_Pri \r\n    Dim HN5_KS3 As Decimal = Products.1718_HighNeeds.HN_P05_APP_KS3\r\n    Dim HN6_KS4 As Decimal = Products.1718_HighNeeds.HN_P06_APP_KS4\r\n    Dim Number_Count As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        If HN4_Pri + HN5_KS3 + HN6_KS4 = Number_Count Then\r\n        \r\n            result = HN4_Pri + HN5_KS3 + HN6_KS4\r\n    \r\n        Else\r\n    \r\n            result = Number_Count\r\n    \r\n        End If\r\n\r\n    Else Exclude(rid)\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P09_Hosp_Places","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Number_Counts As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Hospital_provision_places\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        result =  Number_Counts\r\n\r\n    Else Exclude(rid)\r\n\r\n    End If\r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P10_Hosp_Funding_FY","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Number_Counts As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Hospital_provision_funding\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        result = Number_Counts\r\n    \r\n    Else Exclude(rid)\r\n\r\n    End If\r\n\r\n    Return result\r\n\r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P12_Spec_Rate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim GV4_Pre16 As Decimal = Products.1718_Global_Variables.P004_Pre16_HN_APP\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then \r\n\r\n        Result = GV4_Pre16\r\n        \r\n    Else Exclude(rid) \r\n\r\n    End If\r\n    \r\n    Return result                           \r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P13_APP_Rate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal =  Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim GV5_Pre16AP As Decimal = Products.1718_Global_Variables.P005_Pre16_AP_APP\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then \r\n\r\n        result = GV5_Pre16AP\r\n    \r\n    Else Exclude(rid)  \r\n    \r\n    End If\r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P14a_Post16HN_rate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim GV6_Post16HN As Decimal =Products.1718_Global_Variables.P006_Post16_HN_APP\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        result = GV6_Post16HN\r\n\r\n    Else Exclude(rid) \r\n\r\n    End If \r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P15_Spec_Pre16_FYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN7_Pre16_total As Decimal = Products.1718_HighNeeds.HN_P07_HNP_Pre16_TotalPlaces\r\n    Dim HN12_SpecRate As Decimal = Products.1718_HighNeeds.HN_P12_Spec_Rate\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then \r\n        \r\n        result = HN7_Pre16_total * HN12_SpecRate\r\n\r\n    Else Exclude(rid)\r\n    \r\n    End If\r\n\r\n    Return result\r\n\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P17_AP_Pre16_FYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN8_Pre16Total As Decimal = Products.1718_HighNeeds.HN_P08_APP_Pre16_TotalPlaces \r\n    Dim HN13_APPRate As Decimal = Products.1718_HighNeeds.HN_P13_APP_Rate\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then \r\n\r\n        result = HN8_Pre16Total * HN13_APPRate\r\n\r\n    Else  Exclude(rid)\r\n    \r\n    End If\r\n     \r\n     Return Result\r\n            \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P19_TotalHN_Pre16_FYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim HN10_HospFund As Decimal = Products.1718_HighNeeds.HN_P10_Hosp_Funding_FY\r\n    Dim HN15_SpecPre16 As Decimal = Products.1718_HighNeeds.HN_P15_Spec_Pre16_FYFunding\r\n    Dim HN17_APPre16 As Decimal = Products.1718_HighNeeds.HN_P17_AP_Pre16_FYFunding\r\n    \r\n    result = HN10_HospFund + HN15_SpecPre16 + HN17_APPre16\r\n    \r\n       \r\n    Return result\r\n    \r\n    \r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P21_HNP_Post16","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0    \r\n    Dim AcadFilter As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim Post16HN As Double = Products.AY1718_Acad_Post16.P04_HNPlaces\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then 'checks the funding period And opening period\r\n    \r\n    result = Post16HN\r\n    \r\n    Else Exclude(rid)\r\n        \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P22_HN_Post16_FYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim P04_HNPlaces As Decimal = Products.AY1718_Acad_Post16.P04_HNPlaces\r\n    Dim P07_HNAnnualPerPlaceUnitValue As Decimal = Products.AY1718_Acad_Post16.P07_HN_Annual_Per_Place_Unit_Value\r\n\r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then 'checks the funding period And opening period\r\n    \r\n        result = P04_HNPlaces * P07_HNAnnualPerPlaceUnitValue \r\n    \r\n    Else Exclude(rid)\r\n        \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n\r\n    ","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"test","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\nDim P01_ As Decimal = Products.1718_HighNeeds.HN_P01_Spec_Pri\r\nDim P02_ As Decimal = Products.1718_HighNeeds.HN_P02_Spec_KS3\r\nDim P03_ As Decimal = Products.1718_HighNeeds.HN_P03_Spec_KS4\r\nDim P04_ As Decimal = Products.1718_HighNeeds.HN_P04_APP_Pri\r\nDim P05_ As Decimal = Products.1718_HighNeeds.HN_P05_APP_KS3\r\nDim P06_ As Decimal = Products.1718_HighNeeds.HN_P06_APP_KS4\r\nDim P07_ As Decimal = Products.1718_HighNeeds.HN_P07_HNP_Pre16_TotalPlaces\r\nDim P08_ As Decimal = Products.1718_HighNeeds.HN_P08_APP_Pre16_TotalPlaces\r\nDim P09_ As Decimal = Products.1718_HighNeeds.HN_P09_Hosp_Places\r\nDim P10_ As Decimal = Products.1718_HighNeeds.HN_P10_Hosp_Funding_FY\r\nDim P12_ As Decimal = Products.1718_HighNeeds.HN_P12_Spec_Rate\r\nDim P13_ As Decimal = Products.1718_HighNeeds.HN_P13_APP_Rate\r\nDim P14a As Decimal = Products.1718_HighNeeds.HN_P14a_Post16HN_rate \r\nDim P15_ As Decimal = Products.1718_HighNeeds.HN_P15_Spec_Pre16_FYFunding\r\nDim P17_ As Decimal = Products.1718_HighNeeds.HN_P17_AP_Pre16_FYFunding\r\nDim P19_ As Decimal = Products.1718_HighNeeds.HN_P19_TotalHN_Pre16_FYFunding\r\nDim P21_ As Decimal = Products.1718_HighNeeds.HN_P21_HNP_Post16                \r\nDim P22_ As Decimal = Products.1718_HighNeeds.HN_P22_HN_Post16_FYFunding                     \r\nDim P11_ As Decimal = Products.1718_HighNeeds.HN_P11_Hosp_Funding_IY\r\nDim P16_ As Decimal = Products.1718_HighNeeds.HN_P16_HN_Pre16_IYFunding                                             \r\nDim P18_ As Decimal = Products.1718_HighNeeds.HN_P18_AP_Pre16_IYFunding\r\nDim P20_ As Decimal = Products.1718_HighNeeds.HN_P20_TotalHN_Pre16_IYFunding\r\nDim P23_ As Decimal = Products.1718_HighNeeds.HN_P23_HN_Post16_IYFunding\r\nDim P19b As Decimal = Products.1718_HighNeeds.HN_P19b_Total_Pre16_AP_HN_Funding\r\nDim P20b As Decimal = Products.1718_HighNeeds.HN_P20b_Total_Pre16_AP_HN_Funding_IY\r\n\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P14b_Post16HN_Prov_Rate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim GV04b As Decimal = Products.AY1718_Acad_GlobalVariables.P04b_Post16HN_Prov_APP\r\n    Dim F400 As Decimal = Products.1718_Global_Variables.F400_HN_Academies\r\n    \r\n    If F400 = 1 then\r\n    \r\n        result = GV04b\r\n    \r\n    else\r\n    \r\n        exclude(rid)\r\n    \r\n    End if\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"1_HN","DecimalPlaces":0},{"Name":"HN_P11_Hosp_Funding_IY","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN10_HospFunding As Decimal = Products.1718_HighNeeds.HN_P10_Hosp_Funding_FY\r\n    Dim Days_Open As Decimal = Products.1718_Global_Variables.P027_DaysOpen\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        If Days_Open < 365 Then\r\n        \r\n            Result = ((HN10_HospFunding / 365) * Days_Open)\r\n            \r\n    \r\n        Else Exclude(rid)\r\n\r\n        End If\r\n    \r\n    End If\r\n   \r\nReturn Result   \r\n\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P16_HN_Pre16_IYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN15_Pre16FY As Decimal = Products.1718_HighNeeds.HN_P15_Spec_Pre16_FYFunding\r\n    Dim Days_Open As Decimal =Products.1718_Global_Variables.P027_DaysOpen\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        If Days_Open < 365 Then\r\n\r\n            result = (HN15_Pre16FY / 365) * Days_Open\r\n        \r\n        Else \r\n\r\n            result = HN15_Pre16FY\r\n\r\n        End If\r\n\r\n    End If\r\n    \r\n    End Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P18_AP_Pre16_IYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim P17_APPre16 As Decimal = Products.1718_HighNeeds.HN_P17_AP_Pre16_FYFunding\r\n    Dim Days_Open As Decimal =Products.1718_Global_Variables.P027_DaysOpen\r\n    \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17182 Or AcadFilter = 17183) then\r\n\r\n        If Days_Open < 365 Then\r\n\r\n            result = (P17_APPre16 / 365) * Days_Open\r\n\r\n        Else\r\n\r\n            result = P17_APPre16\r\n\r\n        End If\r\n    \r\n    End If\r\n    \r\n   End Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P20_TotalHN_Pre16_IYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim HN11_Hosp As Decimal = Products.1718_HighNeeds.HN_P11_Hosp_Funding_IY\r\n    Dim HN16_HNPre16 As Decimal = Products.1718_HighNeeds.HN_P16_HN_Pre16_IYFunding\r\n    Dim HN18_APPre16 As Decimal = Products.1718_HighNeeds.HN_P18_AP_Pre16_IYFunding\r\n    \r\n    result = HN11_Hosp + HN16_HNPre16 + HN18_APPre16\r\n    \r\n    Return Result\r\n      \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P23_HN_Post16_IYFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim HN22_Post16FY As Decimal = Products.1718_HighNeeds.HN_P22_HN_Post16_FYFunding\r\n    Dim Months_Open As integer = Products.1718_Global_Variables.P028_MonthsOpen\r\n    \r\n    result = HN22_Post16FY / 12 * Months_Open\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P23_HN_Post16_IYFunding_V1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim ConvertDate As Date = Datasets.Administration.Providers.Provider_Information.Convert_Date\r\n    Dim OpenedDate As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim DateUsed As Date\r\n    Dim MonthsOpen As Decimal = DateDiff(\"m\",DateUsed, \"01 September 2018\")\r\n    Dim Post16Filter As Decimal = Products.1718_Global_Variables.Post16Filter\r\n    Dim HN22_Post16FY As Decimal = Products.1718_HighNeeds.HN_P22_HN_Post16_FYFunding\r\n\r\n    If ConvertDate >= OpenedDate then\r\n        DateUsed = ConvertDate\r\n        Else\r\n        DateUsed = OpenedDate\r\n    End If \r\n       \r\n    If currentscenario.periodid = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) then\r\n        \r\n        If ConvertDate > OpenedDate Or (OpenedDate = ConvertDate And (Post16Filter = 1 Or Post16Filter = 2)) then\r\n        \r\n            Result = HN22_Post16FY / 12 * MonthsOpen\r\n            \r\n            Else\r\n            \r\n            Result = HN22_Post16FY\r\n            \r\n        End If\r\n            \r\n        Else exclude(rid)\r\n     \r\n    End If     \r\n    \r\n        Result = HN22_Post16FY\r\n        \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"2_New Openers","DecimalPlaces":0},{"Name":"HN_P19b_Total_Pre16_AP_HN_Funding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    \r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim HN15_HNPre16 As Decimal = Products.1718_HighNeeds.HN_P15_Spec_Pre16_FYFunding\r\n    Dim HN17_APPre16 As Decimal = Products.1718_HighNeeds.HN_P17_AP_Pre16_FYFunding\r\n    \r\n    result = HN15_HNPre16 + HN17_APPre16\r\n    \r\n    Return result\r\n    \r\n   \r\n    \r\nEnd Function ","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"3_FAP_Products","DecimalPlaces":0},{"Name":"HN_P20b_Total_Pre16_AP_HN_Funding_IY","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim HN16_HNPre16 As Decimal = Products.1718_HighNeeds.HN_P16_HN_Pre16_IYFunding\r\n    Dim HN18_APPre16 As Decimal = Products.1718_HighNeeds.HN_P18_AP_Pre16_IYFunding\r\n    \r\n    result = HN16_HNPre16 + HN18_APPre16\r\n     \r\n     Return result\r\n    \r\n   \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_HighNeeds","FolderName":"3_FAP_Products","DecimalPlaces":0},{"Name":"SUG_P00_SUG_Years_Open","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n \r\n If DateOpened >= \"01/09/2017\" And DateOpened <= \"31/08/2018\" Then\r\n                Result = 1\r\n            ElseIf DateOpened >= \"01/09/2016\" And DateOpened <= \"31/08/2017\" Then\r\n                Result = 2 \r\n            ElseIf DateOpened >= \"01/09/2015\" And DateOpened <= \"31/08/2016\" Then\r\n                Result = 3\r\n            Else exclude(rid)    \r\n            End If\r\n    \r\n    End If         \r\n\r\n     Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"1_SUG pupil led","DecimalPlaces":0},{"Name":"SUG_P01_pupilcount","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SUG_NOR As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.SUG_NOR \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\n    If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n         \r\n        result = SUG_NOR    \r\n                                   \r\n    Else exclude(rid)\r\n    \r\n    End If\r\n    \r\n        Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SUG","FolderName":"1_SUG pupil led","DecimalPlaces":0},{"Name":"P01a_Phase","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies 'calls the 'all academies' filter\r\n     Dim Phase As String = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Academy_Phase 'calls phase from MasterSUGPOG dataset To be used In calculations\r\n     \r\n     Print(AcadFilter, \"AcadFilter\", rid)\r\n     Print(Phase, \"Phase\", rid)\r\n     \r\n     If AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183 then\r\n     If Phase Like \"Primary\" then\r\n\r\nresult = 1\r\n\r\nElseIf Phase Like \"Junior\" then\r\n\r\nresult = 1\r\n\r\n                        ElseIf Phase Like \"Infant\" then   \r\n                       \r\n                        result = 1\r\n\r\n    ElseIf Phase Like \"Secondary\" then\r\n    \r\n     result = 2\r\n    \r\n    ElseIf Phase Like \"All through\" Or Phase Like \"All Through\" then\r\n    \r\n    result = 3\r\n    \r\n    Else\r\n    \r\n    result = 0\r\n\r\n        End If\r\n        End If\r\n          \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_SUG","FolderName":"1_SUG pupil led","DecimalPlaces":0},{"Name":"SUG_P11_PlaceLed_FundingRate","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim PriSUGAMin As Decimal = Products.1718_SUG.SUG_P05_Pri_SUGA_Min\r\n    Dim SecRate As Decimal = Products.1718_SUG.SUGA_P08a_Per_Place_Funding_Rate    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim SUGA_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override\r\n    Dim IsNull As Boolean \r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override,false,true)\r\n    \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    If FundingBasis = \"Census\" Or FundingBasis = \"Estimate\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n       End if\r\n       End if\r\n    \r\n     If FundingBasis = \"Place\" Then \r\n            If IsNull = false Then\r\n                Result = SUGA_Override\r\n\r\n    \r\n        If YearsOpen = 1 Then \r\n            If PupilCount <= 100 Then\r\n                Result = PriSUGAMin\r\n            ElseIf PupilCount > 100 Then \r\n                Result = PriSUGAMin + ((PupilCount - 100) * SecRate)\r\n            Else Result = 0\r\n            End If \r\n        End If            \r\n                               \r\n    End If \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"3_SUG place led","DecimalPlaces":0},{"Name":"SUGB_P12_Pri_MinCap","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim PriMinCap As Decimal = 10000  \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n           \r\n        Result = PriMinCap            \r\n \r\n        \r\nElse exclude(rid)\r\n\r\nEnd If \r\n \r\nReturn result \r\n \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P13_Pri_MaxCap","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PriMaxCap As Decimal = 50000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = PriMaxCap\r\n \r\n      \r\nElse exclude(rid)\r\n\r\nEnd If \r\n \r\nReturn result \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P14_PerPercentRate","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n     \r\n    Dim PerPercentRate As Decimal = 2500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = PerPercentRate\r\n   \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P15_CapacityPerCentMin","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim Capacity As Decimal = 0.9   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = Capacity\r\n   \r\n\r\nElse exclude(rid)                                          \r\n\r\nEnd If\r\n\r\nReturn result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P16_FundingPerCentMin","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingMin As Decimal = 0.865\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = FundingMin\r\n  \r\n\r\nElse exclude(rid)\r\n                                                     \r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P17_Capacity","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim MaxCap As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = MaxCap\r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P18_CapacityPerCent","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim Capacity As Decimal = Products.1718_SUG.SUGB_P17_Capacity    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = PupilCount / Capacity\r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P19_SpareCapacityPri","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase\r\n    Dim CapacityPerCent As Decimal = Products.1718_SUG.SUGB_P18_CapacityPerCent\r\n    Dim FundingPerCentMin As Decimal = Products.1718_SUG.SUGB_P16_FundingPerCentMin\r\n    Dim CapacityPerCentMin As Decimal = Products.1718_SUG.SUGB_P15_CapacityPerCentMin    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n\r\n\r\n\r\n If FundingBasis = \"Place\" Or Phase = 2 Or Phase = 3 then\r\n    exclude(rid)\r\n    End if\r\n    \r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And Phase = 1 And CapacityPerCent >= FundingPerCentMin Then \r\n    result = 0\r\n    else\r\n    result = Math.Round((CapacityPerCentMin - CapacityPerCent) * 100)\r\n    \r\n    End if\r\n   \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n        \r\n\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P20_CapacityFundingRatePri","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim PerPercentRate As Decimal = Products.1718_SUG.SUGB_P14_PerPercentRate\r\n    Dim SpareCapacityPri As Decimal = Products.1718_SUG.SUGB_P19_SpareCapacityPri\r\n    Dim PriMinCap As Decimal = Products.1718_SUG.SUGB_P12_Pri_MinCap\r\n    Dim PriMaxCap As Decimal = Products.1718_SUG.SUGB_P13_Pri_MaxCap    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim phase As Decimal = Products.1718_SUG.P01a_Phase        \r\n        \r\n If FundingBasis = \"Place\" Or Phase = 2 Or Phase = 3 then\r\n    exclude(rid)\r\n    End if\r\n    \r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And Phase = 1 Then \r\n                                                          \r\n   \r\n\r\n        If SpareCapacityPri * PerPercentRate < PriMinCap  Then\r\n            Result = 0\r\n        ElseIf SpareCapacityPri * PerPercentRate > PriMaxCap Then\r\n            Result = PriMaxCap\r\n        Else\r\n            Result = SpareCapacityPri * PerPercentRate        \r\n        End If \r\n        \r\n      \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P21_Pri_Funding_ProRata","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim YearsOpen As Decimal =Products.1718_SUG.SUG_P00_SUG_Years_Open\r\n    Dim CapacityFundingRatePri As Decimal = Products.1718_SUG.SUGB_P20_CapacityFundingRatePri    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase\r\n    Dim Prov_Subtype As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim SUGB_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override\r\n    Dim IsNull As Boolean\r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override,false,true)\r\n\r\nIf acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And Phase = 1 And Prov_SubType = \"11ACA\" then \r\n\r\nIf IsNull = false then      \r\n    result = SUGB_Override\r\n    Else\r\n    If YearsOpen = 1 Or YearsOpen = 2\r\n    result = CapacityFundingRatePri / 2\r\n    else\r\n    exclude(rid)\r\n    End if\r\n    End If\r\n    End If\r\n    \r\n    Return result\r\nEnd Function\r\n\r\n\r\n        \r\n\r\n        \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"4_SUG B primary formula","DecimalPlaces":0},{"Name":"SUGB_P22_SecMinCap","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecMinCap As Decimal = 10000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = SecMinCap\r\n                               \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P23_SecMaxCapSmall","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n                                                                                     \r\n    Dim SecMaxCapSmall As Decimal = 60000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = SecMaxCapSmall\r\n                               \r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P24_SecMaxCapLarge","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim SecMaxCapLarge As Decimal = 80000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = SecMaxCapLarge\r\n                               \r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P25_PerPercentRateSmall","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim PPRateSmall As Decimal = 3000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = PPRateSmall\r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P26_PerPercentRateLarge","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim PPRateLarge As Decimal = 4000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = PPRateLarge\r\n                               \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P27_SpareCapacity","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim CapPerCent As Decimal = Products.1718_SUG.SUGB_P18_CapacityPerCent\r\n    Dim CapPerCentMin As Decimal = Products.1718_SUG.SUGB_P15_CapacityPerCentMin\r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\n   If FundingBasis = \"Place\"  Or Phase = 1 Then\r\n    \r\n    exclude(rid) \r\n     \r\n    End If\r\n   \r\n      If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 2 Or Phase = 3 Then\r\n            If CapPerCent >= CapPerCentMin Then \r\n                Result = 0\r\n            Else \r\n                Result = Math.Round((CapPerCentMin - CapPerCent) * 100)\r\n                               \r\n        End If \r\n        End if\r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P28_CapacityFundingRateSmall","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    'Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim PPRateSmall As Decimal = Products.1718_SUG.SUGB_P25_PerPercentRateSmall\r\n    Dim SpareCap As Decimal = Products.1718_SUG.SUGB_P27_SpareCapacity\r\n    Dim SecMinCap As Decimal = Products.1718_SUG.SUGB_P22_SecMinCap\r\n    Dim SecMaxCapSmall As Decimal = Products.1718_SUG.SUGB_P23_SecMaxCapSmall\r\n    Dim MaxCapSmall As Decimal = Products.1718_SUG.SUGB_P32_MaxCapSmall     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    Dim MaxCap As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim FundingBasis As string = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase\r\n    \r\nIf FundingBasis = \"Place\" Or Phase = 1 then\r\n    exclude(rid)\r\n    Else\r\n\r\nIf AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n        If MaxCap > 0 And MaxCap <= MaxCapSmall Then\r\n            If SpareCap * PPRateSmall < SecMinCap Then \r\n                Result = 0\r\n            ElseIf SpareCap * PPRateSmall > SecMaxCapSmall Then \r\n                Result = SecMaxCapSmall\r\n            Else \r\n                Result = SpareCap * PPRateSmall\r\n            End If\r\n        Else Result = 0       \r\n        End If                       \r\n\r\nEnd If \r\nEnd If\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P29_Small_Sec_Funding_ProRata","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open    \r\n    Dim CapFunRateSmall As Decimal = Products.1718_SUG.SUGB_P28_CapacityFundingRateSmall     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim SUGB_Override As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override\r\n    Dim Prov_SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase\r\n    Dim MaxCap As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim MaxCapSmall As Decimal = Products.1718_SUG.SUGB_P32_MaxCapSmall\r\n    Dim IsNull As Boolean\r\n        IsNull = iif(datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override,false,true)    \r\n          \r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And (Phase = 2 Or Phase = 3) And Prov_SubType = \"11ACA\" And MaxCap > 0 And MaxCap <= MaxCapSmall then \r\n    If IsNull = False then      \r\n    result = SUGB_Override\r\n    Else\r\n    If YearsOpen = 1 Or YearsOpen = 2 Or YearsOpen = 3 then\r\n    result = CapFunRateSmall / 3\r\n    else\r\n    result = 0\r\n    \r\n    End if\r\n    End If\r\n    End If\r\n    \r\n    Return result\r\nEnd Function\r\n\r\n        \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P30_CapacityFundingRateLarge","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim SecMinCap As Decimal = Products.1718_SUG.SUGB_P22_SecMinCap \r\n    Dim SecMaxCapLarge As Decimal = Products.1718_SUG.SUGB_P24_SecMaxCapLarge \r\n    Dim PPRateLarge As Decimal = Products.1718_SUG.SUGB_P26_PerPercentRateLarge \r\n    Dim SpareCap As Decimal = Products.1718_SUG.SUGB_P27_SpareCapacity\r\n    Dim MinCapLarge As Decimal = Products.1718_SUG.SUGB_P33_MinCapLarge     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    Dim MaxCap As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As decimal = Products.1718_SUG.P01a_Phase\r\n    \r\n    Print(PupilCount,\"PupilCount\",rid)\r\n    Print(SecMinCap,\"SecMinCap\",rid)\r\n    Print(SecMaxCapLarge,\"SecMaxCapLarge\",rid)\r\n    Print(PPRateLarge,\"PPRateLarge\",rid)\r\n    Print(SpareCap,\"SpareCap\",rid)\r\n    Print(MinCapLarge,\"MinCapLarge\",rid)\r\n    Print(AcadFilter,\"AcadFilter\",rid)\r\n    Print(MaxCap,\"MaxCap\",rid)\r\n    Print(FundingBasis,\"FundingBasis\",rid)\r\n    Print(Phase,\"Phase\",rid)\r\n    \r\n    If FundingBasis = \"Place\" Or Phase = 1 then\r\n        exclude(rid)\r\n    Else\r\n    \r\n        If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then \r\n\r\n            If PupilCount > 0 And MaxCap >= MinCapLarge Then \r\n                If SpareCap * PPRateLarge < SecMinCap Then \r\n                    Result = 0\r\n                ElseIf SpareCap * PPRateLarge > SecMaxCapLarge Then \r\n                    Result = SecMaxCapLarge\r\n                Else \r\n                    Result = SpareCap * PPRateLarge\r\n                End If\r\n            Else \r\n                Result = 0\r\n            End If\r\n\r\n        End If\r\n    End If        \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P31_Large_Sec_Funding_ProRata","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim CapFunRateLarge As Decimal = Products.1718_SUG.SUGB_P30_CapacityFundingRateLarge\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n    Dim SUGB_Override As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override\r\n    Dim Prov_SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase\r\n    Dim MaxCap As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim MinCapLarge As Decimal = Products.1718_SUG.SUGB_P33_MinCapLarge\r\n    Dim IsNull As Boolean \r\n        IsNull = iif (datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override,false,true)    \r\n          \r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And (Phase = 2 Or Phase = 3) And Prov_SubType = \"11ACA\" And MaxCap >= MinCapLarge then \r\n        If IsNull = false then      \r\n            result = SUGB_Override\r\n        Else\r\n            If YearsOpen = 1 Or YearsOpen = 2 Or YearsOpen = 3 then\r\n                result = CapFunRateLarge / 3\r\n            else\r\n                result = 0\r\n            \r\n            End if\r\n        End If\r\n    End If\r\n    \r\n    Return result\r\nEnd Function\r\n\r\n            \r\n        \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P32_MaxCapSmall","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    Dim MaxCapSmall As Decimal = 250   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = MaxCapSmall\r\n   \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P33_MinCapLarge","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim MinCapLarge As Decimal = 1000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = MinCapLarge\r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function     \r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P34_MedPupilRange","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    Dim MedPupilRange As Decimal = 750   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n    Result = MedPupilRange\r\n   \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P35_MaxCapDiff","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n     \r\n    Dim MaxCapDiff As Decimal = 20100   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n \r\n    Result = MaxCapDiff\r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P36_DiseconPerCenDiff","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim DiseconPercenDiff As Decimal = 20   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = DiseconPercenDiff\r\n                               \r\n     \r\n \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P37_PupilsOverSmallMax","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim MaxCapSmall As Decimal = Products.1718_SUG.SUGB_P32_MaxCapSmall\r\n    Dim MinCapLarge As Decimal = Products.1718_SUG.SUGB_P33_MinCapLarge \r\n    Dim MaxCap As Decimal = Products.1718_SUG.SUGB_P17_Capacity    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n       If MaxCap > MaxCapSmall And MaxCap < MinCapLarge Then \r\n            Result = MaxCap - MaxCapSmall\r\n        Else \r\n            Result = 0\r\n        End If \r\n                               \r\n           \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P38_SlidingScalePerCent","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim MedPupilRange As Decimal = Products.1718_SUG.SUGB_P34_MedPupilRange\r\n    Dim PupilsOverSmallMax As Decimal = Products.1718_SUG.SUGB_P37_PupilsOverSmallMax    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n       Result = PupilsOverSmallMax / MedPupilRange\r\n                            \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P39_ScalePerCentApplied","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n   \r\n    Dim MaxCapDiff As Decimal =Products.1718_SUG.SUGB_P35_MaxCapDiff\r\n    Dim SlidingScale As Decimal = Products.1718_SUG.SUGB_P38_SlidingScalePerCent    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n        Result = SlidingScale * MaxCapDiff\r\n                          \r\n      \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P40_CapsCombined","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n \r\n    Dim SecMaxCapSmall As Decimal =Products.1718_SUG.SUGB_P23_SecMaxCapSmall\r\n    Dim ScaleApplied As Decimal = Products.1718_SUG.SUGB_P39_ScalePerCentApplied    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    result =  Math.Round(Math.Round(SecMaxCapSmall + ScaleApplied) / 100) * 100\r\n                          \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P41_RatePerPerCent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n \r\n    Dim Disecon As Decimal = Products.1718_SUG.SUGB_P36_DiseconPerCenDiff \r\n    Dim CapsComb As Decimal = Products.1718_SUG.SUGB_P40_CapsCombined    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n   \r\n   result = Math.Round(Math.Round(CapsComb / Disecon) / 100) * 100\r\n    else\r\n    exclude(rid)\r\n    \r\n    End if\r\n    \r\n    Return result\r\nEnd Function\r\n\r\n \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P42_SpareCapacityMedSec","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim CapMin As Decimal = Products.1718_SUG.SUGB_P15_CapacityPerCentMin\r\n    Dim Cap As Decimal = Products.1718_SUG.SUGB_P18_CapacityPerCent    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n\r\n        If Cap > CapMin Then \r\n            Result = 0\r\n        Else \r\n            Result = (CapMin - Cap) * 100\r\n        End If \r\n                               \r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P43_CapacityFundingRateMedium","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim MinCapLarge As Decimal = Products.1718_SUG.SUGB_P33_MinCapLarge\r\n    Dim MaxCapSmall As Decimal = Products.1718_SUG.SUGB_P32_MaxCapSmall\r\n    Dim SpareCapMedSec As Decimal = Products.1718_SUG.SUGB_P42_SpareCapacityMedSec\r\n    Dim RatePPCent As Decimal = Products.1718_SUG.SUGB_P41_RatePerPerCent\r\n    Dim SecMinCap As Decimal = Products.1718_SUG.SUGB_P22_SecMinCap \r\n    Dim CapsComb As Decimal = Products.1718_SUG.SUGB_P40_CapsCombined \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim MaxCap As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase\r\n\r\n       \r\n    If FundingBasis = \"Place\" Or Phase = 1 then\r\n    exclude(rid)\r\n    End if\r\n\r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And MaxCap > MaxCapSmall And MaxCap < MinCapLarge then\r\n    If (SpareCapMedSec * RatePPCent) < SecMinCap then\r\n    result = 0\r\n    else\r\n    \r\n    If SpareCapMedSec > 20 And (SpareCapMedSec * RatePPCent) > CapsComb then\r\n        \r\n        Result = 20 * RatePPCent\r\n        \r\n        Else\r\n        \r\n            If (SpareCapMedSec * RatePPCent) > CapsComb then\r\n            result = CapsComb\r\n            else\r\n            result = SpareCapMedSec * RatePPCent\r\n    \r\n    End if\r\n    End if\r\n    End if\r\n    End if \r\n    \r\n    \r\n    Return result\r\n    \r\n    End Function\r\n\r\n\r\n\r\n        \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGB_P44_Med_Secondary_Funding_ProRata","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim CapFunRateMed As Decimal = Products.1718_SUG.SUGB_P43_CapacityFundingRateMedium\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim Phase As Decimal = Products.1718_SUG.P01a_Phase \r\n    Dim MaxCap As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP  \r\n    Dim SUGB_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override\r\n    Dim Prov_SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim MaxCapSmall As Decimal = Products.1718_SUG.SUGB_P32_MaxCapSmall\r\n    Dim MinCapLarge As Decimal = Products.1718_SUG.SUGB_P33_MinCapLarge\r\n    Dim IsNull As Boolean \r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override,false,true)\r\n        \r\nIf FundingBasis = \"Place\" Or Phase = 1 then\r\n    exclude(rid)\r\n    End if\r\n\r\n    If (acadfilter = 17181 Or acadFilter = 17182 Or acadFilter = 17183) And (Phase = 2 Or Phase = 3) And Prov_SubType = \"11ACA\" And MaxCap > MaxCapSmall And MaxCap < MinCapLarge then \r\n    If IsNull = false then      \r\n    result = SUGB_Override\r\n    Else\r\n    If YearsOpen = 1 Or YearsOpen = 2 Or YearsOpen = 3\r\n    result = CapFunrateMed / 3\r\n    else\r\n    exclude(rid)\r\n    \r\n    End if\r\n    End If\r\n    End If\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"5_SUG B secondary formula","DecimalPlaces":0},{"Name":"SUGA_P45_FAP_Total","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n   \r\n    Dim PriFun As Decimal = Products.1718_SUG.SUGA_P07_Pri_Funding\r\n    Dim SecFun As Decimal = Products.1718_SUG.SUGA_P09_Sec_Funding \r\n    Dim ATFun As Decimal = Products.1718_SUG.SUGA_P10_AllThrough_Funding \r\n    Dim PlaceLedFunRate As Decimal = Products.1718_SUG.SUG_P11_PlaceLed_FundingRate     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    \r\n\r\n        Result = PriFun + SecFun + ATFun + PlaceLedFunRate\r\n                               \r\n  \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"6_FAP totals","DecimalPlaces":0},{"Name":"SUGB_P46_FAP_Total","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    Dim PriFunPR As Decimal = Products.1718_SUG.SUGB_P21_Pri_Funding_ProRata\r\n    Dim SmallSecFunPR As Decimal = Products.1718_SUG.SUGB_P29_Small_Sec_Funding_ProRata \r\n    Dim LargeSecFunPR As Decimal = Products.1718_SUG.SUGB_P31_Large_Sec_Funding_ProRata \r\n    Dim MedSecFunPR As Decimal = Products.1718_SUG.SUGB_P44_Med_Secondary_Funding_ProRata     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    Dim MaxCap = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.MAXCAP\r\n    Dim SUGB_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override\r\n    Dim IsNull As Boolean\r\n    IsNull = IIf (datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUGB_Formulaic_Override, false, true)\r\n    \r\n       \r\n    If (acadFilter = 17181 Or acadFilter = 17182 Or acadfilter = 17183) then\r\n    If MaxCap = 0  And IsNull = \"False\"      \r\n    result = SUGB_Override\r\n    Else\r\n      \r\n\r\n        Result =  PriFunPR + SmallSecFunPR + LargeSecFunPR + MedSecFunPR\r\n                                           \r\n\r\nEnd if\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\n    End Function\r\n    \r\n    \r\n   \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"6_FAP totals","DecimalPlaces":0},{"Name":"P2_SUGB_Form","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim P46_FAP_Total As Decimal = Products.1718_SUG.SUGB_P46_FAP_Total \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    \r\n\r\n        Result =  P46_FAP_Total\r\n                               \r\n                                              \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"6_FAP totals","DecimalPlaces":6},{"Name":"P1_SUGA","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    Dim P45_FAP_Total As Decimal = Products.1718_SUG.SUGA_P45_FAP_Total \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    \r\n\r\n        Result =  P45_FAP_Total\r\n                               \r\n                                             \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"6_FAP totals","DecimalPlaces":6},{"Name":"SUG_P02_Year_Groups","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim YearGroups As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.YearGroups\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n   \r\n    Result = YearGroups    \r\n \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUG_P03_Class_Size","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ClassSize As Decimal = 30 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n Result = ClassSize    \r\n                               \r\n     \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUG_P04_FormsOfEntry","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Capacity As Decimal = Products.1718_SUG.SUGB_P17_Capacity\r\n    Dim YearGroups As Decimal = Products.1718_SUG.SUG_P02_Year_Groups                                                                           \r\n    Dim ClassSize As Decimal =  Products.1718_SUG.SUG_P03_Class_Size\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    Dim FormEntry As Decimal =  ((Capacity/YearGroups) / ClassSize)\r\n    \r\n    Print(FundingBasis,\"FundingBasis\",rid)\r\n    Print(Capacity,\"Capacity\",rid)\r\n    Print(YearGroups,\"YearGroups\",rid)\r\n    Print(ClassSize, \"ClassSize\",rid)\r\n    Print(Phase, \"Phase\",rid)\r\n    Print(AcadFilter, \"AcadFilter\",rid)\r\n    Print(FormEntry, \"FormEntry\", rid)\r\n      \r\n\r\n If FundingBasis = \"Place\" Then \r\n    Exclude(rid)\r\n    else\r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 1 then\r\n    If FormEntry < 1.5 Then \r\n    result = 1 \r\n    else\r\n    If FormEntry >= 1.5 then\r\n    Result = 2\r\n    else\r\n    exclude(rid)\r\n    \r\n    End If\r\n    End If\r\n    End If\r\n    End If\r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUG_P05_Pri_SUGA_Min","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PriFunding1 As Decimal = 25000 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = PriFunding1    \r\n                               \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUG_P06_Pri_SUGA_Max","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim PriFunding2 As Decimal = 50000 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = PriFunding2    \r\n \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUGA_P07_Pri_Funding","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open \r\n    Dim FormsOfEntry As Decimal = Products.1718_SUG.SUG_P04_FormsOfEntry\r\n    Dim PriSUGAMin As Decimal = Products.1718_SUG.SUG_P05_Pri_SUGA_Min\r\n    Dim PriSUGAMax As Decimal = Products.1718_SUG.SUG_P06_Pri_SUGA_Max\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim Prov_SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype    \r\n    Dim SUGA_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override\r\n    Dim SUGA_Override_String As String = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override\r\n    Dim IsNull As Boolean\r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override,false,true)\r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n If FundingBasis = \"Place\" Then\r\n    \r\n    result = 0 \r\n    \r\n    Else\r\n    \r\n    End if\r\n    \r\n     If Prov_SubType = \"11ACA\" And Phase = 1 Then \r\n            If IsNull=False then\r\n            Result = SUGA_Override\r\n                \r\n              \r\n        ElseIf YearsOpen = 1 Then \r\n            If Phase = 1 And FormsOfEntry = 1 Then\r\n                Result = PriSUGAMin \r\n            ElseIf Phase = 1 And FormsOfEntry = 2 Then \r\n                Result = PriSUGAMax \r\n            Else exclude(rid)\r\n            End If             \r\n        End If                       \r\nEnd If \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUGA_P08_Sec_Per_Pupil_Funding_Rate","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecPupilRate As Decimal = 150 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n       \r\n    Result = SecPupilRate    \r\n                               \r\n  \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUGA_P08a_Per_Place_Funding_Rate","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PPRate As Decimal = 250 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n \r\n    Result = PPRate    \r\n   \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUGA_P09_Sec_Funding","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim SecRate As Decimal = Products.1718_SUG.SUGA_P08_Sec_Per_Pupil_Funding_Rate    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    Dim Prov_SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype    \r\n    Dim SUGA_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override\r\n    Dim IsNull  As Boolean\r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override,false,true)\r\n\r\n\r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    End if\r\n    \r\n     If Prov_SubType = \"11ACA\" And Phase = 2 Then \r\n            If IsNull = false Then\r\n                Result = SUGA_Override\r\n                \r\n              \r\n        ElseIf YearsOpen = 1 Then \r\n            If Phase = 2 \r\n                Result = PupilCount * SecRate \r\n            \r\n            Else Result = 0\r\n            End If             \r\n        End If                       \r\nEnd If \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n    \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"SUGA_P10_AllThrough_Funding","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As String = Products.1718_SUG.P01a_Phase\r\n    Dim YearsOpen As Decimal = Products.1718_SUG.SUG_P00_SUG_Years_Open \r\n    Dim PupilCount As Decimal = Products.1718_SUG.SUG_P01_pupilcount\r\n    Dim SecRate As Decimal = Products.1718_SUG.SUGA_P08_Sec_Per_Pupil_Funding_Rate    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim Prov_SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype    \r\n    Dim SUGA_Override As Decimal = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override\r\n    Dim IsNull As Boolean \r\n        IsNull = iif(Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_SUG_SUGA_Override, false,true)\r\n\r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    End if\r\n    \r\n     If Prov_SubType = \"11ACA\" And Phase = 3 Then \r\n            If IsNull = false Then\r\n                Result = SUGA_Override\r\n                \r\n              \r\n        ElseIf YearsOpen = 1 Then \r\n            If Phase = 3 Then\r\n                Result = PupilCount * SecRate \r\n            \r\n            Else Result = 0\r\n            End If             \r\n        End If                       \r\nEnd If \r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n    \r\n        \r\n","ProductType":"Funding","ScenarioName":"1718_SUG","FolderName":"2_SUG A pupil led","DecimalPlaces":0},{"Name":"test","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim P00 As Decimal = Products.1718_POG.P00_POG_Years_Open\r\nDim P01 As Decimal = Products.1718_POG.P01_Pri_pupilcount\r\nDim P02 As Decimal = Products.1718_POG.P02_Sec_pupilcount\r\nDim P03 As Decimal = Products.1718_POG.P03_Pri_FundingRate\r\nDim P04 As Decimal = Products.1718_POG.P04_Pri_Funding\r\nDim P05 As Decimal = Products.1718_POG.P05_Sec_FundingRate\r\nDim P06 As Decimal = Products.1718_POG.P06_Sec_Funding      \r\nDim P07 As Decimal = Products.1718_POG.P07_AllThrough_Funding\r\nDim P08 As Decimal = Products.1718_POG.P08_PriPlace_FundingRate\r\nDim P09 As Decimal = Products.1718_POG.P09_PriPlace_Funding\r\nDim P10 As Decimal = Products.1718_POG.P10_SecPlace_FundingRate           \r\nDim P11 As Decimal = Products.1718_POG.P11_SecPlace_Funding                                                                 \r\nDim P12 As Decimal = Products.1718_POG.P12_PriEmptyCohort1\r\nDim P13 As Decimal = Products.1718_POG.P13_PriEmptyCohort2         \r\nDim P14 As Decimal = Products.1718_POG.P14_PriEmptyCohort3\r\nDim P15 As Decimal = Products.1718_POG.P15_PriEmptyCohort4                 \r\nDim P16 As Decimal = Products.1718_POG.P16_PriEmptyCohort5\r\nDim P17 As Decimal = Products.1718_POG.P17_PriEmptyCohort6\r\nDim P18 As Decimal = Products.1718_POG.P18_Pri_Max_Cap\r\nDim P19 As Decimal = Products.1718_POG.P19_SecEmptyCohort1                 \r\nDim P20 As Decimal = Products.1718_POG.P20_SecEmptyCohort2\r\nDim P21 As Decimal = Products.1718_POG.P21_SecEmptyCohort3\r\nDim P22 As Decimal = Products.1718_POG.P22_SecEmptyCohort4\r\nDim P23 As Decimal = Products.1718_POG.P23_Sec_Max_Cap\r\nDim P24 As Decimal = Products.1718_POG.P24_AllThruEmptyCohort1\r\nDim P25 As Decimal = Products.1718_POG.P25_AllThruEmptyCohort2\r\nDim P26 As Decimal = Products.1718_POG.P26_AllThruEmptyCohort3\r\nDim P27 As Decimal = Products.1718_POG.P27_AllThruEmptyCohort4\r\nDim P28 As Decimal = Products.1718_POG.P28_AllThruEmptyCohort5\r\nDim P29 As Decimal = Products.1718_POG.P29_AllThruEmptyCohort6\r\nDim P30 As Decimal = Products.1718_POG.P30_AllThru_Max_Cap\r\nDim P31 As Decimal = Products.1718_POG.P31_1619FS_Year1\r\nDim P32 As Decimal = Products.1718_POG.P32_1619FS_Year2\r\nDim P33 As Decimal = Products.1718_POG.P33_UTC_Year1\r\nDim P34 As Decimal = Products.1718_POG.P34_UTC_Year2\r\nDim P35 As Decimal = Products.1718_POG.P35_UTC_Year3\r\nDim P36 As Decimal = Products.1718_POG.P36_StudioSchool_Year1\r\nDim P37 As Decimal = Products.1718_POG.P37_StudioSchool_Year2\r\nDim P38 As Decimal = Products.1718_POG.P38_StudioSchool_Year3\r\nDim P39 As Decimal = Products.1718_POG.P39_SpecialSchool_Year1\r\nDim P40 As Decimal = Products.1718_POG.P40_SpecialSchool_Year2\r\nDim P41 As Decimal = Products.1718_POG.P41_SpecialSchool_Year3\r\nDim P42 As Decimal = Products.1718_POG.P42_EmptyCohorts\r\nDim P43 As Decimal = Products.1718_POG.P43_PrimaryFunding\r\nDim P44 As Decimal = Products.1718_POG.P44_SecondaryFunding\r\nDim P45 As Decimal = Products.1718_POG.P45_AllThroughFunding\r\nDim P46 As Decimal = Products.1718_POG.P46_PlaceLedFunding\r\nDim P47 As Decimal = Products.1718_POG.P47_1619FreeSchoolFunding\r\nDim P48 As Decimal = Products.1718_POG.P48_UTCFunding\r\nDim P49 As Decimal = Products.1718_POG.P49_StudioSchoolFunding\r\nDim PP5 As Decimal = Products.1718_POG.P50_FAPTotal\r\nDim P51 As Decimal = Products.1718_POG.P51_FAPTotal\r\n\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"My Products","DecimalPlaces":0},{"Name":"P00_POG_Years_Open","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim DateOpen As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183)          \r\n        If DateOpen >= \"01/09/2017\" And DateOpen <= \"31/08/2018\" Then \r\n            Result = 1 \r\n        ElseIf DateOpen >= \"01/09/2016\" And DateOpen <= \"31/08/2017\" Then \r\n            Result = 2\r\n        ElseIf DateOpen >= \"01/09/2015\" And DateOpen <= \"31/08/2016\" Then \r\n            Result = 3\r\n        ElseIf DateOpen >= \"01/09/2014\" And DateOpen <= \"31/08/2015\" Then \r\n            Result = 4\r\n        ElseIf DateOpen >= \"01/09/2013\" And DateOpen <= \"31/08/2014\" Then \r\n            Result = 5\r\n        ElseIf DateOpen >= \"01/09/2012\" And DateOpen <= \"31/08/2013\" Then \r\n            Result = 6\r\n        ElseIf DateOpen < \"01/09/2012\" Then \r\n            Result = 0\r\n           \r\n           End If \r\n\r\nElse exclude(rid)\r\nEnd If \r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_POG","FolderName":"1_Pupil Led","DecimalPlaces":0},{"Name":"P01_Pri_pupilcount","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open\r\n    Dim Yr1 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr1_Intake_NOR_Primary\r\n    Dim Yr2 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr2_Intake_NOR_Primary \r\n    Dim Yr3 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr3_Intake_NOR_Primary \r\n    Dim Yr4 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr4_Intake_NOR_Primary \r\n    Dim Yr5 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr5_Intake_NOR_Primary \r\n    Dim Yr6 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr6_Intake_NOR_Primary     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then          \r\n        If YearsOpen = 1 Then \r\n            Result = Yr1\r\n        Else\r\n        If YearsOpen = 2  Then \r\n            Result = Yr2 - Yr1\r\n        Else\r\n        If YearsOpen = 3  Then \r\n            Result = Yr3 - Yr2\r\n        Else\r\n        If YearsOpen = 4  Then \r\n            Result = Yr4 - Yr3\r\n        Else\r\n        If YearsOpen = 5  Then \r\n            Result = Yr5 - Yr4\r\n        Else\r\n        If YearsOpen = 6  Then \r\n            Result = Yr6 - Yr5\r\n        Else \r\n            \r\nExclude(rid)\r\n  \r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\n \r\n\r\nReturn result   \r\n\r\n  \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_POG","FolderName":"1_Pupil Led","DecimalPlaces":0},{"Name":"P02_Sec_pupilcount","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open\r\n    Dim Yr1 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr1_Intake_NOR_Secondary\r\n    Dim Yr2 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr2_Intake_NOR_Secondary \r\n    Dim Yr3 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr3_Intake_NOR_Secondary \r\n    Dim Yr4 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr4_Intake_NOR_Secondary \r\n    Dim Yr5 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr5_Intake_NOR_Secondary \r\n    Dim Yr6 As Decimal = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Yr6_Intake_NOR_Secondary     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then  \r\n\r\n        If YearsOpen = 1 Then \r\n            Result = Yr1\r\n        Else\r\n        If YearsOpen = 2  Then \r\n            Result = Yr2 - Yr1\r\n        Else\r\n        If YearsOpen = 3  Then \r\n            Result = Yr3 - Yr2\r\n        Else\r\n        If YearsOpen = 4  Then \r\n            Result = Yr4  - Yr3\r\n        Else\r\n        If YearsOpen = 5  Then \r\n            Result = Yr5  - Yr4\r\n        Else\r\n        If YearsOpen = 6  Then \r\n            Result = Yr6 - Yr5\r\n        Else \r\n            \r\n        Exclude(rid)\r\n\r\nEnd If\r\nEnd If \r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_POG","FolderName":"1_Pupil Led","DecimalPlaces":0},{"Name":"P01a_Phase","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies 'calls the 'all academies' filter\r\n     Dim Phase As String = Datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.Academy_Phase 'calls phase from MasterSUGPOG dataset To be used In calculations\r\n     \r\n     Print (AcadFilter, \"AcadFilter\", rid)\r\n     Print (Phase, \"Phase\", rid)\r\n     \r\n     If AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183 then\r\n     If Phase Like \"Primary\" then\r\n\r\nresult = 1\r\n\r\nElseIf Phase Like \"Junior\" then\r\n\r\nresult = 1\r\n\r\nElseIf Phase Like \"Secondary\" then\r\n\r\n result = 2\r\n\r\nElseIf Phase Like \"All through\" Or Phase Like \"All Through\" then\r\n\r\nresult = 3\r\n\r\nElse\r\n\r\nresult = 0\r\n\r\n        End If\r\n        End If\r\n         \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_POG","FolderName":"1_Pupil Led","DecimalPlaces":0},{"Name":"P08_PriPlace_FundingRate","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim PriPlaceRate As Decimal = 250   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then        \r\n\r\n    Result = PriPlaceRate\r\n \r\nElse exclude(rid)\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"3_Place Led","DecimalPlaces":0},{"Name":"P09_PriPlace_Funding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Override As String =  DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As Boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)\r\n    Dim PriPupilCount As Decimal = Products.1718_POG.P01_Pri_pupilcount \r\n    Dim PriPlaceRate As Decimal = Products.1718_POG.P08_PriPlace_FundingRate   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase  \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype  \r\n    \r\n    \r\n    If FundingBasis = \"Estimate\" Or FundingBasis = \"Census\" Then\r\n    \r\n        Result = 0 \r\n        \r\n        Else\r\n        \r\n    If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 1 Then \r\n    \r\n    If IsNull=false Then\r\n\r\n    Result = Override\r\n         \r\n    Else \r\n    \r\n    If SubType = \"12FSC\" And Phase = 1 Then\r\n    \r\n        Result = PriPupilCount * PriPlaceRate\r\n\r\n    Else \r\n    \r\n    Exclude(rid)\r\n\r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"3_Place Led","DecimalPlaces":0},{"Name":"P10_SecPlace_FundingRate","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim SecPlaceRate As Decimal = 500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SecPlaceRate\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"3_Place Led","DecimalPlaces":0},{"Name":"P11_SecPlace_Funding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)\r\n    Dim SecPupilCount As Decimal = Products.1718_POG.P02_Sec_pupilcount \r\n    Dim SecPlaceRate As Decimal = Products.1718_POG.P10_SecPlace_FundingRate   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase   \r\n\r\n\r\n    If FundingBasis = \"Estimate\" Or FundingBasis = \"Census\" Then\r\n    \r\n        Result = 0\r\n    \r\n    Else                                                         \r\n        \r\n        If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 2 Then \r\n        \r\n            If IsNull = false Then  \r\n            \r\n                Result = Override\r\n            \r\n            Else \r\n            \r\n                If (SubType = \"12FSC\" Or SubType = \"22AAP\" Or SubType = \"19FSS\") And Phase = 2 Then\r\n                \r\n                    Result = SecPupilCount * SecPlaceRate\r\n                \r\n                Else\r\n                \r\n                    exclude(rid)\r\n                \r\n                End If \r\n            End If \r\n        End If \r\n    End If \r\n\r\n    Return result   \r\n\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"3_Place Led","DecimalPlaces":0},{"Name":"P11a_AllThrough_Place","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)\r\n    Dim PriPupilCount As Decimal = Products.1718_POG.P01_Pri_pupilcount \r\n    Dim PriPlaceRate As Decimal = Products.1718_POG.P08_PriPlace_FundingRate\r\n    Dim SecPupilCount As Decimal = Products.1718_POG.P02_Sec_pupilcount \r\n    Dim SecPlaceRate As Decimal = Products.1718_POG.P10_SecPlace_FundingRate   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase   \r\n\r\n\r\n    If FundingBasis = \"Estimate\" Or FundingBasis = \"Census\" Then\r\n    \r\n    Result = 0\r\n    \r\n    Else                                                         \r\n                \r\n    If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 3 Then \r\n     \r\n     If isNull = false Then  \r\n     \r\n     Result = Override\r\n \r\n    Else \r\n    \r\n    If (SubType = \"12FSC\" Or SubType = \"22AAP\" Or SubType = \"19FSS\") And Phase = 3 Then\r\n    \r\n        Result = (PriPupilCount * PriPlaceRate) + (SecPupilCount * SecPlaceRate)\r\n\r\n        Else\r\n        exclude(rid)\r\n\r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\n\r\n    Return result   \r\n\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"3_Place Led","DecimalPlaces":0},{"Name":"P03_Pri_FundingRate","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim PriRate As Decimal = 250   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then         \r\n        Result = PriRate\r\nElse exclude(rid)\r\nEnd If \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"2_PPR Pupil Led","DecimalPlaces":0},{"Name":"P04_Pri_Funding","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String =   datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)\r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase\r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype   \r\n    Dim PriPupilCount As Decimal = Products.1718_POG.P01_Pri_pupilcount \r\n    Dim PriFundingRate As Decimal = Products.1718_POG.P03_Pri_FundingRate     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\n    If FundingBasis = \"Place\" Then\r\n        Result = 0\r\n    Else\r\n        If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 1 Then  \r\n            If IsNull = False then\r\n            Result = Override\r\n            Else\r\n                If Phase = 1 And SubType = \"12FSC\" Then \r\n                    Result = PriPupilCount * PriFundingRate\r\n                Else \r\n                    Exclude(rid)\r\n                End If\r\n            End if    \r\n        End If \r\n    End If \r\n  \r\n  \r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"2_PPR Pupil Led","DecimalPlaces":0},{"Name":"P05_Sec_FundingRate","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim SecRate As Decimal = 500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then          \r\n    \r\n    Result = SecRate\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"2_PPR Pupil Led","DecimalPlaces":0},{"Name":"P06_Sec_Funding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)    \r\n    Dim Phase As String = Products.1718_POG.P01a_Phase\r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim SecPupilCount As Decimal = Products.1718_POG.P02_Sec_pupilcount \r\n    Dim SecFundingRate As Decimal = Products.1718_POG.P05_Sec_FundingRate     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\n\r\n    If FundingBasis = \"Place\" Then\r\n        Result = 0\r\n    Else\r\n        If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 2 Then  \r\n            If IsNull = false Then \r\n                Result = Override     \r\n            Else\r\n                If SubType = \"12FSC\" Or SubType = \"13SSA\" Or SubType = \"15UTC\" Then \r\n                    Result = SecPupilCount * SecFundingRate\r\n                Else \r\n                    Exclude(rid)\r\n                End If \r\n            End If \r\n        End If \r\n    End If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"2_PPR Pupil Led","DecimalPlaces":0},{"Name":"P07_AllThrough_Funding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGPPR_Override,false,true)    \r\n    Dim Phase As String = Products.1718_POG.P01a_Phase \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim PriPupilCount As Decimal = Products.1718_POG.P01_Pri_pupilcount \r\n    Dim PriFundingRate As Decimal = Products.1718_POG.P03_Pri_FundingRate\r\n    Dim SecPupilCount As Decimal = Products.1718_POG.P02_Sec_pupilcount \r\n    Dim SecFundingRate As Decimal = Products.1718_POG.P05_Sec_FundingRate    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n\r\n\r\n    If FundingBasis = \"Place\" Then\r\n    \r\n       Result = 0\r\n       \r\n        Else\r\n        \r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 3 Then\r\n    \r\n    If IsNull = false Then\r\n\r\n     Result = Override\r\n                               \r\n    \r\n    Else\r\n       \r\n       If Phase = 3 And (SubType = \"12FSC\" Or SubType = \"13SSA\" Or SubType = \"15UTC\") Then\r\n       \r\n                Result = (PriPupilCount * PriFundingRate) + (SecPupilCount * SecFundingRate) \r\n            \r\nElse\r\nexclude(rid)\r\n\r\nEnd If \r\nEnd If \r\nEnd If \r\nEnd If \r\n\r\n    Return result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"2_PPR Pupil Led","DecimalPlaces":0},{"Name":"P12_PriEmptyCohort1","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n\r\n    Dim PriEmpty1 As Decimal = 13500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then   \r\n    Result = PriEmpty1\r\nElse exclude(rid)\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P13_PriEmptyCohort2","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim PriEmpty2 As Decimal = 27000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then     \r\n    Result = PriEmpty2\r\nElse exclude(rid)\r\nEnd If \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P14_PriEmptyCohort3","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim PriEmpty3 As Decimal = 40500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then        \r\nResult = PriEmpty3\r\n\r\nElse exclude(rid)\r\nEnd If \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P15_PriEmptyCohort4","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim PriEmpty4 As Decimal = 54000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n    \r\n    Result = PriEmpty4\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P16_PriEmptyCohort5","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PriEmpty5 As Decimal = 67500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then \r\n    Result = PriEmpty5\r\n\r\nElse exclude(rid)\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P17_PriEmptyCohort6","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PriEmpty6 As Decimal = 80500   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then       \r\n        \r\n        Result = PriEmpty6\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P18_Pri_Max_Cap","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n                                       \r\n    Dim PriMaxCap As Decimal = 283000   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = PriMaxCap\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P19_SecEmptyCohort1","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecEmpty1 As Decimal = 31000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then \r\n    \r\n    Result = SecEmpty1\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P20_SecEmptyCohort2","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecEmpty2 As Decimal = 62500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SecEmpty2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P21_SecEmptyCohort3","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecEmpty3 As Decimal = 93500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SecEmpty3\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P22_SecEmptyCohort4","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecEmpty4 As Decimal = 125000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SecEmpty4\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function                                                  \r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P23_Sec_Max_Cap","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecMaxCap As Decimal = 312000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then \r\n\r\n    Result = SecMaxCap\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P24_AllThruEmptyCohort1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty1 As Decimal = 27000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATEmpty1\r\n    \r\nElse exclude(rid)\r\n                                         \r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P25_AllThruEmptyCohort2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty2 As Decimal = 40500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then \r\n    \r\n    Result = ATEmpty2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function                                              ","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P26_AllThruEmptyCohort3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty3 As Decimal = 54000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATEmpty3\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n                                                            ","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P27_AllThruEmptyCohort4","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty4 As Decimal =  62500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATEmpty4\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result                                                  \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P28_AllThruEmptyCohort5","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty5 As Decimal = 93500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATEmpty5\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P29_AllThruEmptyCohort6","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATEmpty6 As Decimal = 125000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATEmpty6\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P30_AllThru_Max_Cap","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim ATMaxCap As Decimal = 402500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = ATMaxCap\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n\r\n \r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P31_1619FS_Year1","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FSY1 As Decimal = 108000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = FSY1\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P32_1619FS_Year2","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim FSY2 As Decimal = 27000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = FSY2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P33_UTC_Year1","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim UTCY1 As Decimal = 157500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = UTCY1\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P34_UTC_Year2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim UTCY2 As Decimal = 94500\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = UTCY2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P35_UTC_Year3","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim UTCY3 As Decimal = 63000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = UTCY3\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P36_StudioSchool_Year1","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY1 As Decimal = 90000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY1\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P37_StudioSchool_Year2","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY2 As Decimal = 54000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P38_StudioSchool_Year3","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY3 As Decimal = 36000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY3\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P39_SpecialSchool_Year1","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY1 As Decimal = 85000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY1\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P40_SpecialSchool_Year2","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY2 As Decimal = 51000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY2\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n                                                     ","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P41_SpecialSchool_Year3","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SSY3 As Decimal = 34000\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = SSY3\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If \r\n    \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P42_EmptyCohorts","Script":"\r\nPublic Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim academyfilter As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim Phase As String = Products.1718_POG.P01a_Phase          \r\n    Dim POG_Years_Open As Decimal = products.1718_POG.P00_POG_Years_Open\r\n    Dim EmptyCohortsOnOpen As Decimal = datasets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.MasterSUGPOG.EmptyCohorts_On_Open\r\n    \r\n    Print(FundingBasis,\"FundingBasis\",rid)\r\n    Print(Phase,\"Phase\",rid)\r\n    Print(POG_Years_Open,\"POG_Years_Open\",rid)\r\n    Print(EmptyCohortsOnOpen,\"EmptyCohortsOnOpen\",rid)\r\n    \r\n   If FundingBasis = \"Place\" then\r\n   result = 0 \r\n   Else\r\n   \r\n   If academyFilter = (17181 Or academyFilter = 17182 Or academyFilter = 17183) And Phase = 1 then\r\n   If POG_Years_Open = 1 then\r\n   result = EmptyCohortsOnOpen\r\n   End if\r\n   \r\n   If POG_Years_Open = 2 then\r\n   If (EmptyCohortsOnOpen - 1) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 1\r\n    End If \r\n    End If\r\n    \r\n   If POG_Years_Open = 3 then\r\n   If (EmptyCohortsOnOpen - 2) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 2\r\n    End If\r\n    End If\r\n    \r\n   If POG_Years_Open = 4 then\r\n   If (EmptyCohortsOnOpen - 3) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 3\r\n    End If\r\n    End If\r\n    \r\n   If POG_Years_Open = 5 then\r\n   If (EmptyCohortsOnOpen - 4) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 4\r\n    End If\r\n    End If\r\n    \r\n   If POG_Years_Open = 6 then\r\n   If (EmptyCohortsOnOpen - 5) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 5\r\n    End if\r\n   End If \r\n    \r\n       End if\r\n     \r\n   \r\n   '----------------\r\n   \r\n   If academyFilter = (17181 Or academyFilter = 17182 Or academyFilter = 17183) And Phase = 2 then\r\n   If POG_Years_Open = 1 then\r\n   result = EmptyCohortsOnOpen\r\n     End if\r\n   End If \r\n   \r\n   If POG_Years_Open = 2 then\r\n   If (EmptyCohortsOnOpen - 1) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 1\r\n    End if\r\n   End If \r\n    \r\n   If POG_Years_Open = 3 then\r\n   If (EmptyCohortsOnOpen - 2) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 2\r\n    End if\r\n   End If \r\n   \r\n    If POG_Years_Open = 4 then\r\n   If (EmptyCohortsOnOpen - 3) < 0 then\r\n    result = 0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 3\r\n    End if\r\n    End if\r\n       \r\n    '----------------------------------\r\n    \r\n   If academyFilter = (17181 Or academyFilter = 17182 Or academyFilter = 17183) And Phase = 3 then\r\n   If POG_Years_Open = 1 then\r\n   If EmptyCohortsOnOpen > 6 then\r\n   result = 6\r\n   else\r\n   result = EmptyCohortsOnOpen\r\n   End if\r\n   End If   \r\n   \r\n   If POG_Years_Open = 2 then\r\n   If (EmptyCohortsOnOpen - 2) > 6 then\r\n    result = 6\r\n    else\r\n    If (EmptyCohortsOnOpen - 2) < 0 then    \r\n    result =  0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 2\r\n   End if\r\n   End If\r\nEnd if   \r\n    \r\n   If POG_Years_Open = 3 then\r\n   If (EmptyCohortsOnOpen - 4) > 6 then\r\n    result = 6\r\n    else\r\n    If (EmptyCohortsOnOpen - 4) < 0 then    \r\n    result =  0\r\n    Else \r\n    result = EmptyCohortsOnOpen - 4\r\n   End if\r\n   End If \r\n   End if\r\n    \r\n   If POG_Years_Open = 4 then\r\n   If (EmptyCohortsOnOpen - 6) > 4 then\r\n    result = 4\r\n    Else \r\n    If (EmptyCohortsOnOpen - 6) < 0 then    \r\n    result =  0\r\n    else\r\n    result = EmptyCohortsOnOpen - 6\r\n   End if\r\n   End If\r\nEnd if   \r\n    \r\n   If POG_Years_Open = 5 then\r\n   If (EmptyCohortsOnOpen - 8) > 2 then\r\n    result = 2\r\n    Else \r\n    If (EmptyCohortsOnOpen - 8) < 0 then    \r\n    result =  0\r\n    else\r\n    result = EmptyCohortsOnOpen - 8\r\n   End if\r\n   End If \r\n   End if\r\n    \r\n   If POG_Years_Open = 6 then\r\n   If (EmptyCohortsOnOpen - 9) > 1 then\r\n    result = 1\r\n    Else\r\n    If (EmptyCohortsOnOpen - 9) < 0 then    \r\n    result =  0\r\n    Else\r\n    Result = EmptyCohortsOnOpen - 9\r\n    \r\n    End if\r\n    End if\r\n    End if\r\n    End if\r\n    End if\r\n     \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P43_PrimaryFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override\r\n    Dim UPIN As Decimal = Datasets.Administration.Providers.Provider_Information.UPIN\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Phase As String = Products.1718_POG.P01a_Phase \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim EmptyCohorts As Decimal = Products.1718_POG.P42_EmptyCohorts\r\n    Dim Pri1 As Decimal = Products.1718_POG.P12_PriEmptyCohort1\r\n    Dim Pri2 As Decimal = Products.1718_POG.P13_PriEmptyCohort2\r\n    Dim Pri3 As Decimal = Products.1718_POG.P14_PriEmptyCohort3\r\n    Dim Pri4 As Decimal = Products.1718_POG.P15_PriEmptyCohort4\r\n    Dim Pri5 As Decimal = Products.1718_POG.P16_PriEmptyCohort5\r\n    Dim Pri6 As Decimal = Products.1718_POG.P17_PriEmptyCohort6    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n    \r\n    If FundingBasis = \"Place\" Then \r\n        Result = 0\r\n                \r\n    Else\r\n    \r\nIf AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 1 And (SubType = \"12FSC\" Or UPIN = \"130501\" Or UPIN = \"118604\") Then  \r\n\r\n        If IsNull= false Then \r\n        Result = Override\r\n                \r\n    Else\r\n            If EmptyCohorts = 1 Then \r\n              result = Pri1   \r\n                \r\n            Else\r\n            If EmptyCohorts = 2 Then \r\n                result = Pri2\r\n                \r\n            Else\r\n            If EmptyCohorts = 3 Then \r\n                result = Pri3\r\n                \r\n            Else\r\n            If EmptyCohorts = 4 Then \r\n                result = Pri4   \r\n            Else\r\n            If EmptyCohorts = 5 Then \r\n                result = Pri5\r\n                \r\n            Else\r\n            If EmptyCohorts = 6 Then \r\n                result = Pri6\r\n         \r\n            \r\n            End If \r\n            End If \r\n            End If \r\n            End If \r\n            End If \r\n            End If \r\n            End If\r\n            End If\r\n            End If\r\n                           \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P44_SecondaryFunding","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override \r\n    Dim UPIN As Decimal = Datasets.Administration.Providers.Provider_Information.UPIN\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim EmptyCohorts As Decimal = Products.1718_POG.P42_EmptyCohorts\r\n    Dim Sec1 As Decimal = Products.1718_POG.P19_SecEmptyCohort1\r\n    Dim Sec2 As Decimal = Products.1718_POG.P20_SecEmptyCohort2\r\n    Dim Sec3 As Decimal = Products.1718_POG.P21_SecEmptyCohort3\r\n    Dim Sec4 As Decimal = Products.1718_POG.P22_SecEmptyCohort4    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n\r\n    If FundingBasis = \"Place\" Then \r\n        Result = 0\r\n        \r\n        Else\r\n        \r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 2 And (SubType = \"12FSC\" Or UPIN = \"132819\") Then\r\n\r\n    If IsNull = false Then \r\n        Result = Override\r\n        \r\n        Else\r\n        \r\n            If EmptyCohorts = 1 Then \r\n                Result = Sec1\r\n                \r\n            Else\r\n            If EmptyCohorts = 2 Then \r\n                Result = Sec2\r\n                \r\n            Else\r\n            If EmptyCohorts = 3 Then \r\n                Result = Sec3\r\n           \r\n           Else\r\n            If EmptyCohorts = 4 Then \r\n                Result = Sec4   \r\n     Else exclude(rid)           \r\n            \r\n    End If \r\n    End If \r\n    End If\r\n    End If\r\n    End If\r\n    End If\r\n    End If\r\n  \r\n \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P45_AllThroughFunding","Script":"Public Function GetProductResult(rid As String) As Double 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String =   DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override \r\n    Dim IsNull As Boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim Phase As Decimal = Products.1718_POG.P01a_Phase \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim EmptyCohorts As Decimal = Products.1718_POG.P42_EmptyCohorts\r\n    Dim AT1 As Decimal = Products.1718_POG.P24_AllThruEmptyCohort1\r\n    Dim AT2 As Decimal = Products.1718_POG.P25_AllThruEmptyCohort2\r\n    Dim AT3 As Decimal = Products.1718_POG.P26_AllThruEmptyCohort3\r\n    Dim AT4 As Decimal = Products.1718_POG.P27_AllThruEmptyCohort4\r\n    Dim AT5 As Decimal = Products.1718_POG.P28_AllThruEmptyCohort5\r\n    Dim AT6 As Decimal = Products.1718_POG.P29_AllThruEmptyCohort6   \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    \r\n    print(AT1,\"AT1\",rid)\r\n    print(AT2,\"AT2\",rid)\r\n    print(AT3,\"AT3\",rid)\r\n    print(AT4,\"AT4\",rid)\r\n    print(AT5,\"AT5\",rid)\r\n    print(AT6,\"AT6\",rid)\r\n    print(FundingBasis,\"Funding Basis\",rid)\r\n    print(phase,\"Phase\",rid)\r\n    print(SubType,\"SubType\",rid)\r\n    print(AcadFilter,\"AcadFilter\",rid)\r\n    print(Override,\"Override\",rid)\r\n\r\nIf FundingBasis = \"Place\" Then                               \r\n    Result = 0\r\nElse\r\n    If (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And Phase = 3 And SubType = \"12FSC\" Then\r\n        If IsNull = false  Then \r\n            Result = Override\r\n        Else\r\n            \r\n            If EmptyCohorts = 1 Then \r\n                Result = AT1\r\n            Else\r\n                If EmptyCohorts = 2 Then \r\n                    Result = AT2\r\n                Else\r\n                    If EmptyCohorts = 3 Then \r\n                        Result = AT3\r\n                    Else\r\n                        If EmptyCohorts = 4 Then \r\n                            Result = AT4 \r\n                        Else\r\n                            If EmptyCohorts = 5 Then \r\n                                Result = AT5\r\n                            Else\r\n                                If EmptyCohorts = 6 Then \r\n                                    Result = AT6    \r\n                                End If \r\n                            End If \r\n                        End If \r\n                    End If \r\n                End If \r\n            End If \r\n  \r\n        End If \r\n    End If \r\nEnd If \r\n         \r\n                  \r\n\r\nReturn result   \r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"4_LD Pupil Led","DecimalPlaces":0},{"Name":"P46_PlaceLedFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override\r\n    Dim IsNull As boolean\r\n        IsNull = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype \r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open \r\n    Dim SS1 As Decimal = Products.1718_POG.P39_SpecialSchool_Year1\r\n    Dim SS2 As Decimal = Products.1718_POG.P40_SpecialSchool_Year2 \r\n    Dim SS3 As Decimal = Products.1718_POG.P41_SpecialSchool_Year3  \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n\r\n    If FundingBasis = \"Census\" Or FundingBasis = \"Estimate\" Then \r\n        Result = 0\r\n                                                                          \r\n        Else                                                                              \r\n        \r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And SubType = \"12FSC\" Then\r\n\r\n    If IsNull = false Then \r\n     Result = Override\r\n\r\n    Else\r\n    If YearsOpen = 1 Then                                  \r\n        Result = SS1\r\n        \r\n    Else\r\n    If YearsOpen = 2 Then \r\n        Result = SS2\r\n        \r\n    Else\r\n    If YearsOpen = 3 Then \r\n        Result = SS3  \r\n        \r\n   \r\n    \r\n    End If \r\n    End If\r\n    End If\r\n    End If\r\n    End If\r\n    End If\r\n    \r\n    \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"P47_1619FreeSchoolFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override\r\n    Dim IsNull As boolean\r\n        IsNull = iif( DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype    \r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open \r\n    Dim SBSNOR As Decimal = Products.1718_NOR.NOR_P26_Total_NOR_SBS\r\n    Dim FS1 As Decimal = Products.1718_POG.P31_1619FS_Year1\r\n    Dim FS2 As Decimal = Products.1718_POG.P32_1619FS_Year2\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And SubType = \"19FSS\" And SBSNOR = 0 Then\r\n\r\n    If IsNull = false Then  \r\n        Result = Override\r\n    \r\n     Else\r\n          If YearsOpen = 1 Then \r\n            Result = FS1  \r\n            \r\n        Else\r\n        If YearsOpen = 2 Then \r\n            Result = FS2\r\n            \r\n        \r\n        \r\n        End If \r\n        End If \r\n        End If \r\n        End If \r\n        \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"P48_UTCFunding","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override \r\n    Dim IsNull As Boolean\r\n        IsNUll = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype     \r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open \r\n    Dim UTC1 As Decimal = Products.1718_POG.P33_UTC_Year1\r\n    Dim UTC2 As Decimal = Products.1718_POG.P34_UTC_Year2\r\n    Dim UTC3 As Decimal = Products.1718_POG.P35_UTC_Year3 \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies   \r\n\r\n If FundingBasis = \"Place\" Then \r\n        Result = 0\r\n         \r\n     Else\r\n        \r\n    If AcadFilter = (17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And SubType = \"15UTC\" Then\r\n\r\n    If IsNull=false  Then \r\n        Result = Override\r\n    \r\n    Else\r\n        If YearsOpen = 1 Then \r\n            Result = UTC1\r\n            \r\n        Else\r\n        If YearsOpen = 2 Then                               \r\n            Result = UTC2\r\n            \r\n        Else\r\n        If YearsOpen = 3 Then \r\n            Result = UTC3\r\n            \r\n      \r\n        \r\n        End If \r\n        End If \r\n        End If\r\n        End If\r\n        End If\r\n        End If\r\n        \r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"P49_StudioSchoolFunding","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Override As String = DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override\r\n    Dim IsNull As boolean\r\n        IsNUll = iif(DataSets.Academy_Allocations.SUG_/_POG.SUGPOG_Data.1718_Adjustments.1718_POGLD_override,false,true)    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SubType As String = datasets.Administration.Providers.Provider_Information.Provider_Subtype    \r\n    Dim YearsOpen As Decimal = Products.1718_POG.P00_POG_Years_Open \r\n    Dim SS1 As Decimal = Products.1718_POG.P36_StudioSchool_Year1\r\n    Dim SS2 As Decimal = Products.1718_POG.P37_StudioSchool_Year2\r\n    Dim SS3 As Decimal = Products.1718_POG.P38_StudioSchool_Year3     \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n\r\n   If FundingBasis = \"Place\" then\r\n    result = 0\r\n    Else \r\n    \r\n    If acadFilter = (17181 Or acadFilter = 17182 Or acadFilter = 17183) And SubType = \"13SSA\" then\r\n    If IsNull = false then       \r\n    result = Override\r\n    Else\r\n    \r\n    If YearsOpen = 1 then  \r\n    result = SS1\r\n    \r\n    Else\r\n\r\n    If YearsOpen = 2 then\r\n    result = SS2\r\n    \r\n    Else\r\n\r\n    If YearsOpen = 3 then\r\n    result = SS3\r\n\r\n     \r\n\r\nElse exclude(rid)\r\nEnd If \r\nEnd If           \r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\n \r\n\r\n\r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"P50_FAPTotal","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Pri As Decimal = Products.1718_POG.P04_Pri_Funding\r\n    Dim Sec As Decimal = Products.1718_POG.P06_Sec_Funding\r\n    Dim AT As Decimal = Products.1718_POG.P07_AllThrough_Funding\r\n    Dim PriPlace As Decimal = Products.1718_POG.P09_PriPlace_Funding\r\n    Dim SecPlace As Decimal = Products.1718_POG.P11_SecPlace_Funding \r\n    Dim AllThroughPlace As Decimal = products.1718_POG.P11a_AllThrough_Place    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then\r\n\r\n    Result = Pri + Sec + AT + PriPlace + SecPlace + AllThroughPlace\r\n\r\nElse exclude(rid)\r\n\r\nEnd If \r\n\r\nReturn result                                                                                                    \r\n                                                                                                                 \r\nEnd Function                                                               \r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"P51_FAPTotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Pri As Decimal = Products.1718_POG.P43_PrimaryFunding \r\n    Dim Sec As Decimal = Products.1718_POG.P44_SecondaryFunding \r\n    Dim AT As Decimal = Products.1718_POG.P45_AllThroughFunding\r\n    Dim PLed As Decimal = Products.1718_POG.P46_PlaceLedFunding \r\n    Dim FS As Decimal = Products.1718_POG.P47_1619FreeSchoolFunding \r\n    Dim UTC As Decimal = Products.1718_POG.P48_UTCFunding               \r\n    Dim SS As Decimal = Products.1718_POG.P49_StudioSchoolFunding                            \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies     \r\n        \r\nIf (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) Then  \r\n\r\n    Result = Pri + Sec + AT + PLed + FS + UTC + SS\r\n    \r\nElse exclude(rid)\r\n\r\nEnd If                                                                           \r\n                                                                                \r\nReturn result   \r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_POG","FolderName":"5_Totals","DecimalPlaces":0},{"Name":"HN_Unit_Flag","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Decimal = 0\r\n    \r\n    Dim HN_UNIT As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.High_Needs_Unit\r\n    Dim AcadFilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n\r\n    \r\nIf HN_UNIT isnot nothing then \r\n    If AcadFilter = 17181 then    \r\n        If HN_UNIT.Contains(\"Yes\") Then \r\n            result = 1\r\n        Else\r\n            Result = 0\r\n        End If\r\n    Else Exclude(rid)  \r\n    End If\r\nEnd If  \r\n\r\n    Print(HN_UNIT, \"HN UNIT\",rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"Reception_Uplift_Flag","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim Result = 0\r\n  \r\n     Dim RU_Applicable As String =  LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Reception_Uplift_YesNo)\r\n\r\n    Print(RU_Applicable, \"Recep Uplift\",rid)\r\n    \r\n    If RU_Applicable = \"Yes\" Then\r\n        Result = 1\r\n    ElseIf RU_Applicable = \"NO\"  Then\r\n        Result = 0\r\n    Else \r\n        exclude(rid)    \r\n    End If\r\n    \r\n    If Result = 0 Then\r\n    Exclude(rid)\r\n    End If\r\n    \r\n    Return Result\r\n       \r\nEnd Function","ProductType":"Other","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P01_RU","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n     \r\n    Dim RU_Flag as Single = LAtoProv(Products.1718_NOR.Reception_Uplift_Flag)\r\n    Dim IsNull As Boolean\r\n    IsNull = IIf(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Reception_Uplift, false, true)    \r\n    Dim RU_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Reception_Uplift\r\n    Dim RU_APT As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.Reception_Difference\r\n    Dim RU_Census As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.Reception_Difference] \r\n    Dim RU_RFDC As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_Reception_Difference]\r\n    Dim NOR_RFDC As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR]\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?    \r\n    Dim NOR_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis \r\n                                                                                                                                                                 \r\n \r\n                                                      \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181) Then  \r\n    If RU_Flag = 1 And F900_FundingBasis = 1 And IsNull = False Then \r\n        Result = RU_InpAdj\r\n    \r\n    ElseIf RU_Flag = 1 And F900_FundingBasis = 1 And IsNull = True Then\r\n        Result = RU_Census\r\n        \r\n    ElseIf RU_Flag = 1 And F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_RFDC Then\r\n        Result = RU_InpAdj\r\n        \r\n    ElseIf RU_Flag = 1 And F900_FundingBasis = 2 Then \r\n        Result = RU_RFDC        \r\n\r\n    End If  \r\n\r\nElse If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    If RU_Flag = 1 And F900_FundingBasis = 1 Then\r\n        Result = RU_APT\r\n        \r\n    ElseIf RU_Flag = 1 And F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_RFDC Then\r\n        Result = RU_InpAdj\r\n    \r\n    ElseIf RU_Flag = 1 And F900_FundingBasis = 2 Then \r\n        Result = RU_RFDC    \r\n        \r\n    End If            \r\n\r\nElse Exclude(rid)  \r\nEnd If     \r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(RU_Flag, \"RU_Flag\", rid)\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)    \r\n    Print(RU_InpAdj, \"Inp And Adj RU\",rid)  \r\n\r\nreturn result       \r\n         \r\nEnd Function\r\n                       ","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P02_PRI","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n     \r\n    Dim IsNull As Boolean = iif(datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Primary,false,true)\r\n    Dim RU_RFDC As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_Reception_Difference]\r\n    Dim NOR_P001 As Double = Products.1718_NOR.P001_NOR_Est_Pri\r\n    Dim NOR_P008 As Double = Products.1718_NOR.P008_NOR_Est_RtoY11\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?    \r\n    Dim NOR_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR\r\n    Dim NOR_Pri_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Primary\r\n    Dim NOR_Pri_Census As Double = Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_Primary\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis \r\n    Dim NOR_Pri_APT_Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.NOR_Primary                                                                                                                                                                 \r\n    Dim NOR_P01_RU As Double = Products.1617_NOR.NOR_P01_RU\r\n                                                      \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181) Then  \r\n    If F900_FundingBasis = 1 And IsNull = False Then \r\n        Result = NOR_Pri_InpAdj\r\n    \r\n    ElseIf F900_FundingBasis = 1 And IsNull = True Then\r\n        Result = NOR_Pri_Census\r\n        \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Pri_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P001        \r\n\r\n    End If  \r\n\r\nElse If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    If F900_FundingBasis = 1 Then\r\n        Result = NOR_Pri_APT_Adj - NOR_P01_RU\r\n        \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Pri_InpAdj\r\n    \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P001    \r\n        \r\n    End If            \r\n\r\nElse Exclude(rid)  \r\nEnd If     \r\n    \r\nreturn result       \r\n         \r\nEnd Function\r\n                       \r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P03_Y1Y4","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n\r\n    Dim IsNull As Boolean\r\n    IsNull = IIf([Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Yr_1-4], false, true)    \r\n    Dim DateOpened as date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim NOR_Y1Y4_Census As Double = [DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_Y1-4]\r\n    Dim NOR_Y1Y4_InpAdj As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Yr_1-4]\r\n    Dim NOR_InpAdj As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR]\r\n    Dim NOR_Y1Y4_Est As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y1-4]\r\n    Dim NOR_Y1Y4_APT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.NOR_1-4_for_calculation_of_the_eligible_pupils_for_the_primary_prior_attainment_factor]\r\n    Dim NOR_P008 As double = Products.1718_NOR.P008_NOR_Est_RtoY11\r\n    Dim NOR_P002 As double = Products.1718_NOR.P002_NOR_Est_Y1to4\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis \r\n    \r\n    Print(IsNull, \"IsNull\", rid)\r\n    Print(NOR_InpAdj, \"NOR InputsAdj\", rid)\r\n    Print(NOR_Y1Y4_Census, \"NORY1Y4 Census\", rid)\r\n    Print(NOR_P002, \"NORY1Y4 Estimate\", rid)\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)    \r\n \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 then \r\n    \r\n    If F900_FundingBasis = 1 And IsNull = False Then\r\n        Result = NOR_Y1Y4_InpAdj\r\n       \r\n    ElseIf F900_FundingBasis = 1 And IsNull = True Then\r\n        Result = NOR_Y1Y4_Census         \r\n       \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Y1Y4_InpAdj\r\n    \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P002 \r\n    \r\n    End If \r\n \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    \r\n    If F900_FundingBasis = 1 Then\r\n        Result = NOR_Y1Y4_APT\r\n     \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Y1Y4_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P002\r\n        \r\n    End If         \r\n\r\nElse Exclude(rid)              \r\nEnd If\r\n\r\nReturn result\r\n     \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P04_Y5Y6","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim IsNull As Boolean\r\n    IsNull = IIf([Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Yr_5-6], false, true)    \r\n    Dim NOR_Y5Y6_InpAdj As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Yr_5-6] \r\n    Dim DateOpened as date = [Datasets.Administration.Providers.Provider_Information.Date_Opened]\r\n    Dim NOR_Y5Y6_Census As Double = [DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_Y5-6]\r\n    Dim NOR_P008 As Double = Products.1718_NOR.P008_NOR_Est_RtoY11\r\n    Dim NOR_P003 As Double = Products.1718_NOR.P003_NOR_Est_Y5to6\r\n    Dim NOR_Y5Y6_APT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.NOR_5-6_for_calculation_of_the_eligible_pupils_for_the_primary_prior_attainment_factor]\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim NOR_InpAdj As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR] \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    \r\n    Print(IsNull, \"IsNull\", rid)\r\n    Print(NOR_InpAdj, \"NOR Inp Adj\", rid)\r\n    Print(NOR_Y5Y6_Census,\"NOR Y5Y6 Census\",rid)\r\n    Print(NOR_P003,\"NOR Y5Y6 Estimate\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n   \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181) Then      \r\n    If F900_FundingBasis = 1 And IsNull = False Then\r\n        Result = NOR_Y5Y6_InpAdj       \r\n\r\n    ElseIf F900_FundingBasis = 1 And IsNull = True Then\r\n        Result = NOR_Y5Y6_Census         \r\n        \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Y5Y6_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P003 \r\n        \r\n    Else Result = 0 \r\n    End If \r\n \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    If F900_FundingBasis = 1 Then\r\n        Result = NOR_Y5Y6_APT\r\n       \r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_Y5Y6_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P003\r\n    End If       \r\n \r\nElse Exclude(rid) \r\nEnd If\r\n       \r\nReturn result\r\n     \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P05_NUR","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim IsNull As Boolean\r\n    Dim NOR_Nursery_Census = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.FTE_Nursery\r\n    Dim NOR_Nursery_RFDC = Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_FTE_Nursery\r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis = Products.1718_Global_Variables.F900_FundingBasis   \r\n   \r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(NOR_Nursery_Census, \"Nursery_NOR\",rid)         \r\n    Print(NOR_Nursery_RFDC, \"Nur_est\",rid)             \r\n   \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then\r\n    If F900_FundingBasis = 1 And ISNULL = False Then\r\n      result = NOR_Nursery_Census\r\n    \r\n    ElseIf F900_FundingBasis = 2 Then\r\n      result = NOR_Nursery_RFDC\r\n\r\n    End If \r\n    \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n        If F900_FundingBasis = 1 Then \r\n            Result = NOR_Nursery_Census\r\n        Else If F900_FundingBasis = 2 Then \r\n            Result = NOR_Nursery_RFDC\r\n        Else exclude(rid)\r\n        End If \r\n   \r\nElse Exclude(rid)      \r\nEnd If    \r\n          \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P06_SEC","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    Dim NOR_P07 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n                                                                  \r\n \r\n        \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then\r\n    \r\n    result = NOR_P07 + NOR_P08           \r\n \r\nElse Exclude(rid)   \r\n\r\nEnd If    \r\n\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)  \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)  \r\n\r\nReturn Result\r\n\r\nEnd function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P07_KS3","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n     \r\n    Dim IsNull As Boolean = iif(datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS3,false,true)\r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim NOR_KS3_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS3 \r\n    Dim NOR_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR \r\n    Dim NOR_KS3_Cen As Double = Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_KS3\r\n    Dim NOR_P006 As Double = Products.1718_NOR.P006_NOR_Est_KS3\r\n    Dim NOR_P008 As Double = Products.1718_NOR.P008_NOR_Est_RtoY11 \r\n    Dim NOR_KS3_AdjFact As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.NOR_KS3\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n                                                                  \r\n  \r\n    Print(NOR_InpAdj, \"NOR InpAdj\", rid)\r\n    Print(DateOpened, \"Date Opened\", rid)\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    Print(NOR_KS3_Cen, \"NOR_KS3_Cen\", rid)        \r\n    Print(NOR_P008, \"NOR_KS3_Est\", rid)   \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)   \r\n        \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 then\r\n    If F900_FundingBasis = 1 And ISNULL = False  Then\r\n        Result = NOR_KS3_InpAdj\r\n\r\n    ElseIf F900_FundingBasis = 1 And ISNULL = True Then\r\n        Result = NOR_KS3_Cen \r\n\r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_KS3_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then    \r\n        Result = NOR_P006\r\n    End If          \r\n\r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    If F900_FundingBasis = 1 Then\r\n        Result = NOR_KS3_AdjFact \r\n\r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_KS3_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P006\r\n    \r\n    End If           \r\n \r\nElse Exclude(rid)   \r\nEnd If    \r\n                    \r\nReturn Result\r\n\r\nEnd function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P08_KS4","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n         \r\n    Dim DateOpened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim IsNull As Boolean\r\n    IsNull = IIf(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS4, false, true)    \r\n    Dim NOR_KS4_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS4 \r\n    Dim NOR_InpAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR \r\n    Dim NOR_KS4_Cen As Double = Datasets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_KS4\r\n    Dim NOR_P007 As Double = Products.1718_NOR.P007_NOR_Est_KS4\r\n    Dim NOR_P008 As Double = Products.1718_NOR.P008_NOR_Est_RtoY11\r\n    Dim NOR_KS4_AdjFact As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.NOR_KS4\r\n    Dim Guaranteed As String = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n                                                                  \r\n    Print(IsNull, \"IsNull\", rid)\r\n    Print(NOR_InpAdj, \"NOR InpAdj\", rid)\r\n    Print(DateOpened, \"Date Opened\", rid)\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    Print(NOR_KS4_Cen, \"NOR_KS4_Cen\", rid)        \r\n    Print(NOR_P008, \"NOR_KS4_Est\", rid)   \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)   \r\n        \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 then\r\n    If F900_FundingBasis = 1 And ISNULL = False Then\r\n        Result = NOR_KS4_InpAdj\r\n\r\n    ElseIf F900_FundingBasis = 1 And ISNULL = True Then\r\n        Result = NOR_KS4_Cen \r\n\r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_KS4_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then    \r\n        Result = NOR_P007\r\n    End If          \r\n\r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    If F900_FundingBasis = 1 Then\r\n        Result = NOR_KS4_AdjFact \r\n\r\n    ElseIf F900_FundingBasis = 2 And Guaranteed = \"YES\" And NOR_InpAdj > NOR_P008 Then\r\n        Result = NOR_KS4_InpAdj\r\n        \r\n    ElseIf F900_FundingBasis = 2 Then \r\n        Result = NOR_P007\r\n    \r\n    End If           \r\n \r\nElse Exclude(rid)   \r\nEnd If    \r\n                    \r\nReturn Result\r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P09_APT_HN_PRI","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim NOR_APT_HN_Pri As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_primary_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17] \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(NOR_APT_HN_Pri,\"APT HN Pri\", rid)\r\n       \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then     \r\n    result = NOR_APT_HN_Pri \r\n    \r\nElse Exclude(rid)    \r\nEnd if    \r\n    \r\nReturn result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P10_APT_HN_KS3","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim NOR_APT_HN_KS3 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS3_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n      \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then     \r\n    result =  NOR_APT_HN_KS3\r\n    \r\nElse Exclude(rid)    \r\nEnd if\r\n\r\n    return Result\r\nEnd Function\r\n\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P11_APT_HN_KS4","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim NOR_APT_HN_KS4 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS4_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n\r\n  Print(NOR_APT_HN_KS4, \"APT_HN_HN_KS4\", rid)\r\n\r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then     \r\n    result =  NOR_APT_HN_KS4\r\n    \r\nElse Exclude(rid)    \r\nEnd if\r\n\r\n    return Result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P12_HND_HNP_HN_PRI","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim HNs_Places_Total As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n                                                                       \r\n    Dim Pri_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - HNs_Places_Total \r\n  \r\n    \r\n    If KS3_Unadj_Split = 0 And KS4_Unadj_Split = 0 And (Diff < 0 Or Diff > 0 ) Then\r\n        Result = Pri_Unadj_Split - Diff\r\n    Else Result = Pri_Unadj_Split\r\n    End If     \r\n\r\n              \r\nReturn result\r\nEnd Function\r\n\r\n\r\n\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P13_HND_HNP_HN_KS3","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim HNs_Places_Total As Double = [datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        \r\n    Dim Pri_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - HNs_Places_Total                              \r\n         \r\n    \r\n    If KS3_Unadj_Split > 0 And KS4_Unadj_Split = 0 And (Diff < 0 Or Diff > 0) Then\r\n        Result = KS3_Unadj_Split - Diff\r\n    Else Result = KS3_Unadj_Split\r\n    End If     \r\n\r\n              \r\nReturn result\r\nEnd Function\r\n\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P14_HND_HNP_HN_KS4","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim HNs_Places_Total As Double = [datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        \r\n    Dim Pri_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(HNs_Places_Total * NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - HNs_Places_Total\r\n    \r\n     \r\n    If KS4_Unadj_Split > 0 And (Diff < 0 Or Diff > 0) Then\r\n        Result = KS4_Unadj_Split - Diff\r\n    Else Result = KS4_Unadj_Split\r\n    End If     \r\n        \r\n  \r\n              \r\nReturn result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P15_HND_HNP_AP_PRI","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim AP_Places_Total As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places] \r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        \r\n    Dim Pri_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - AP_Places_Total \r\n        \r\n    \r\n    If KS3_Unadj_Split = 0 And KS4_Unadj_Split = 0 And (Diff > 0 Or Diff < 0) Then\r\n        Result = Pri_Unadj_Split - Diff\r\n    Else Result = Pri_Unadj_Split\r\n    End If     \r\n        \r\n\r\n              \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P16_HND_HNP_AP_KS3","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim AP_Places_Total As Double = [datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        \r\n    Dim Pri_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(AP_Places_Total* NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - AP_Places_Total\r\n    \r\n     \r\n    If KS3_Unadj_Split > 0 And KS4_Unadj_Split = 0 And (Diff < 0 Or Diff > 0) Then\r\n        Result = KS3_Unadj_Split - Diff\r\n    Else Result = KS3_Unadj_Split\r\n    End If     \r\n        \r\n \r\n              \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P17_HND_HNP_AP_KS4","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim AP_Places_Total As Double = [datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI \r\n    Dim NOR_P07_KS3 As Decimal = Products.1718_NOR.NOR_P07_KS3\r\n    Dim NOR_P08_KS4 As Decimal = Products.1718_NOR.NOR_P08_KS4\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        \r\n    Dim Pri_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P02_PRI / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS3_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P07_KS3 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim KS4_Unadj_Split As Decimal = math.round(AP_Places_Total * NOR_P08_KS4 / (NOR_P02_PRI + NOR_P07_KS3 + NOR_P08_KS4), 0)\r\n    Dim Total_Unadj_Split As Decimal = Pri_Unadj_Split + KS3_Unadj_Split + KS4_Unadj_Split\r\n    Dim Diff As Decimal = Total_Unadj_Split - AP_Places_Total\r\n    \r\n   \r\n    If KS4_Unadj_Split > 0 And (Diff > 0 Or Diff < 0) Then\r\n        Result = KS4_Unadj_Split - Diff\r\n    Else Result = KS4_Unadj_Split\r\n    End If     \r\n  \r\n              \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P18_HND_HN_Pre16","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Total_HNs_Places_Pre16 As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n   \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then      \r\n    Result = Total_HNs_Places_Pre16\r\n        \r\nElse Exclude(rid)    \r\nEnd if    \r\n      \r\nReturn result\r\n\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P19_HND_AP_Pre16","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Total_AP_Places_Pre16 As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n  \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then      \r\n    Result = Total_AP_Places_Pre16\r\n  \r\nElse Exclude(rid)   \r\nEnd If\r\n\r\nReturn result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P20_HND_Hosp_Pl","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_HND_Hosp_Pl As Double = Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Hospital_provision_places\r\n    \r\n      \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then     \r\n    Result = NOR_HND_Hosp_Pl \r\n   \r\nElse Exclude(rid)\r\nEnd If   \r\n   \r\nReturn result\r\nEnd Function\r\n\r\n    ","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P21_P16","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim NOR_P21_P16 As Double =  Products.AY1718_Acad_Post16.P03_Learners\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n   \r\n        \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then\r\n    Result = NOR_P21_P16\r\n    \r\nElse Exclude(rid)  \r\nEnd If\r\n                       \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P21b_P16_HN","Script":"  Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim NOR_P21_P16 As Double =  Products.AY1718_Acad_Post16.P04_HNPlaces\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n   \r\n        \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then\r\n    Result = NOR_P21_P16\r\n    \r\nElse Exclude(rid)  \r\nEnd If\r\n                       \r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"AY1718_FundingBasis","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n      \r\nIf currentscenario.PeriodID = 2017181 And (AcadFilter = 17181 Or AcadFilter = 17182 Or AcadFilter = 17183) And FundingBasis > 0 Then \r\n    Result = FundingBasis\r\nElse \r\n    exclude(rid)\r\nEnd If \r\n           \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P42a_Year_Groups_Primary","Script":"  Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim IsNull As Boolean = iif(datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Number_of_Primary_year_groups_for_all_schools,false,true)\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim Primary_YP_InAdj As Double = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Number_of_Primary_year_groups_for_all_schools\r\n    Dim Primary_YG_Census As Double = [Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Number_of_Primary_year_groups_for_all_schools]\r\n    Dim Primary_Middle_YG_Census As Double = [Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Number_of_Primary_year_groups_for_middle_schools]\r\n    Dim Primary_YG_Estimate As Double = Products.1718_NOR.P010_NOR_TotalPri_YG\r\n    Dim Primary_Year_Groups As Double\r\n    \r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    Print(Primary_YG_Census, \"Primary_YG_Census\", rid)\r\n    Print(Primary_Middle_YG_Census, \"Primary_Middle_YG_Census\", rid)\r\n    Print(Primary_YG_Estimate, \"Primary_YG_Estimate\", rid)\r\n                                                          \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    If F900_FundingBasis = 1 And IsNull = False Then\r\n    \r\n        Primary_Year_Groups = Primary_YP_InAdj\r\n    \r\n    Else If F900_FundingBasis = 1 And IsNull = true Then\r\n    \r\n        Primary_Year_Groups =  Primary_YG_Census\r\n    \r\n    Else If F900_FundingBasis = 2\r\n    \r\n        Primary_Year_Groups = Primary_YG_Estimate\r\n    \r\n    Else \r\n    \r\n        Primary_Year_Groups = 0\r\n    \r\n    End If  \r\nElse \r\n    Exclude(rid)   \r\nEnd If\r\n       \r\n       result = Primary_Year_Groups\r\n       \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P42b_Year_Groups_Secondary","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim IsNull = iif(datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Number_of_Secondary_year_groups_for_all_schools,false,true)\r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim Sec_YG_InAdj = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Number_of_Secondary_year_groups_for_all_schools    \r\n    Dim Sec_YG_Census = [Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Number_of_Secondary_year_groups_for_all_schools]\r\n    Dim Sec_Middle_YG_Census = [Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Number_of_Secondary_year_groups_for_middle_schools]\r\n    Dim Sec_YG_Estimate = Products.1718_NOR.P011_NOR_TotalSec_YG\r\n    Dim Secondary_Year_Groups As Double\r\n    \r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    Print(Sec_YG_Census, \"Sec_YG_Census\", rid)\r\n    Print(Sec_Middle_YG_Census, \"Sec_Middle_YG_Census\", rid)\r\n    Print(Sec_YG_Estimate, \"Sec_YG_Estimate\", rid)\r\n     \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    If F900_FundingBasis = 1 And IsNull = False Then\r\n        Secondary_Year_Groups = Sec_YG_InAdj\r\n    ElseIf F900_FundingBasis = 1 And IsNull = true Then\r\n        Secondary_Year_Groups = Sec_YG_Census\r\n    ElseIf F900_FundingBasis = 2 Then\r\n        Secondary_Year_Groups =  Sec_YG_Estimate\r\n    Else Secondary_Year_Groups = 0\r\n\r\nEnd If  \r\n    Else Exclude(rid)   \r\nEnd If\r\n\r\nresult = Secondary_Year_Groups\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P08a_Y7","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim IandANOR_Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Y7\r\n    Dim CNCNOR_Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_Y7\r\n    Dim ENCNOR_Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y7\r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim IandAPupilNumbers As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim IandANOR As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR\r\n    Dim FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim IsNull As Boolean = iif(datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS3,false,true)\r\n    \r\nIF currentscenario.periodid = 2017181 AND (AcadFilter = 17181 OR AcadFilter = 17182 OR AcadFilter = 17183) THEN\r\n\r\n    IF FundingBasis = 1 AND ISNULL = False THEN\r\n        \r\n        Result = IandANOR_Y7\r\n    \r\n    ELSEIF FundingBasis = 1 AND ISNULL = True THEN\r\n\r\n            Result = CNCNOR_Y7\r\n        \r\n        ELSEIF FundingBasis = 2 AND IandAPupilNumbers = \"YES\" AND (IandANOR > ENCNOR_Y7) THEN\r\n\r\n                Result = IandANOR_Y7\r\n        \r\n        ELSEIF FundingBasis = 2 THEN\r\n\r\n                    Result = ENCNOR_Y7\r\n                \r\n               End if\r\n       Else Exclude(rid)\r\n            End if\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n                                                                           ","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P08b_Y8to11","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim IandANOR_Y8to11 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Y8-11]\r\n    Dim CNCNOR_Y8to11 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Census_Number_Counts.NOR_Y8-11]\r\n    Dim ENCNOR_Y8 As Decimal = datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y8\r\n    Dim ENCNOR_Y9 As Decimal = datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y9\r\n    Dim ENCNOR_Y10 As Decimal = datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y10\r\n    Dim ENCNOR_Y11 As Decimal = datasets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y11\r\n    Dim RH As Decimal  = products.1718_NOR.P005_NOR_Est_Y8to11\r\n    Dim ENCNOR_Y8to11 As Decimal = (ENCNOR_Y8 + ENCNOR_Y9 + ENCNOR_Y10 + ENCNOR_Y11) \r\n    Dim AcadFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim IandAPupilNumbers As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Amended_pupil_numbers_guaranteed?\r\n    Dim IandANOR As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR\r\n    Dim FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim IsNull As Boolean = iif([datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Y8-11],false,true)\r\n \r\nprint(CNCNOR_Y8to11,\"Data\",rid)\r\nprint(fundingBasis, \"FundingBasis\",rid)\r\nprint(IsNull,\"IsNull\",rid)\r\n    \r\nIF currentscenario.periodid = 2017181 AND (AcadFilter = 17181 OR AcadFilter = 17182 OR AcadFilter = 17183) THEN\r\n\r\n    IF FundingBasis = 1 AND ISNULL = False THEN\r\n        \r\n        Result = IandANOR_Y8to11\r\n    \r\n    ELSEIF FundingBasis = 1 AND ISNULL = True THEN\r\n\r\n            Result = CNCNOR_Y8to11\r\n        \r\n        ELSEIF FundingBasis = 2 AND IandAPupilNumbers = \"YES\" AND (IandANOR > ENCNOR_Y8to11) THEN\r\n\r\n                Result = IandANOR_Y8to11\r\n        \r\n        ELSEIF FundingBasis = 2 THEN\r\n\r\n                    Result = ENCNOR_Y8to11\r\n                \r\n               End if\r\n        Else Exclude(rid)\r\n            End if\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P001_NOR_Est_Pri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Reception As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Reception\r\n    Dim Y1 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y1\r\n    Dim Y2 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y2\r\n    Dim Y3 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y3\r\n    Dim Y4 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y4\r\n    Dim Y5 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y5\r\n    Dim Y6 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y6\r\n    \r\n    Print(Reception,\"Reception\",rid)\r\n    Print(Y1,\"Year 1\",rid)\r\n    Print(Y2,\"Year 2\",rid)\r\n    Print(Y3,\"Year 3\",rid)\r\n    Print(Y4,\"Year 4\",rid)\r\n    Print(Y5,\"Year 5\",rid)\r\n    Print(Y6,\"Year 6\",rid)\r\n    \r\n    result = (Reception + Y1 + Y2 + Y3 + Y4 + Y5 + Y6)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P002_NOR_Est_Y1to4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y1 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y1\r\n    Dim Y2 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y2\r\n    Dim Y3 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y3\r\n    Dim Y4 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y4\r\n    \r\n    \r\n    result = (Y1 + Y2 + Y3 + Y4)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P003_NOR_Est_Y5to6","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y5 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y5\r\n    Dim Y6 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y6\r\n    \r\n    Result = Y5 + Y6\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P004_NOR_Est_Sec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y7\r\n    Dim Y8 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y8\r\n    Dim Y9 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y9\r\n    Dim Y10 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y10\r\n    Dim Y11 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y11\r\n    \r\n     result = (Y7 + Y8 + Y9 + Y10 + Y11)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P005_NOR_Est_Y8to11","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Y8 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y8\r\n    Dim Y9 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y9\r\n    Dim Y10 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y10\r\n    Dim Y11 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y11\r\n    \r\n    result = (Y8 + Y9 + Y10 + Y11)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P006_NOR_Est_KS3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y7\r\n    Dim Y8 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y8\r\n    Dim Y9 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y9\r\n    \r\n    result = (Y7 + Y8 + Y9)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P007_NOR_Est_KS4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\nDim result As Decimal = 0 'change to As String if text product\r\n    Dim Y10 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y10\r\n    Dim Y11 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y11\r\n    \r\n    result = Y10 + Y11\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P008_NOR_Est_RtoY11","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Pri As Decimal = Products.1718_NOR.P001_NOR_Est_Pri\r\n    Dim Sec As Decimal = Products.1718_NOR.P004_NOR_Est_Sec\r\n    \r\n    result = Pri + Sec\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P009_NOR_Est_Y12toY14","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y12 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y12\r\n    Dim Y13 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y13\r\n    Dim Y14 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y14\r\n    \r\n    result = Y12 + Y13 + Y14\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P010_NOR_TotalPri_YG","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Reception As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Reception\r\n    Dim Y1 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y1\r\n    Dim Y2 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y2\r\n    Dim Y3 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y3\r\n    Dim Y4 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y4\r\n    Dim Y5 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y5\r\n    Dim Y6 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y6\r\n    Dim Reception_YG As Double\r\n    Dim Y1_YG As Double\r\n    Dim Y2_YG As Double\r\n    Dim Y3_YG As Double\r\n    Dim Y4_YG As Double\r\n    Dim Y5_YG As Double\r\n    Dim Y6_YG As Double\r\n    \r\n    If (Reception > 0) then\r\n        Reception_YG = 1\r\n    Else\r\n        Reception_YG = 0\r\n    End if\r\n    \r\n    If (Y1 > 0) then\r\n        Y1_YG = 1\r\n    Else\r\n        Y1_YG = 0\r\n    End if\r\n    \r\n    If (Y2 > 0) Then\r\n        Y2_YG = 1\r\n    Else\r\n        Y2_YG = 0\r\n    End if\r\n    \r\n    If (Y3 > 0) Then\r\n        Y3_YG = 1\r\n    Else\r\n        Y3_YG = 0\r\n    End if\r\n    \r\n    If (Y4 > 0) Then\r\n        Y4_YG = 1\r\n    Else\r\n        Y4_YG = 0\r\n    End if\r\n    \r\n    If (Y5 > 0) Then\r\n        Y5_YG = 1\r\n    Else\r\n        Y5_YG = 0\r\n    End if\r\n    \r\n    If (Y6 > 0) Then\r\n        Y6_YG = 1\r\n    Else\r\n        Y6_YG = 0\r\n    End if\r\n    \r\n    Result = (Reception_YG + Y1_YG + Y2_YG + Y3_YG + Y4_YG + Y5_YG + Y6_YG)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P011_NOR_TotalSec_YG","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim Y7 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y7\r\n    Dim Y8 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y8\r\n    Dim Y9 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y9\r\n    Dim Y10 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y10\r\n    Dim Y11 As Decimal = DataSets.Academy_Allocations.AY_2017/18.Number_Counts.Estimate_Number_Counts.Est_NOR_Y11\r\n    Dim Y7_YG As Double\r\n    Dim Y8_YG As Double\r\n    Dim Y9_YG As Double\r\n    Dim Y10_YG As Double\r\n    Dim Y11_YG As Double\r\n           \r\n    If (Y7 > 0) Then\r\n        Y7_YG = 1\r\n    Else\r\n        Y7_YG = 0\r\n    End if\r\n    \r\n    If (Y8 > 0) Then\r\n        Y8_YG = 1\r\n    Else\r\n        Y8_YG = 0\r\n    End if\r\n    \r\n    If (Y9 > 0) Then\r\n        Y9_YG = 1\r\n    Else\r\n        Y9_YG = 0\r\n    End if\r\n    \r\n    If (Y10 > 0) Then\r\n        Y10_YG = 1\r\n    Else\r\n        Y10_YG = 0\r\n    End if\r\n    \r\n    If (Y11 > 0) Then\r\n        Y11_YG = 1\r\n    Else\r\n        Y11_YG = 0\r\n    End if\r\n    \r\n    Result = (Y7_YG + Y8_YG + Y9_YG + Y10_YG + Y11_YG)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"P012_NOR_Total_YG_R_Y11","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim P010 As Decimal = Products.1718_NOR.P010_NOR_TotalPri_YG\r\n    Dim P011 As Decimal = Products.1718_NOR.P011_NOR_TotalSec_YG\r\n    \r\n    result = P010 + P011\r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"a_NOR_Detail","DecimalPlaces":0},{"Name":"NOR_P23_Total_NOR_KS3_SBS","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n              \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P07_KS3 As Double = Products.1718_NOR.NOR_P07_KS3       \r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim NOR_P23b_Actual_HN_KS3_Deducted As Double = Products.1718_NOR.NOR_P23b_Actual_HN_KS3_Deducted\r\n         \r\n\r\nIF currentscenario.periodID = 2017181 AND (F100_AllAcademies = 17182 OR F100_AllAcademies = 17183) AND F900_FundingBasis = 1 THEN \r\nResult = NOR_P07_KS3\r\nELSE \r\nResult = NOR_P07_KS3 - NOR_P23b_Actual_HN_KS3_Deducted\r\n\r\n         \r\nEnd If     \r\n   \r\n     \r\n    \r\n    Print(F900_FundingBasis, \"Funding_Basis\", rid)\r\n    Print(NOR_P07_KS3, \"NOR_P07_KS3\", rid)\r\n    Print(NOR_P23b_Actual_HN_KS3_Deducted, \"NOR_P23b_Actual_HN_KS3_Deducted\", rid)\r\n    \r\n     \r\nReturn Result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P23b_Actual_HN_KS3_Deducted","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n              \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim TotalPlacesAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17]\r\n    Dim APT As Boolean\r\n    APT = IIf(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17, false, true)    \r\n    Dim NOR_Inp_Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS3\r\n    Dim Pre16HNData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim Pre16APData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    Dim TotalPlacesHNData As Double = Pre16HNData + Pre16APData\r\n    Dim NOR_P10_APT_HN_KS3 As Double = Products.1718_NOR.NOR_P10_APT_HN_KS3    \r\n    Dim NOR_P16_HND_HNP_AP_KS3 As Double= Products.1718_NOR.NOR_P16_HND_HNP_AP_KS3 \r\n    Dim NOR_P13_HND_HNP_HN_KS3 As Double =  Products.1718_NOR.NOR_P13_HND_HNP_HN_KS3  \r\n    Dim HND_HN_KS3 As Double = NOR_P16_HND_HNP_AP_KS3 + NOR_P13_HND_HNP_HN_KS3     \r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim HN_to_Deduct As Double\r\n    \r\n     \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then\r\n    If (APT = True Or TotalPlacesAPT = 0) And TotalPlacesHNData > 0 Then\r\n        HN_to_deduct = 0\r\n    Else If TotalPlacesAPT > TotalPlacesHNData Then\r\n        HN_to_deduct = HND_HN_KS3 \r\n    Else \r\n        HN_to_deduct = NOR_P10_APT_HN_KS3\r\n    End If     \r\n   \r\nElse Exclude(rid)\r\n\r\nEnd If    \r\n    \r\n    \r\n    Print(F900_FundingBasis, \"Funding_Basis\", rid)\r\n    Print(NOR_P10_APT_HN_KS3, \"NOR_P10_APT_HN_KS3\", rid)\r\n    Print(NOR_P16_HND_HNP_AP_KS3, \"NOR_P16_HND_HNP_AP_KS3\", rid)\r\n    Print(NOR_P13_HND_HNP_HN_KS3, \"NOR_P13_HND_HNP_HN_KS3\", rid)\r\n    Print(HND_HN_KS3, \"HND_HN_KS3\", rid)\r\n    Print(HN_to_deduct, \"HN_to_deduct\", rid)\r\n    Print(APT, \"APT\", rid)\r\n \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 1 Then \r\n    Result = 0\r\nElse \r\n    Result = HN_to_deduct \r\nEnd If\r\n    \r\nReturn Result\r\nEnd Function\r\n\r\n\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P24_Total_NOR_KS4_SBS","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P08_KS4 As Double = Products.1718_NOR.NOR_P08_KS4\r\n    Dim NOR_P24b_Actual_HN_KS4_Deducted As Double = Products.1718_NOR.NOR_P24b_Actual_HN_KS4_Deducted\r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 1 Then \r\n   \r\n   Result = NOR_P08_KS4\r\n\r\nElse \r\n\r\n    Result = NOR_P08_KS4 - NOR_P24b_Actual_HN_KS4_Deducted\r\n\r\nEnd If     \r\n\r\n   \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P24b_Actual_HN_KS4_Deducted","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim TotalPlacesAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17]\r\n    Dim APT As Boolean\r\n    APT = IIf(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17, false, true)    \r\n    Dim NOR_Inp_Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_KS4 \r\n    Dim Pre16HNData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim Pre16APData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    Dim TotalPlacesHNData As Double = Pre16HNData + Pre16APData\r\n    Dim NOR_P08_KS4 As Double = products.1718_NOR.NOR_P08_KS4\r\n    Dim NOR_P11_APT_HN_KS4 As Double = Products.1718_NOR.NOR_P11_APT_HN_KS4    \r\n    Dim NOR_P17_HND_HNP_AP_KS4 As Double= Products.1718_NOR.NOR_P17_HND_HNP_AP_KS4 \r\n    Dim NOR_P14_HND_HNP_HN_KS4 As Double =  Products.1718_NOR.NOR_P14_HND_HNP_HN_KS4  \r\n    Dim HND_HN_KS4 As Double = [Products.1718_NOR.NOR_P14_HND_HNP_HN_KS4] + [Products.1718_NOR.NOR_P17_HND_HNP_AP_KS4]  \r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim HN_to_Deduct As Double\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    If (APT = True Or TotalPlacesAPT = 0) And TotalPlacesHNData > 0 Then\r\n        HN_to_deduct = 0\r\n    ElseIf TotalPlacesAPT > TotalPlacesHNData Then\r\n     HN_to_deduct = NOR_P14_HND_HNP_HN_KS4 \r\n    Else \r\n        HN_to_deduct = NOR_P11_APT_HN_KS4\r\n    End If     \r\nElse Exclude(rid)\r\nEnd If  \r\n    \r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    Print(NOR_P08_KS4, \"NOR_P08_KS4\", rid)\r\n    Print(NOR_P11_APT_HN_KS4, \"NOR_P11_APT_HN_KS4\", rid)\r\n    Print(NOR_P17_HND_HNP_AP_KS4, \"NOR_P17_HND_HNP_AP_KS4\", rid)\r\n    Print(NOR_P14_HND_HNP_HN_KS4, \"NOR_P14_HND_HNP_HN_KS4\", rid)\r\n    Print(HND_HN_KS4, \"HND_HN_KS4\", rid)\r\n    Print(HN_to_deduct, \"HN_to_deduct\", rid)\r\n    Print(APT, \"APT\", rid)\r\n    \r\n If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 1 Then \r\n       Result = 0\r\n    Else \r\n       Result = HN_to_deduct \r\n    End If\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P25_Total_NOR_SEC_SBS","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim P23_Total_NOR_KS3_SBS As Double = Products.1718_NOR.NOR_P23_Total_NOR_KS3_SBS\r\n    Dim P24_Total_NOR_KS4_SBS As Double = Products.1718_NOR.NOR_P24_Total_NOR_KS4_SBS\r\n    \r\n    Print (P23_Total_NOR_KS3_SBS, \"P23_Total_NOR_KS3_SBS\", rid)\r\n    Print (P24_Total_NOR_KS4_SBS, \"P24_Total_NOR_KS4_SBS\", rid)      \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    Result = P23_Total_NOR_KS3_SBS + P24_Total_NOR_KS4_SBS\r\n    \r\n  Else Exclude(rid)\r\nEnd If  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P25b_Actual_HN_Sec_deducted","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim P23b_Actual_HN_KS3_Deduct As Double = Products.1718_NOR.NOR_P23b_Actual_HN_KS3_Deducted\r\n    Dim P24b_Actual_HN_KS4_Deduct As Double = Products.1718_NOR.NOR_P24b_Actual_HN_KS4_deducted\r\n    \r\n    Print(P23b_Actual_HN_KS3_Deduct, \"P23b_Actual_HN_KS3_Deduct\", rid) \r\n    Print(P24b_Actual_HN_KS4_Deduct, \"P24b_Actual_HN_KS4_Deduct\", rid) \r\n                         \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then     \r\n   Result = P23b_Actual_HN_KS3_Deduct + P24b_Actual_HN_KS4_Deduct\r\n  \r\nElse Exclude(rid)\r\n   \r\nEnd If \r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P26_Total_NOR_SBS","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim P22_Total_NOR_Pri_SBS As Double = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P25_Total_NOR_Sec_SBS As Double = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P26b_Total_Actual_HN_Deducted As Double = Products.1718_NOR.NOR_P26b_Total_Actual_HN_deducted\r\n    \r\n    Print(P22_Total_NOR_Pri_SBS, \"P22_Total_NOR_Pri_SBS\", rid)\r\n    Print(P25_Total_NOR_Sec_SBS, \"P25_Total_NOR_Sec_SBS\", rid)      \r\n                                                                                       \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then     \r\n    Result = P22_Total_NOR_Pri_SBS + P25_Total_NOR_Sec_SBS\r\n \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    Result = P22_Total_NOR_Pri_SBS + P25_Total_NOR_Sec_SBS - P26b_Total_Actual_HN_Deducted \r\n\r\nElse Exclude(rid)\r\nEnd If \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P26b_Total_Actual_HN_deducted","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim P22b_Actual_HN_Pri_Deduct As Double = Products.1718_NOR.NOR_P22b_Actual_HN_Pri_deducted\r\n    Dim P23b_Actual_HN_KS3_Deduct As Double = Products.1718_NOR.NOR_P23b_Actual_HN_KS3_deducted\r\n    Dim P24b_Actual_HN_KS4_Deduct As Double = Products.1718_NOR.NOR_P24b_Actual_HN_KS4_deducted\r\n    Dim APT_Pri As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_primary_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    Dim APT_KS3 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS3_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    Dim APT_KS4 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS4_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    \r\n    Print(P22b_Actual_HN_Pri_Deduct, \"P22b_Actual_HN_Pri_Deduct\", rid)\r\n    Print(P23b_Actual_HN_KS3_Deduct, \"P23b_Actual_HN_KS3_Deduct\", rid) \r\n    Print(P24b_Actual_HN_KS4_Deduct, \"P24b_Actual_HN_KS4_Deduct\", rid) \r\n    \r\n    \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then     \r\n\r\n    Result = P22b_Actual_HN_Pri_Deduct +  P23b_Actual_HN_KS3_Deduct + P24b_Actual_HN_KS4_Deduct\r\n\r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n\r\n    Result = APT_Pri + APT_KS3 + APT_KS4\r\n\r\nElse Exclude(rid)\r\nEnd If \r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P22_Total_NOR_PRI_SBS","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    \r\n    Dim NOR_P02_Pri As Decimal = Products.1718_NOR.NOR_P02_PRI\r\n    Dim NOR_P01_RU As Decimal = Products.1718_NOR.NOR_P01_RU\r\n    Dim NOR_P22b_Actual_HN_Pri_Deducted As Decimal = Products.1718_NOR.NOR_P22b_Actual_HN_Pri_Deducted\r\n    Dim F900_FundingBasis As Decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n       \r\n  \r\n    Print(NOR_P01_RU, \"NOR P01 RU\", rid)  \r\n    Print(NOR_P02_Pri, \"NOR P02 Pri\", rid)\r\n    Print(NOR_P22b_Actual_HN_Pri_Deducted, \"NOR P02 Pri\", rid)\r\n     \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 1 Then \r\n   Result = NOR_P02_Pri + NOR_P01_RU\r\nElse \r\n   Result = NOR_P02_Pri + NOR_P01_RU - NOR_P22b_Actual_HN_Pri_Deducted \r\nEnd If    \r\n    \r\n         \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P22b_Actual_HN_Pri_Deducted","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n       \r\n      \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim TotalPlacesAPT As Double =[Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17]\r\n    Dim APT As Boolean\r\n    APT = IIf([Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Total_number_of_High_Needs_places_in_2016/17], false, true)    \r\n    Dim NOR_Inp_Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.NOR_Primary \r\n    Dim Pre16HNData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_HNs_places]\r\n    Dim Pre16APData As Double = [Datasets.Academy_Allocations.AY_2017/18.Number_Counts.High_Needs_Places.Total_pre-16_AP_places]\r\n    Dim TotalPlacesHNData As Double = Pre16HNData + Pre16APData\r\n    Dim NOR_P02_Pri As Double = Products.1718_NOR.NOR_P02_PRI\r\n    Dim NOR_P01_RU As Double = Products.1718_NOR.NOR_P01_RU\r\n    Dim NOR_P09_APT_HN_Pri As Double = Products.1718_NOR.NOR_P09_APT_HN_PRI    \r\n    Dim NOR_P15_HND_HNP_AP_Pri As Double = Products.1718_NOR.NOR_P15_HND_HNP_AP_PRI \r\n    Dim NOR_P12_HND_HNP_HN_Pri As Double = Products.1718_NOR.NOR_P12_HND_HNP_HN_PRI \r\n    Dim HND_HN_Pri As Double = NOR_P12_HND_HNP_HN_Pri + NOR_P15_HND_HNP_AP_Pri     \r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim HN_to_Deduct As Double\r\n        \r\n If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then\r\n   If (APT = True Or TotalPlacesAPT = 0) And TotalPlacesHNData > 0 Then\r\n     HN_to_deduct = 0\r\n   Else If TotalPlacesAPT > TotalPlacesHNData Then\r\n     HN_to_deduct = HND_HN_Pri    '(NOR_P12_HND_HNP_HN_Pri + NOR_P15_HND_HNP_AP_Pri)\r\n   Else \r\n     HN_to_deduct = NOR_P09_APT_HN_Pri\r\n   End If     \r\nElse Exclude(rid)\r\nEnd If    \r\n    \r\n  \r\n    Print(TotalPlacesAPT, \"Total Places APT\",rid)\r\n    Print(TotalPlacesHNData, \"Total Places HN Data\",rid)\r\n    Print(NOR_P09_APT_HN_Pri, \"NOR_P09_APT HN Pri\", rid)\r\n    Print(NOR_P15_HND_HNP_AP_Pri, \"NOR_P15_HND_HNP_AP_Pri\", rid)\r\n    Print(NOR_P12_HND_HNP_HN_Pri, \"NOR_P12_HND_HNP_HN_Pri\", rid)\r\n    Print(HND_HN_Pri, \"HND_HN_Pri\", rid)\r\n    Print(HN_to_deduct, \"HN_to_deduct\", rid)\r\n    Print(APT, \"APT\", rid)\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)    \r\n    \r\n  If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 1 Then \r\n       Result = 0\r\n  Else \r\n       Result = HN_to_deduct \r\n End If    \r\n\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"b_NOR for SBS","DecimalPlaces":0},{"Name":"NOR_P27a_Total_NOR_MFG","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim NOR_P02_PRI As Decimal = Products.1718_NOR.NOR_P02_PRI\r\n    Dim NOR_P06_SEC As Decimal = Products.1718_NOR.NOR_P06_SEC    \r\n      \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then     \r\n    Result =  NOR_P02_PRI + NOR_P06_SEC\r\n     \r\nElse Exclude(rid)\r\nEnd If   \r\n    \r\nReturn result\r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"c_NOR for MFG","DecimalPlaces":0},{"Name":"NOR_P27b_Total_HN_MFG","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P22b_Actual_HN_Pri_deduct As Double = Products.1718_NOR.NOR_P22b_Actual_HN_Pri_deducted\r\n    Dim P23b_Actual_HN_KS3_deduct As Double = Products.1718_NOR.NOR_P23b_Actual_HN_KS3_deducted\r\n    Dim P24b_Actual_HN_KS4_deduct As Double = Products.1718_NOR.NOR_P24b_Actual_HN_KS4_deducted\r\n    Dim APT_Pri As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_primary_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    Dim APT_KS3 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS3_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17    \r\n    Dim APT_KS4 As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Number_of_KS4_pupils_on_roll_at_the_school_in_High_Needs_places_in_2016/17\r\n    \r\n    Print(P22b_Actual_HN_Pri_deduct, \"P22b_Actual_HN_Pri_deduct\", rid)\r\n    Print(P23b_Actual_HN_KS3_deduct, \"P23b_Actual_HN_KS3_deduct\", rid)\r\n    Print(P24b_Actual_HN_KS4_deduct, \"P24b_Actual_HN_KS4_deduct\", rid)\r\n    \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then   \r\n    Result = P22b_Actual_HN_Pri_deduct + P23b_Actual_HN_KS3_deduct + P24b_Actual_HN_KS4_deduct\r\n    \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    Result = APT_Pri + APT_KS3 + APT_KS4\r\n\r\nElse Exclude(rid)\r\nEnd If\r\n    \r\n         \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"c_NOR for MFG","DecimalPlaces":0},{"Name":"NOR_P27c_total_NOR_MFG_forPupilMatrix","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n   \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies   \r\n    Dim P22_Total_NOR_Pri_SBS As Decimal = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P25_Total_NOR_Sec_SBS As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim NOR_P01_RU As Decimal = Products.1718_NOR.NOR_P01_RU\r\n    Dim NOR_P26b_Total_Actual_HN_Deducted As Decimal = Products.1718_NOR.NOR_P26b_Total_Actual_HN_deducted\r\n   \r\n    \r\n    Print(P22_Total_NOR_Pri_SBS, \"P22_Total_NOR_Pri_SBS\", rid)\r\n    Print(P25_Total_NOR_Sec_SBS, \"P25_Total_NOR_Sec_SBS\", rid)\r\n    Print(NOR_P01_RU, \"NOR_P01_RU\", rid)\r\n    \r\n              \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then     \r\n    Result = P22_Total_NOR_Pri_SBS - NOR_P01_RU + P25_Total_NOR_Sec_SBS\r\n\r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then \r\n    Result = P22_Total_NOR_Pri_SBS - NOR_P01_RU + P25_Total_NOR_Sec_SBS - NOR_P26b_Total_Actual_HN_Deducted \r\n\r\nElse Exclude(rid)\r\nEnd If \r\n\r\nReturn Result\r\nEnd Function ","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"c_NOR for MFG","DecimalPlaces":0},{"Name":"NOR_P28_Total_NOR_Mainstream_ESG","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P05_Nur As Double = Products.1718_NOR.NOR_P05_NUR              \r\n    Dim NOR_P02_Pri As Double = Products.1718_NOR.NOR_P02_PRI    \r\n    Dim NOR_P06_Sec As Double = Products.1718_NOR.NOR_P06_SEC\r\n    Dim NOR_P21_P16 As Double = Products.1718_NOR.NOR_P21_P16\r\n    Dim NOR_P01_RU As Double = Products.1718_NOR.NOR_P01_RU\r\n    Dim NOR_P18_HND_HN_Pre16 As Double = Products.1718_NOR.NOR_P18_HND_HN_Pre16\r\n    Dim NOR_P19_HND_AP_Pre16 As Double = Products.1718_NOR.NOR_P19_HND_AP_Pre16\r\n    Dim NOR_P20_HND_Hosp_Plc As Double = Products.1718_NOR.NOR_P20_HND_Hosp_Pl\r\n\r\n\r\n  'ESG does Not exist In 1718, so these have been Set To zero\r\n\r\n\r\n'if currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 Then    \r\n '  result = NOR_P05_Nur + NOR_P02_Pri + NOR_P06_Sec + NOR_P21_P16\r\n   \r\n   \r\n' Else If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then  \r\n '  result = NOR_P05_Nur + NOR_P02_Pri - NOR_P01_RU + NOR_P06_Sec + NOR_P21_P16 + NOR_P18_HND_HN_Pre16 + NOR_P19_HND_AP_Pre16 + NOR_P20_HND_Hosp_Plc\r\n 'Else Exclude(rid)\r\n'End If\r\n    \r\n    \r\n '   Print(NOR_P05_Nur, \"NOR_P05_Nur\", rid)\r\n '   Print(NOR_P02_Pri, \"NOR_P02_Pri\", rid)\r\n '   Print(NOR_P06_Sec, \"NOR_P06_Sec\", rid)\r\n '   Print(NOR_P21_P16, \"NOR_P21_P16\", rid)\r\n '   Print(NOR_P01_RU, \"NOR_P01_RU\", rid)\r\n    result=0  \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_NOR","FolderName":"d_NOR for ESG","DecimalPlaces":0},{"Name":"NOR_P29_Total_NOR_HN Places_ESG","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P18_HND_HN_Pre16 = Products.1718_NOR.NOR_P18_HND_HN_Pre16\r\n \r\n 'ESG does Not exist In 1718 so this has been Set To zero\r\n\r\n'If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n '  Result = NOR_P18_HND_HN_Pre16\r\n \r\n 'Else Exclude(rid)\r\n'End If\r\n    result=0\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_NOR","FolderName":"d_NOR for ESG","DecimalPlaces":0},{"Name":"NOR_P30_Total_NOR_AP Places_ESG","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P19_HND_AP_Pre16 = Products.1718_NOR.NOR_P19_HND_AP_Pre16\r\n \r\n 'ESG does Not exist In 1718 so this has been Set To zero\r\n\r\n'If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n '   Result = NOR_P19_HND_AP_Pre16\r\n    \r\n 'Else Exclude(rid)\r\n'End If\r\n    result=0\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_NOR","FolderName":"d_NOR for ESG","DecimalPlaces":0},{"Name":"NOR_P31_Total_NOR_Hospital Places_ESG","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P20_HND_Hosp_Pl = Products.1718_NOR.NOR_P20_HND_Hosp_Pl\r\n    \r\n    'ESG does Not exist In 1718 so this has been Set To zero\r\n    \r\n'If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n '   Result = NOR_P20_HND_Hosp_Pl\r\n\r\n'Else Exclude(rid)\r\n'End If \r\n    result=0\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_NOR","FolderName":"d_NOR for ESG","DecimalPlaces":0},{"Name":"NOR_P33_1617_Base_NOR","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P26 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P26_Total_NOR_SBS\r\n    Dim Scenario_Report_P01 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P01_NOR_RU \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P26 - Scenario_Report_P01\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P34_1617_Base_RU","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P01 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P01_NOR_RU \r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P01\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P36_1617_pre16_HN","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P18 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P18_NOR_HNP_HN_Pre16\r\n\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P18\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P37_1617_pre16_AP","Script":"  Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P19 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P19_NOR_HNP_AP_Pre16\r\n\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P19\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P38_1617_HN_Hosp_Pl","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P20 As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P20_NOR_HNP_Hosp_Pl\r\n\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P20\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P39_1617_MFG_NOR","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P35 As Decimal = Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P35_1617AdjNOR\r\n    Dim Scenario_Report_P60 As Decimal = Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P60_IY1617AdjNOR\r\n    Dim Scenario_Report_P34 As Decimal = Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P34_1617EFAPosAdjNOR\r\n    Dim Scenario_Report_P33 As Decimal = Persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P33_1617EFANegAdjNOR\r\n\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    Result =  (Scenario_Report_P35 + Scenario_Report_P60) - (Scenario_Report_P34 - Scenario_Report_P33)\r\n \r\nElse Exclude(rid)\r\nEnd If\r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P40_1617_Post16_NOR","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P03 As Double = Persisted.Report_AY1617_Acad_Post16:Post16_AY201617_Report.P03_Learners\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P03\r\n    \r\n  Else Exclude(rid)  \r\nEnd If \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P41_1617_Post16_HN","Script":"  Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Scenario_Report_P04 As Double = Persisted.Report_AY1617_Acad_Post16:Post16_AY201617_Report.P04_HNPlaces\r\n    \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    result =  Scenario_Report_P04\r\n    \r\n  Else Exclude(rid)  \r\nEnd If \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"f_NOR 1617 Baseline","DecimalPlaces":0},{"Name":"NOR_P51_Total_NOR_Mainstream","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P02 As Decimal = Products.1718_NOR.NOR_P02_PRI\r\n    Dim NOR_P05 As Decimal = Products.1718_NOR.NOR_P05_NUR\r\n    Dim NOR_P06 As Decimal = Products.1718_NOR.NOR_P06_SEC\r\n    Dim NOR_P21 As Decimal = Products.1718_NOR.NOR_P21_P16\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 \r\n    \r\n        result = NOR_P02 + NOR_P05 + NOR_P06 + NOR_P21\r\n    \r\n    ElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n        result =  NOR_P02 + NOR_P05 + NOR_P06 + NOR_P21\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n      \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"h_NOR for RPA","DecimalPlaces":0},{"Name":"NOR_P52_Total_NOR_HN_Places","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P18 As Decimal = Products.1718_NOR.NOR_P18_HND_HN_Pre16\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P18\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n       \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"h_NOR for RPA","DecimalPlaces":0},{"Name":"NOR_P53_Total_NOR_AP_Places","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P19 As Decimal = Products.1718_NOR.NOR_P19_HND_AP_Pre16\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P19\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n       \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"h_NOR for RPA","DecimalPlaces":0},{"Name":"NOR_P54_Total_NOR_Hospital_Places","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P20 As Decimal = Products.1718_NOR.NOR_P20_HND_Hosp_Pl\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P20\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n      \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"h_NOR for RPA","DecimalPlaces":0},{"Name":"NOR_P32_Total_NOR_ESGProt","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P01_RU As Double = Products.1718_NOR.NOR_P01_RU                    \r\n    Dim P22_Total_NOR_Pri_SBS As Double = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS   \r\n    Dim P25_Total_NOR_Sec_SBS As Double = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS    \r\n    Dim NOR_P21_P16 As Double = Products.1718_NOR.NOR_P21_P16\r\n    Dim P26b_Total_Actual_HN_Deducted As Double = Products.1718_NOR.NOR_P26b_Total_Actual_HN_deducted       \r\n                  \r\n    Print(NOR_P01_RU, \"NOR_P01_RU\", rid)\r\n    Print(P22_Total_NOR_Pri_SBS, \"P22_Total_NOR_Pri_SBS\", rid)\r\n    Print(P25_Total_NOR_Sec_SBS, \"P25_Total_NOR_Sec_SBS\", rid)\r\n    Print(NOR_P21_P16, \"NOR_P21_P16\", rid)\r\n    \r\n    \r\nIf currentscenario.periodid = 2017181 Then \r\n   If F100_AllAcademies = 17181 Then    \r\n   Result = P22_Total_NOR_Pri_SBS + P25_Total_NOR_Sec_SBS + NOR_P21_P16\r\n   \r\n   ElseIf (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n   Result = P22_Total_NOR_Pri_SBS + P25_Total_NOR_Sec_SBS + NOR_P21_P16 - P26b_Total_Actual_HN_Deducted\r\n   \r\n   End If \r\n\r\nElse Exclude(rid)  \r\n   \r\nEnd If\r\n  \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"e_NOR for ESG Protection","DecimalPlaces":0},{"Name":"NOR_P32b_TOTAL_ESGProt_incHN","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_P01_RU As Double = Products.1718_NOR.NOR_P01_RU\r\n    Dim NOR_P02_Pri As Double = Products.1718_NOR.NOR_P02_PRI\r\n    Dim NOR_P06_Sec As Double = Products.1718_NOR.NOR_P06_SEC\r\n    Dim NOR_P21_P16 As Double = Products.1718_NOR.NOR_P21_P16 \r\n    Dim NOR_P18_HND_HN_Pre16 As Double = Products.1718_NOR.NOR_P18_HND_HN_Pre16\r\n    Dim NOR_P20_HND_Hosp_Pl As Double = Products.1718_NOR.NOR_P20_HND_Hosp_Pl\r\n    Dim NOR_P19_HND_AP_Pre16 As Double = Products.1718_NOR.NOR_P19_HND_AP_Pre16\r\n    Dim Tot_Places As Double = NOR_P18_HND_HN_Pre16 + NOR_P20_HND_Hosp_Pl + NOR_P19_HND_AP_Pre16   \r\n    Dim F900_FundingBasis As Double = Products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    \r\n    Print(Tot_Places, \"Tot_Places\", rid)\r\n    Print(NOR_P18_HND_HN_Pre16, \"NOR_P18_HND_HN_Pre16\", rid)\r\n    Print(NOR_P19_HND_AP_Pre16, \"NOR_P19_HND_AP_Pre16\", rid)\r\n    Print(NOR_P20_HND_Hosp_Pl, \"NOR_P20_HND_Hosp_Pl\",rid)\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n    \r\n    \r\nIf currentscenario.periodid = 2017181 And F100_AllAcademies = 17181 And (F900_FundingBasis = 1 Or F900_FundingBasis = 2) Then     \r\n   result = NOR_P01_RU + NOR_P02_Pri + NOR_P06_Sec + NOR_P21_P16\r\n   \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And (F900_FundingBasis = 1 Or F900_FundingBasis = 2) Then\r\n   result = NOR_P02_Pri + NOR_P06_Sec + NOR_P21_P16\r\n   \r\nElseIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And F900_FundingBasis = 3 Then \r\n   result = NOR_P01_RU + NOR_P02_Pri + NOR_P06_Sec + NOR_P21_P16 + NOR_P18_HND_HN_Pre16 + NOR_P19_HND_AP_Pre16 + NOR_P20_HND_Hosp_Pl\r\n   \r\n Else Exclude(rid)\r\nEnd If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"e_NOR for ESG Protection","DecimalPlaces":0},{"Name":"NOR_P35_1617_BaseNOR_ESGProt","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Date_Opened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim NOR_1617_Scenario_Report_P32_Total_NOR_ALP As Double = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P32_Total_NOR_ALP\r\n    \r\n    Print(Date_Opened, \"Date Opened\", rid)\r\n    \r\n  If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n   result = NOR_1617_Scenario_Report_P32_Total_NOR_ALP\r\n \r\n Else Exclude(rid) \r\nEnd If\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"e_NOR for ESG Protection","DecimalPlaces":0},{"Name":"NOR_P35b_1617_BaseNOR_ESGProtincHN","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Date_Opened As Date = Datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim NOR_1617_Scenario_Report_P32b_Total_NOR_ALPincHN As Double = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P32b_Total_NOR_ALP_incHN\r\n    \r\n    Print(Date_Opened, \"Date Opened\", rid)\r\n    \r\n  If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n   result = NOR_1617_Scenario_Report_P32b_Total_NOR_ALPincHN\r\n \r\n Else Exclude(rid) \r\nEnd If\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"e_NOR for ESG Protection","DecimalPlaces":0},{"Name":"NOR_P43_PRI","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P22 As Double = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim F100_AllAcademies As Double = [Products.1718_Global_Variables.F100_AllAcademies]\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P22\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"NOR_P46_SEC","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P25 As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P25\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n     \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"NOR_P47_KS3","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P23 As Decimal = Products.1718_NOR.NOR_P23_Total_NOR_KS3_SBS\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P23\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n     \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"NOR_P48_KS4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P24 As Decimal = Products.1718_NOR.NOR_P24_Total_NOR_KS4_SBS\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P24\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n     \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"NOR_P49_Y1toY4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P03 As Decimal = Products.1718_NOR.NOR_P03_Y1Y4\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P03\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n     \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"NOR_P50_Y5toY6","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim NOR_P04 As Decimal = Products.1718_NOR.NOR_P04_Y5Y6\r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) then    \r\n    \r\n    result =  NOR_P04\r\n \r\n    Else Exclude(rid)\r\n\r\nEnd If\r\n     \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_NOR","FolderName":"g_NOR for FS Protection","DecimalPlaces":0},{"Name":"F100_AllAcademies","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n        \r\n    Dim Date_Opened as date = datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim Budget_ID1718 as String = DataSets.Administration.Providers.Funding_Streams.Budget(2017181)\r\n    Dim ProviderType as string = DataSets.Administration.Providers.Provider_Information.Provider_Type\r\n    Dim Funding_Basis1718 as String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim PrevMain As Boolean = Datasets.Administration.Providers.Academy_Information.Academy_Previously_Maintained\r\n    Dim ConvertDate As Date = Datasets.Administration.Providers.Provider_Information.Convert_Date  \r\n    Dim Budget_ID1617 as String = DataSets.Administration.Providers.Funding_Streams.Budget(2016171)\r\n    Dim Funding_Basis1617 as String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2016171)\r\n\r\n    print(Date_Opened,\"DateOpen\",rid)\r\n    Print(Budget_ID1718,\"Budget_ID1718\",rid)\r\n    Print(ProviderType,\"ProvType\",rid)\r\n    Print(Funding_Basis1718, \"Funding_Basis1718\",rid)\r\n    Print(SubType, \"SubType\", rid)\r\n    Print(PrevMain, \"PrevMain\", rid)\r\n    Print(ConvertDate, \"ConvertDate\", rid)\r\n    Print(Budget_ID1617,\"Budget_ID1617\",rid)\r\n    Print(Funding_Basis1617, \"Funding_Basis1617\",rid)\r\n    \r\n    \r\n    If subtype = \"14CTC\" Then \r\n    Exclude(RID) \r\n    ELSE If currentscenario.periodid = 2017181 Then \r\n    If String.IsNullOrEmpty(budget_ID1718) Or String.IsNullOrEmpty(Funding_Basis1718) Then \r\n    Exclude(RID)   \r\n    Else If (Budget_ID1718.Contains (\"YPLRE\") Or Budget_ID1718.Contains (\"ZCONV\")) Or ((Budget_ID1718.Contains (\"YPLRC\") Or Budget_ID1718.Contains (\"YPLRA\") Or Budget_ID1718.Contains(\"YPLRD\")) And PrevMain = True) Then \r\n    If Date_Opened > \"01 January 0001\" And Date_Opened < \"01 April 2017\" Then \r\n    result = 17181 \r\n    Else If Date_Opened  >= \"01 April 2017\"  And Date_Opened < \"01 September 2017\" Then \r\n    result = 17182 \r\n    Else result = 17183 \r\n    End If \r\n    End If \r\n    End If \r\n  \r\n    \r\n If currentscenario.periodid = 2016171 Then \r\n If String.IsNullOrEmpty(budget_ID1617) Or String.IsNullOrEmpty(Funding_Basis1617) Then \r\n Exclude(RID) \r\n Else If (Budget_ID1617.Contains (\"YPLRE\") And Date_Opened >= \"01 April 2017\" And Date_Opened < \"01 September 2017\") Or (Budget_ID1617.Contains (\"ZCONV\") And convertdate >= \"01 April 2017\" And convertdate < \"01 September 2017\") Or ((Budget_ID1617.Contains (\"YPLRC\") Or Budget_ID1617.Contains (\"YPLRA\") Or Budget_ID1617.Contains(\"YPLRD\") And (Date_Opened >= \"01 April 2017\" And Date_Opened < \"01 September 2017\") Or (convertdate >= \"01 April 2017\" And convertdate < \"01 September 2017\")) And PrevMain = True) Then \r\n result = 16171 \r\n Else Exclude(RID) \r\n End If \r\n End If \r\n\r\n \r\n    \r\n    Return result\r\nEnd Function \r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F200_SBS_Academies","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\nDim result As Decimal = 0 'change to As String if text product\r\n   \r\nDim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\nDim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\nPrint(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\nPrint(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\nIf (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And ( FundingBasis = \"Census\" Or FundingBasis = \"Estimate\" ) Then       \r\nResult = 1\r\nElse\r\nExclude(rid)\r\nEnd If\r\n    \r\nReturn result\r\nEnd Function\r\n\r\n \r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F300_ESG_Academies_All","Script":"Public Function GetProductResult(rid As String) As Double\r\nDim result = 0\r\n\r\nDim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\nDim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\nDim NOR_SBS As Double = Products.1718_NOR.NOR_P26_Total_NOR_SBS\r\nDim PrevMaintained As String = datasets.Administration.Providers.Academy_Information.Academy_Previously_Maintained\r\n    \r\nPrint(F100_AllAcademies, F100_AllAcademies,rid)\r\nPrint(FundingBasis, FundingBasis,rid)\r\nPrint(NOR_SBS, NOR_SBS,rid)\r\nPrint(PrevMaintained, PrevMaintained,rid)\r\n    \r\nIf string.IsNullOrEmpty(PrevMaintained) And NOR_SBS = 0 And (FundingBasis = \"Census\" Or FundingBasis = \"Estimate\") Then\r\nResult = 0\r\n   \r\nIf currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\nResult = 1\r\nElse\r\nExclude(rid)\r\nEnd If\r\n    \r\nEnd If\r\n        \r\nReturn result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F301_ESG_Academies_Mainstream","Script":"Public Function GetProductResult(rid As String) As Double\r\nDim result = 0\r\n\r\nDim F300_ESG_Academies_All As Decimal = Products.1718_Global_Variables.F300_ESG_Academies_All\r\nDim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\nPrint(F300_ESG_Academies_All, F300_ESG_Academies_All,rid)\r\nPrint(FundingBasis, FundingBasis,rid)\r\n  \r\nIf F300_ESG_Academies_All = 1 And (FundingBasis = \"Census\" Or FundingBasis = \"Estimate\") Then\r\nResult = 1 \r\nElse \r\nExclude(rid)  \r\nEnd If  \r\n\r\n\r\nReturn result\r\nEnd Function\r\n\r\n  \r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F302_ESG_Academies_PlacesLed","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F300_ESG_AcademiesAll As Decimal = Products.1718_Global_Variables.F300_ESG_Academies_All\r\n     Dim Funding_Basis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n     Print(F300_ESG_AcademiesAll, \"F300_ESG_AcademiesAll\", rid)\r\n     Print(Funding_Basis, \"Funding_Basis\", rid)\r\n        \r\n        \r\n        'ESG does Not exist In 1718 so Set To zero\r\n    \r\n    'If F300_ESG_AcademiesAll = 1 And (Funding_Basis = \"Place\") Then\r\n    '    Result = 1\r\n    'Else\r\n    '    Exclude(rid)\r\n    'End if\r\n    \r\n    \r\n     result = 0\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F400_HN_Academies","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    If currentscenario.periodid = 2017181 And (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n    Result = 1\r\n    Else\r\n    Exclude(rid)\r\n    End if   \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F500_MFG_Academies","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n   \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(Funding_Basis, \"Funding_Basis\", rid)\r\n    \r\n    If (F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And (Funding_Basis = \"Census\" Or Funding_Basis = \"Estimate\") Then\r\n        Result = 1\r\n    Else\r\n        Exclude(rid)\r\n    End If\r\n    \r\n\r\nReturn result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F600_ESGProtection_Academies","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    \r\n    If(F100_AllAcademies = 17181 Or F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) Then\r\n        Result = 1\r\n    Else\r\n        Result = 0\r\n    End If  \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F601_ESGProtection_Post16onlyAP","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n   \r\n    Dim F600_ESGProtection_Academies As Decimal  = Products.1718_Global_Variables.F600_ESGProtection_Academies\r\n    Dim Subtype As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n    Dim BudgetID As String = DataSets.Administration.Providers.Funding_Streams.Budget(2017181)\r\n    \r\n    Print(F600_ESGProtection_Academies, \"F600_ESGProtection_Academies\", rid)\r\n    Print(Subtype, \"Subtype\",rid)\r\n    Print(BudgetID,\"BudgetID\",rid)\r\n    \r\n    If F600_ESGProtection_Academies = 1 Then\r\n        If Subtype = \"22AAP\" And BudgetID.Contains(\"YPLRD\") Then\r\n            Result = 1\r\n        Else\r\n            Result = 0\r\n        End if\r\n    Else\r\n        Exclude(rid)\r\n    End if\r\n     \r\n \r\nReturn result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F602_ESGProtection_Mainstream","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result As Decimal = 0\r\n    \r\n    Dim ESGProtectionAll As Decimal = Products.AY1718_Acad_GlobalVariables.F600_ESGProtection_Academies\r\n    Dim APPost16 As Decimal = Products.AY1718_Acad_GlobalVariables.F601_ESGProtection_APPost16\r\n    Dim FundingBasis As String =  DataSets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim PrevMaintained As String = Datasets.Administration.Providers.Academy_Information.Academy_Previously_Maintained\r\n    Dim NOR_SBS As Decimal = products.AY1718_Acad_NOR.P26_Total_NOR_SBS \r\n \r\n    \r\n    Print(ESGProtectionAll,\"ESGProtectionAll\",rid)\r\n    Print(APPost16,\"APPost16\",rid)\r\n    Print(FundingBasis,\"FundingBasis\",rid)   \r\n\r\n If  APPost16 = 1 Then\r\n      Result = 1\r\n      Else\r\n\r\nIf String.IsNullOrEmpty(PrevMaintained) And NOR_SBS = 0 Then \r\n        Result = 0 \r\nElse    \r\n    If ESGProtectionAll = 1 Then\r\n    \r\n        If APPost16 = 1 Or FundingBasis = \"Estimate\" Or FundingBasis = \"Census\" Then\r\n        Result = 1\r\n        Else\r\n        Result = 0\r\n        End If\r\n    \r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n End If   \r\n    \r\n           End If\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F603_ESGProtection_PlaceLed","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F600_ESGProtection_Academies As Decimal = Products.1718_Global_Variables.F600_ESGProtection_Academies\r\n    Dim Funding_Basis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(F600_ESGProtection_Academies,\"F600_ESGProtection_Academies\",rid)\r\n    Print(Funding_Basis, \"Funding_Basis\",rid)\r\n    \r\n    If F600_ESGProtection_Academies = 1 Then\r\n        If Funding_Basis = \"Place\" Then\r\n            Result = 1\r\n        Else\r\n            Result = 0\r\n        End If\r\n    \r\n    Else\r\n        Exclude(rid)\r\n    End if\r\n       \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F800_FSProtection_Academies","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As string = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SubType As String = Datasets.Administration.Providers.Provider_Information.Provider_Subtype\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(Funding_Basis, \"Funding_Basis\",rid)\r\n    Print(SubType, \"SubType\",rid)\r\n    \r\n    If F100_AllAcademies = 17183 And (Funding_Basis = \"Census\" Or Funding_Basis = \"Estimate\") And (SubType = \"12FSC\" Or SubType = \"13SSA\" Or SubType = \"15UTC\") Then\r\n        Result = 1\r\n    Else\r\n        Exclude(rid)\r\n    End if\r\n       \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"F900_FundingBasis","Script":"                   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n      \r\n    Dim Date_Opened as date = datasets.Administration.Providers.Provider_Information.Date_Opened\r\n    Dim Budget_ID as String = DataSets.Administration.Providers.Funding_Streams.Budget(2017181)\r\n    Dim ProviderType as string = DataSets.Administration.Providers.Provider_Information.Provider_Type\r\n    Dim Funding_Basis as String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n             \r\n    Print(Funding_Basis, \"ABCD Type\",rid)\r\n    \r\n    If Budget_ID isnot nothing then\r\n   \r\n    \r\n        If currentscenario.periodid = 2017181 and Funding_Basis = \"Census\" and (Budget_ID.Contains(\"YPLRE\") Or Budget_ID.Contains(\"ZCONV\")) Then\r\n            Result = 1 \r\n        ElseIf currentscenario.periodid = 2017181 and Funding_Basis = \"Estimate\" and (Budget_ID.Contains(\"YPLRE\") Or Budget_ID.Contains(\"ZCONV\")) Then\r\n            Result = 2  \r\n        ElseIf currentscenario.periodid = 2017181 and (Funding_Basis = \"Place\") and (Budget_ID.Contains(\"YPLRE\") Or Budget_ID.Contains(\"ZCONV\")) Then\r\n           Result = 3 \r\n        Else\r\n           Exclude(rid)                    \r\n        End If\r\n    Else \r\n        Exclude(rid)\r\n        \r\n    End If\r\n        \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n         \r\n    \r\n    \r\n    \r\n               \r\n\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"Post16Filter","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result As Decimal = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.AY1718_GlobalVariables.F100_AllAcademies \r\n    Dim BudgetID As String = DataSets.Administration.Providers.Funding_Streams.Budget(2017181)\r\n    Dim PrevMaintained As Boolean = DataSets.Administration.Providers.Academy_Information.Academy_New_Opener\r\n \r\n    \r\n    If String.IsNullOrEmpty(budgetID) Then\r\n    \r\n        Exclude(RID)    \r\n    \r\n    Else \r\n    \r\n        If AcademyFilter = 17183 And BudgetID.Contains (\"YPLRE\") then         \r\n        \r\n        result = 2\r\n        \r\n        Else\r\n           \r\n           If AcademyFilter = 17183 And BudgetID.Contains (\"ZCONV\") then         \r\n            \r\n            result = 1\r\n            \r\n            Else\r\n            \r\n                If AcademyFilter = 17183 And ((BudgetID.Contains (\"YPLRC\") Or BudgetID.Contains (\"YPLRA\") Or BudgetID.Contains(\"YPLRD\")) And PrevMaintained = True) then\r\n                \r\n                result = 3\r\n                \r\n                Else\r\n                \r\n                result = 0\r\n                \r\n                End If\r\n                \r\n            End If\r\n            \r\n        End If\r\n        \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Provider Criteria","DecimalPlaces":0},{"Name":"P001_ESG_MAIN_APP","Script":"        Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P010_ESGP_Main_Thresh1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 77.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P011_ESGP_Main_Thresh2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 87\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P012_ESGP_AP_Thresh1","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 288.75\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P013_ESGP_AP_Thresh2","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 326.25\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P014_ESGP_Special_Thresh1","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 327.25\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P015_ESGP_Special_Thresh2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 369.75\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P016_MathsTopUp_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 2500.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P017_MFG_Level","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -0.015\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P018_ESG_Main_APP_1617","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 77.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P019_ESGP_Main_Rate_Change","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -77\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P002_ESG_AP_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P020_ESGP_Special_Rate_Change","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -327.25\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P021_ESGP_AP_Rate_Change","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -288.75\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P022_RPA_Rate","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -20\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P023_ESG_HN_APP_1617","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product                                                                                                                                                                                                      Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 327.25\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P024_ESG_AP_APP_1617","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 288.75\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P025_YearDays_1718","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 365\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P026_YearDays_1617","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 365\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P027_DaysOpen","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n                                                                                                    \r\n      Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n      Dim DateOpened As Date = [datasets.Administration.Providers.Provider_Information.Date_Opened]\r\n      Dim ConvertDate As Date = [datasets.Administration.Providers.Provider_Information.Convert_Date]\r\n      Dim DateUsed As Date\r\n      Dim Days_Open As Decimal = 0\r\n      \r\n      If ConvertDate >= DateOpened Then\r\n                                   DateUsed = ConvertDate\r\n       Else\r\n                                   DateUsed = DateOpened\r\n      End If                                  \r\n                                   \r\n    \r\n     Print(DateOpened, \"Date Opened\", rid)\r\n     Print(ConvertDate, \"Convert Date\",rid)\r\n     Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n     Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n     \r\n     \r\n      If F100_AllAcademies > 0 then\r\n         \r\n             Days_Open = DateDiff(\"d\", DateUsed, \"1 September 2018\")\r\n              \r\n   \r\n            Print(Days_Open, \"Number of Days Open to end 1718\", rid) \r\n            Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n        \r\n        if Days_Open > 365 then\r\n\r\n            result = 365\r\n\r\n        else\r\n\r\n            result = Days_Open\r\n    \r\n        End if\r\n      \r\n        \r\n      else\r\n      exclude(rid)\r\n     End If \r\n \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P028_MonthsOpen","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result As Decimal = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim DateOpened As Date = [datasets.Administration.Providers.Provider_Information.Date_Opened]\r\n    Dim ConvertDate As Date = [datasets.Administration.Providers.Provider_Information.Convert_Date]\r\n    Dim DateUsed As Date \r\n    Dim Months_Open As Decimal = 0\r\n    \r\n    If ConvertDate >= DateOpened Then\r\n                                   DateUsed = ConvertDate\r\n                                Else\r\n                                   DateUsed = DateOpened\r\n   End If     \r\n\r\n    \r\n    Months_Open =  DateDiff(\"m\", DateUsed, \"1 September 2017\")\r\n    \r\n    If F100_AllAcademies > 0 then \r\n            If Months_Open < 12 then    \r\n            Result = Months_Open                'does this need To be /12 ie For an academy oepning October this would be 11/12ths?\r\n            Else\r\n            Result = 12\r\n            End If\r\n    Else        \r\n    Exclude(rid)\r\n    End If\r\n    \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Months_Open, \"Number of Months Open\", rid)\r\n    Print(ConvertDate, \"Convert Date\", rid)\r\n    Print(DateOpened, \"Date Opened\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P029_FSP_Level","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = -0.015\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P003_ESG_HN_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P004_Pre16_HN_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 10000.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P005_Pre16_AP_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 10000.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P006_Post16_HN_APP","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 6000.00\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"P007_ESGP_Cond1","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0.01\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P008_ESGP_Cond2","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0.02\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"P009_ESGP_Cond3","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Funding_Basis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(Funding_Basis,\"Funding_Basis\",rid)\r\n    \r\n        If F100_AllAcademies > 0 Then \r\n        Result = 0.03\r\n        Else \r\n        Exclude(rid)\r\n        End If\r\n      \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":6},{"Name":"POG_PPR_P03_FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 250\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_PPR_P05_Sec_FundingRate","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_PPR_P08_PriPlace_FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 250\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_PPR_P10_SecPlace_FundingRate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P19_SecEmptyCohort1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 31000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P13_PriEmptyCohort2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 27000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P14_PriEmptyCohort3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 40500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P15_PriEmptyCohort4","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 54000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P16_PriEmptyCohort5","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 67500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P17_PriEmptyCohort6","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 80500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P18_Pri_Max_Cap","Script":"               Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 283000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P12_PriEmptyCohort1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 13500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P20_SecEmptyCohort2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 62500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P21_SecEmptyCohort3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 93500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P22_SecEmptyCohort4","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 125000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P23_Sec_Max_Cap","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 312000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P24_AllThruEmptyCohort1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 27000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P25_AllThruEmptyCohort2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 40500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P26_AllThruEmptyCohort3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 54000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P27_AllThruEmptyCohort4","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 62500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P28_AllThruEmptyCohort5","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 93500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P29_AllThruEmptyCohorts6","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 125000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P30_AllThru_Max_Cap","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 402500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P31_1619FS_Year1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 108000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P32_1619FS_Year2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 27000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P33_UTC_Year1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 157500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P34_UTC_Year2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 94500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P35_UTC_Year3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 63000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P36_StudioSchool_Year1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 90000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P37_StudioSchool_Year2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 54000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P38_StudioSchool_Year3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 36000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P39_SpecialSchool_Year1","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 85000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P40_SpecialSchool_Year2","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 51000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"POG_LD_P41_SpecialSchool_Year3","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 34000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUG_P03_Class_Size","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 30\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUG_P05_Pri_SUGA_Min","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 25000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUG_P06_Pri_SUGA_Max","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 50000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGA_P08_Sec_Per_Pupil_Funding_Rate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 150\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGA_P08a_Per_Place_Funding_Rate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 250\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P12_Pri_MinCap","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 10000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P13_Pri_MaxCap","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 50000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P14_PerPercentRate","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 2500\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P15_CapacityPerCentMin","Script":"                Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 0.9\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P16_FundingPerCentMin","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 0.865\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P22_SecMinCap","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 10000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P23_SecMaxCapSmall","Script":"             Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 60000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P24_SecMaxCapLarge","Script":"                 Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 80000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P25_PerPercentRateSmall","Script":"               Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 3000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P26_PerPercentRateLarge","Script":"              Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 4000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P32_MaxCapSmall","Script":"                Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 250\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P33_MinCapLarge","Script":"              Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 1000\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P34_MedPupilRange","Script":"             Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 750\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P35_MaxCapDiff","Script":"            Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 20100\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"SUGB_P36_DiseconPerCentDiff","Script":"               Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcademyFilter As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    \r\n    Print(AcademyFilter,\"Filter\",rid)    \r\n    \r\n        If AcademyFilter > 0 Then\r\n        Result = 20\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_Global_Variables","FolderName":"Global Variables","DecimalPlaces":0},{"Name":"test","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim P01 As Decimal = Products.1718_MFG.P01_1617_SBS\r\nDim P03 As Decimal = Products.1718_MFG.P03_1617_FSProtection\r\nDim P04 As Decimal = Products.1718_MFG.P04_1617_MFG_Base_Funding\r\nDim P05 As Decimal = Products.1718_MFG.P05_1617_BaseExclusions\r\nDim P06 As Decimal = Products.1718_MFG.P06_1617_BaseTechAdj               \r\nDim P07 As Decimal = Products.1718_MFG.P07_AddLumpSum\r\nDim P08 As Decimal = Products.1718_MFG.P08_TotalLumpSum            \r\nDim P09 As Decimal = Products.1718_MFG.P09_1718_Sparsity\r\nDim P10 As Decimal = Products.1718_MFG.P10_PriorYr_NegAdj                                                        \r\nDim P11 As Decimal = Products.1718_MFG.P11_PriorYr_PosAdj\r\nDim P12 As Decimal = Products.1718_MFG.P12_MFG_Baseline                            \r\nDim P13a As Decimal = Products.1718_MFG.P13a_1617_NOR                                               \r\nDim P13b As Decimal = Products.1718_MFG.P13b_1617_NOR\r\nDim P14 As Decimal = Products.1718_MFG.P14_1617_HNPlaces                   \r\nDim P15 As Decimal = Products.1718_MFG.P15_PriorYr_NOR_NegAdj                                                              \r\nDim P16 As Decimal = Products.1718_MFG.P16_PriorYr_NOR_PosAdj\r\nDim P17a As Decimal = Products.1718_MFG.P17a_Adjusted_1617_NOR                                  \r\nDim P17b As Decimal = Products.1718_MFG.P17b_Adjusted_1617_NOR                                 \r\nDim P18a As Decimal = Products.1718_MFG.P18a_1617_MFGPerPupil                                               \r\nDim P18b As Decimal = Products.1718_MFG.P18b_1617_MFGPerPupil           \r\nDim P19a As Decimal = Products.1718_MFG.P19a_MFG_ProtectedPP\r\nDim P20 As Decimal = Products.1718_MFG.P20_1718_SBS\r\nDim P22 As Decimal = Products.1718_MFG.P22_1718_MFG_Excl\r\nDim P23 As Decimal = Products.1718_MFG.P23_1718_MFG_TechAdj\r\nDim P24 As Decimal = Products.1718_MFG.P24_1718_LumpSum_AddSum\r\nDim P25 As Decimal = Products.1718_MFG.P25_1718_Sparsity\r\nDim P26 As Decimal = Products.1718_MFG.P26_CurrentYr_EFA_NegAdj\r\nDim P27 As Decimal = Products.1718_MFG.P27_CurrentYr_EFA_PosAdj\r\nDim P28 As Decimal = Products.1718_MFG.P28_1718_Total_MFG\r\nDim P29 As Decimal = Products.1718_MFG.P29_1718_NOR\r\nDim P30 As Decimal = Products.1718_MFG.P30_1718_HN_Places                                   \r\nDim P31 As Decimal = Products.1718_MFG.P31_1718_EFA_NegAdj_NOR\r\nDim P32 As Decimal = Products.1718_MFG.P32_1718_EFA_PosAdj_NOR\r\nDim P33a As Decimal = Products.1718_MFG.P33a_1718_Adjusted_NOR\r\nDim P33b As Decimal = Products.1718_MFG.P33b_1718_Adjusted_NOR\r\nDim P34a As Decimal = Products.1718_MFG.P34a_1718_MFG_PPFunding\r\nDim P34b As Decimal = Products.1718_MFG.P34b_1718_MFG_PPFunding\r\nDim P35a As Decimal = Products.1718_MFG.P35a_GuaranteedFunding\r\nDim P36a As Decimal = Products.1718_MFG.P36a_MFG_Adj\r\nDim P40 As Decimal = Products.1718_MFG.P40_CapScale_YN\r\nDim P41 As Decimal = Products.1718_MFG.P41_GrowingSchool_YN\r\nDim P42 As Decimal = Products.1718_MFG.P42_Apply_Cap_Decision  \r\nDim P43 As Decimal = Products.1718_MFG.P43_CappingFactor\r\nDim P44 As Decimal = Products.1718_MFG.P44_ScaleFactor\r\nDim P45a As Decimal = Products.1718_MFG.P45a_PercentChangeUnitValue\r\nDim P45b As Decimal = Products.1718_MFG.P45b_PercentChangeUnitValue\r\nDim P46a As Decimal = Products.1718_MFG.P46a_Change_Exceeds_Cap\r\nDim P46b As Decimal = Products.1718_MFG.P46b_Change_Exceeds_Cap\r\nDim P47a As Decimal = Products.1718_MFG.P47a_Scale_Factor_Applied\r\nDim P47b As Decimal = Products.1718_MFG.P47b_Scale_Factor_Applied\r\nDim P48a As Decimal = Products.1718_MFG.P48a_AffordAdj\r\nDim P48b As Decimal = Products.1718_MFG.P48b_AffordAdj\r\nDim P49a As Decimal = Products.1718_MFG.P49a_ChangeBelowFloor\r\nDim P50a As Decimal = Products.1718_MFG.P50a_OverallNet_Adj\r\nDim P51a As Decimal = Products.1718_MFG.P51a_MFG_After_adj\r\nDim P52a As Decimal = Products.1718_MFG.P52a_MFG_After_adj_PP\r\nDim P53a As Decimal = Products.1718_MFG.P53a_PercentChange_PP\r\nDim P54a As Decimal = Products.1718_MFG.P54a_Final1718_SBS_MFG\r\nDim P55a As Decimal = Products.1718_MFG.P55a_NOR_fromAPT\r\nDim P55b As Decimal = Products.1718_MFG.P55b_NOR_fromAPT\r\nDim P56 As Decimal = Products.1718_MFG.P56_IYNOR\r\nDim P57 As Decimal = Products.1718_MFG.P57_IY1617HNPlaces\r\nDim P58 As Decimal = Products.1718_MFG.P58_IY1617EFANegAdjNOR\r\nDim P59 As Decimal = Products.1718_MFG.P59_IY1617EFAPosAdjNOR\r\nDim P60 As Decimal = Products.1718_MFG.P60_IY_1718_AdjNOR\r\nDim P61 As Decimal = Products.1718_MFG.P61_IY_NetAdj_fromAPT\r\nDim P62a As Decimal = Products.1718_MFG.P62a_IYOpeners_NetAdj\r\nDim P62b As Decimal = Products.1718_MFG.P62b_IYOpeners_NetAdj\r\nDim P63a As Decimal = Products.1718_MFG.P63a_IYOpeners_adj_SBS_Total\r\nDim P63b As Decimal = Products.1718_MFG.P63b_IYOpeners_adj_SBS_Total\r\nDim P64 As Decimal = Products.1718_MFG.P64_EFA_MFG_Adj\r\nDim P65a As Decimal = Products.1718_MFG.P65a_Total_Overall_NetAdj\r\nDim P70a As Decimal = Products.1718_MFG.P70a_FAP_Baseline\r\nDim P71a As Decimal = Products.1718_MFG.P71a_FAP_Baseline_NOR \r\nDim P72 As Decimal = Products.1718_MFG.P72_FAP_CurrentYr_SBS_Total\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"My Products","DecimalPlaces":0},{"Name":"P01_1617_SBS","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0            \r\n \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies  \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim SBS1617_Base_Link As Decimal = persisted.Report_AY1617_Acad_SBS:Totals_Report.P288_SBSFundingTotal\r\n    Dim MFG1617_Base_Link As Decimal = persisted.Report_AY1617_Acad_MFG:MFG_AY201617_Report.P65_TotalOverallNetAdj * 365 / persisted.Report_AY1617_Acad_SBS:Basic_Entitlement_Report.P001_1516DaysOpen\r\n        \r\n    Print(SBS1617_Base_Link, \"1617 SBS - Live\", rid)\r\n    Print(MFG1617_Base_Link, \"1617 MFG - Live\", rid)\r\n    Print(FundingBasis, \"Funding basis\", rid)\r\n    Print(AcType, \"Academy type\", rid)\r\n      \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n        Else               \r\n              \r\n            If AcType = 17181    Then\r\n    \r\n            result = SBS1617_Base_Link + MFG1617_Base_Link \r\n    \r\n            Else\r\n\r\n        Exclude(rid)\r\n       \r\n        End If\r\n    \r\n    End If \r\n\r\n    Return result\r\n    \r\nEnd Function \r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P03_1617_FSProtection","Script":" Public Function GetProductResult(rid As String) As Decimal\r\nDim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FreeSP_Link As Decimal = persisted.Report_AY1617_Acad_FreeSchoolProtection:AY1617_FSProtection.FSP_P59_TotalProtection_FY\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n                                                                                                                \r\n    Print(FreeSP_Link, \"Free school protection 1718\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n             \r\n        If FundingBasis = \"Place\" Then    \r\n    \r\n        exclude(rid) \r\n    \r\n        Else\r\n    \r\n            IF AcType = 17181 Then             \r\n             \r\n            result = FreeSP_Link \r\n            \r\n            Else\r\n            \r\n            Exclude(rid)  \r\n            \r\n            End If    \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P04_1617_MFG_Base_Funding","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n        'VARIABLES USED IN PRODUCT\r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AY1617SBS As Decimal = Products.1718_MFG.P01_1617_SBS\r\n    Dim AY1617FSProt As Decimal = Products.1718_MFG.P03_1617_FSProtection\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    'PRINT VARIABLES TO ALLOW CHECKING\r\n    Print(AY1617SBS, \"Total Live EFA Baseline (SBSandMFG)\", rid)\r\n    Print(AY1617FSProt, \"FS Protection\", rid)\r\n       \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid)                                                  \r\n    \r\n    Else\r\n    \r\n        IF AcType = 17181 Then\r\n         \r\n        result = AY1617SBS + AY1617FSProt \r\n          \r\n        Else\r\n    \r\n        Exclude(rid)\r\n     \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P05_1617_BaseExclusions","Script":"   Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Baseline_MFG_Excl_1 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Approved_MFG_Exemptions_1]\r\n    Dim Baseline_MFG_Excl_2 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Approved_MFG_Exemptions_2]\r\n    Dim Baseline_MFG_Excl_3 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Approved_MFG_Exemptions_3]\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    'PRINT VARIABLES TO ALLOW CHECKING\r\n    Print(Baseline_MFG_Excl_1, \"Baseline_MFG_Excl_1\", rid)\r\n    Print(Baseline_MFG_Excl_2, \"Baseline_MFG_Excl_2\", rid)\r\n    Print(Baseline_MFG_Excl_3, \"Baseline_MFG_Excl_3\", rid)\r\n          \r\n    If FundingBasis = \"Place\" Then\r\n                                    \r\n    exclude(rid) \r\n    \r\n    Else             \r\n    \r\n        IF AcType = 17181 Then\r\n    \r\n        result = Baseline_MFG_Excl_1 + Baseline_MFG_Excl_2 + Baseline_MFG_Excl_3 \r\n        \r\n        Else\r\n \r\n        Exclude(rid) \r\n    \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function \r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P06_1617_BaseTechAdj","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    'VARIABLES USED IN PRODUCT\r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Baseline_MFG_Tech_1 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Technical_adjustment_1]\r\n    Dim Baseline_MFG_Tech_2 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Technical_adjustment_2]\r\n    Dim Baseline_MFG_Tech_3 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.16-17_Technical_adjustment_3]\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    'PRINT VARIABLES TO ALLOW CHECKING\r\n    Print(Baseline_MFG_Tech_1, \"Baseline_MFG_Tech_1\", rid)\r\n    Print(Baseline_MFG_Tech_2, \"Baseline_MFG_Tech_2\", rid)\r\n    Print(Baseline_MFG_Tech_3, \"Baseline_MFG_Tech_3\", rid)           \r\n    \r\n    'CALCULATE \r\n    \r\n       \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        IF AcType = 17181 Then\r\n    \r\n        result =  Baseline_MFG_Tech_1 + Baseline_MFG_Tech_2 + Baseline_MFG_Tech_3\r\n    \r\n        Else\r\n    \r\n    'EXCLUDE PROVIDERS NOT IN SCOPE\r\n        Exclude(rid) \r\n    \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P07_AddLumpSum","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    'VARIABLES USED IN PRODUCT\r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Baseline_Additional_LumpSum As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.Additional_lump_sum_for_schools_amalgamated_during_FY15-16]\r\n    Dim Baseline_Adjusted_Additional_LumpSum As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Final_Baselines_dataset.APT_Final_Baselines_dataset.Adjusted_Additional_lump_sum_for_schools_amalgamated_during_FY15-16]\r\n    'Dim FringeInd As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n                                                                               \r\n    'PRINT VARIABLES TO ALLOW CHECKING\r\n    Print(Baseline_Additional_LumpSum, \"Baseline_Additional_LumpSum\", rid)\r\n    Print(Baseline_Adjusted_Additional_LumpSum, \"Baseline_Adjusted_Additional_LumpSum\", rid)\r\n                                                       \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    IF AcType = 17181 Then\r\n    \r\n        IF Baseline_Adjusted_Additional_LumpSum > 0 Then \r\n        \r\n        result = Baseline_Adjusted_Additional_LumpSum\r\n        \r\n        Else\r\n        \r\n        result =  Baseline_Additional_LumpSum\r\n        \r\n        End If  \r\n       \r\n        Else\r\n \r\n        Exclude(rid)         \r\n       \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P08_TotalLumpSum","Script":" Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n     Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n     Dim AddLumpSum As Decimal = Products.1718_MFG.P07_AddLumpSum\r\n     Dim LumpSumPri As Decimal = Products.1718_SBS.P241_priLumpSumSubtotal\r\n     Dim LumpSumSec As Decimal = Products.1718_SBS.P245_SecLumpSumSubtotal\r\n     Dim FringeAdj As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe\r\n     Dim LondonFringe As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe    \r\n     Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     Dim FringeAdjString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe    \r\n     Dim FringeCensusString As String = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n\r\n    Dim FringeFactor As Decimal\r\n    \r\n    If String.IsNullOrEmpty(FringeAdjString) then\r\n    \r\n        FringeFactor = LondonFringe\r\n    \r\n    Else\r\n    \r\n        FringeFactor = FringeAdj\r\n    \r\n    End If\r\n    \r\n    If String.IsNullOrEmpty(FringeAdjString) And\r\n    string.IsNullOrEmpty(FringeCensusString) then\r\n    \r\n        FringeFactor = 1\r\n    \r\n    End if\r\n    \r\n        If FundingBasis = \"Place\" Then\r\n    \r\n            exclude(rid) \r\n                                      \r\n        Else\r\n    \r\n            If AcType = 17181 then\r\n      \r\n                result =  (AddLumpSum + LumpSumPri + LumpSumSec) * LondonFringe \r\n        \r\n            Else \r\n        \r\n                exclude(rid)\r\n        \r\n            End if\r\n    \r\n        End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P09_1718_Sparsity","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SparsityTaper As Decimal = Products.1718_SBS.P198_SparsityTaperSubtotal \r\n    Dim SparsityLumpSubtotal As Decimal = Products.1718_SBS.P197_SparsitylumpSumSubtotal \r\n    Dim P265_SBS As Decimal = products.1718_SBS.P265_Ex2Subtotal\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)    \r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid)                    \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = SparsityLumpSubtotal + SparsityTaper + P265_SBS\r\n                                                                                                            \r\n        End If \r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P10_PriorYr_NegAdj","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n\r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFG_Prior_Year_Neg_Adj As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_prior_year_negative_adjustment\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    \r\n    Print(MFG_Prior_Year_Neg_Adj, \"MFG_Prior_Year_Neg_Adj\", rid)\r\n                                                               \r\n    If FundingBasis = \"Place\" Then   \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        IF AcType = 17181 Then\r\n        \r\n            result = MFG_Prior_Year_Neg_Adj\r\n        \r\n        Else\r\n        \r\n            Exclude(rid)  \r\n        \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P11_PriorYr_PosAdj","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n            \r\n    'VARIABLES USED IN PRODUCT\r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFG_Prior_Year_Pos_Adj As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_prior_year_positive_adjustment\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n    \r\n    Print(MFG_Prior_Year_Pos_Adj, \"MFG_Prior_Year_Pos_Adj\", rid) \r\n        \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        IF AcType = 17181 Then\r\n        \r\n            result = MFG_Prior_Year_Pos_Adj\r\n        \r\n        Else\r\n        \r\n            Exclude(rid)\r\n        \r\n        End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P12_MFG_Baseline","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n                 \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFG_P04 As Decimal = Products.1718_MFG.P04_1617_MFG_Base_Funding\r\n    Dim MFG_P05 As Decimal = Products.1718_MFG.P05_1617_BaseExclusions\r\n    Dim MFG_P06 As Decimal = Products.1718_MFG.P06_1617_BaseTechAdj\r\n    Dim MFG_P08 As Decimal = Products.1718_MFG.P08_TotalLumpSum\r\n    Dim MFG_P09 As Decimal = Products.1718_MFG.P09_1718_Sparsity\r\n    Dim MFG_P10 As Decimal = Products.1718_MFG.P10_PriorYr_NegAdj      \r\n    Dim MFG_P11 As Decimal = Products.1718_MFG.P11_PriorYr_PosAdj \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    Print(MFG_P04, \"MFG base funding\",rid)  \r\n    Print(MFG_P05, \"Base Exclusions\",rid)\r\n    Print(MFG_P06, \"Base Tech Adj\",rid)\r\n    Print(MFG_P08, \"Baseline Lump Sum Deduction\", rid)\r\n    Print(MFG_P09, \"Baseline Sparsity Deduction\", rid)\r\n    Print(MFG_P10, \"Prior Year EFA Negative Adjustment\", rid)                       \r\n    Print(MFG_P11, \"Prior Year EFA Positive Adjustment\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    IF AcType = 17181 Then\r\n    \r\n    result =  MFG_P04 - MFG_P05 - MFG_P06 - MFG_P08 - MFG_P09 - MFG_P10 + MFG_P11\r\n    \r\n    Else\r\n    \r\n    'EXCLUDE PROVIDERS NOT IN SCOPE\r\n    Exclude(rid)  \r\n    \r\n    End If\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function \r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P13a_1617_NOR","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0    \r\n        \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR As Decimal =  Products.1718_NOR.NOR_P39_1617_MFG_NOR\r\n    Dim Places As Decimal = Products.1718_MFG.P14_1617_HNPlaces\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n  \r\n    Print(NOR, \"NOR\", rid)\r\n    Print(Places, \"Places\", rid)    \r\n \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n\r\n        If AcType = 17181 then\r\n    \r\n            Result = NOR + Places\r\n            \r\n        Else\r\n\r\n            exclude(rid)\r\n    \r\n        End if\r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function    \r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":0},{"Name":"P14_1617_HNPlaces","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n     Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n     Dim HNPre16 As Decimal = Products.1718_NOR.NOR_P36_1617_pre16_HN\r\n     Dim APPre16 As Decimal = Products.1718_NOR.NOR_P37_1617_pre16_AP\r\n     Dim HospPre16 As Decimal = Products.1718_NOR.NOR_P38_1617_HN_Hosp_Pl  \r\n     Dim TotalHN As Decimal = Persisted.Report_AY1617_Acad_NOR:NOR_AY201617_Report.P27b_Total_HN_MFG    \r\n     Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     Dim DateOpen As Date = DataSets.Administration.Providers.Provider_Information.Date_Opened \r\n           \r\n    If FundingBasis = \"Place\" Then\r\n     \r\n        exclude(rid) \r\n    \r\n    Else\r\n     \r\n        If AcType = 17181 then\r\n         \r\n            If DateOpen <= \"01 March 2016\" then \r\n             \r\n                Result = TotalHN\r\n             \r\n            Else\r\n             \r\n                Result = HNPre16 + APPre16 + HospPre16\r\n              \r\n            End If  \r\n          \r\n        Else \r\n         \r\n            exclude(rid)\r\n         \r\n        End if \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P15_PriorYr_NOR_NegAdj","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n        \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NegNOR As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_prior_year_neg_NOR_adj_\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    If FundingBasis = \"Place\" Then        \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = NegNOR\r\n        \r\n        Else exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P16_PriorYr_NOR_PosAdj","Script":"              Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim PosNOR As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_prior_year_pos_NOR_adj_\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then    \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            result = PosNOR\r\n        \r\n        Else\r\n        \r\n            exclude(rid)\r\n    \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P17a_Adjusted_1617_NOR","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n                           \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR As Decimal = Products.1718_MFG.P13a_1617_NOR\r\n    Dim HNPlaces As Decimal = Products.1718_MFG.P14_1617_HNPlaces\r\n    Dim EFANeg As Decimal = Products.1718_MFG.P15_PriorYr_NOR_NegAdj\r\n    Dim EFAPos As Decimal = Products.1718_MFG.P16_PriorYr_NOR_PosAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n       \r\n    Print(NOR, \"NOR 1617\", rid)\r\n    Print(HNPlaces, \"HN Places 1617\", rid)\r\n    Print(EFANeg, \"EFA Negative NOR Adj\", rid)\r\n    Print(EFAPos, \"EFA Positive NOR Adj\", rid)    \r\n    \r\n             \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n          \r\n            result = NOR - HNPlaces - EFANeg + EFAPos \r\n                                     \r\n        Else exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n     \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":6},{"Name":"P18a_1617_MFGPerPupil","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n                       \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Baseline As Decimal = Products.1718_MFG.P12_MFG_Baseline\r\n    Dim NOR As Decimal = Products.1718_MFG.P17a_Adjusted_1617_NOR\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n                                \r\n    Print(Baseline, \"Baseline Funding\", rid)\r\n    Print(NOR, \"Baseline MFG NOR\", rid)\r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181\r\n        \r\n            Result = Baseline / NOR            \r\n       \r\n        Else exclude(rid)\r\n        \r\n        End If\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":9},{"Name":"P19a_MFG_ProtectedPP","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n                    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim BasePP As Decimal = Products.1718_MFG.P18a_1617_MFGPerPupil\r\n    Dim Rate As Decimal = 1 + Products.1718_Global_Variables.P017_MFG_Level\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n      \r\n    Print(BasePP, \"Base per pupil\", rid)\r\n    Print(Rate, \"MFG rate\", rid)\r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = BasePP * Rate\r\n        \r\n        Else exclude(rid)\r\n                           \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"1_Baselines","DecimalPlaces":9},{"Name":"P20_1718_SBS","Script":" Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n              \r\n    Dim AcType As String = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim TotalSBS As Decimal = Products.1718_SBS.P288_SBSFundingTotal\r\n    Dim FundingBasis As String = DataSets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n                                             \r\n        If AcType = 17181 then\r\n    \r\n            result = TotalSBS\r\n   \r\n        Else exclude(rid)\r\n    \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P22_1718_MFG_Excl","Script":"    Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n   \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Exc1 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Approved_MFG_Exemptions_1]\r\n    Dim Exc2 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Approved_MFG_Exemptions_2]\r\n    Dim Exc3 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Approved_MFG_Exemptions_3]   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    Print(Exc1, \"MFG Exclusion 1\", rid)\r\n    Print(Exc2, \"MFG Exclusion 2\", rid)\r\n    Print(Exc3, \"MFG Exclusion 3\", rid)    \r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            result = Exc1 + Exc2 + Exc3\r\n       \r\n        Else \r\n        \r\n            exclude(rid)\r\n    \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P23_1718_MFG_TechAdj","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n         \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Tech1 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Technical_adjustments_1:_Reserved_for_New_delegation]\r\n    Dim Tech2 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Technical_adjustments_2:_] \r\n    Dim Tech3 As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.17-18_Technical_adjustments_3]   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    Print(Tech1, \"MFG Tech Adj 1\", rid)\r\n    Print(Tech2, \"MFG Tech Adj 2\", rid)    \r\n    Print(Tech3, \"MFG Tech Adj 3\", rid)\r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            result = Tech1 + Tech2 + Tech3\r\n      \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P24_1718_LumpSum_AddSum","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n        \r\n     Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n     Dim LumpSumPri As Decimal = Products.1718_SBS.P241_priLumpSumSubtotal\r\n     Dim LumpSumSec As Decimal = Products.1718_SBS.P245_SecLumpSumSubtotal\r\n     Dim Ex1 As Decimal = Products.1718_SBS.P261_Ex1Subtotal\r\n     Dim FringeCensus As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n     Dim FringeAdj As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe\r\n     Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     Dim FringeAdjString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe\r\n     Dim FringeCensusString As String = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n\r\n     Dim FringeFactor As Decimal\r\n    \r\n        If string.IsNullOrEmpty(FringeAdjString) then\r\n        \r\n        FringeFactor = FringeCensus\r\n        \r\n        Else\r\n        \r\n        FringeFactor = FringeAdj\r\n        \r\n        End If\r\n\r\n            If string.IsNullOrEmpty(FringeAdjString) And string.IsNullOrEmpty(FringeCensusString) then\r\n            \r\n            FringeFactor = 1\r\n     \r\n            End if\r\n            \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n                \r\n                Result = FringeFactor * (LumpSumPri + LumpSumSec + Ex1)\r\n   \r\n        Else \r\n        \r\n            exclude(rid)\r\n    \r\n        End If \r\n        \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P25_1718_Sparsity","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SparFix As Decimal = Products.1718_SBS.P197_SparsitylumpSumSubtotal \r\n    Dim SparTap As Decimal = Products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim Ex2 As Decimal = Products.1718_SBS.P265_Ex2Subtotal   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     \r\n    Print(SparFix, \"Sparsity Fixed Total\", rid)\r\n    Print(SparTap, \"Sparsity Tapered Total\", rid)  \r\n    Print(Ex2, \"Ex2Subtotal\", rid)\r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid)\r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = SparFix + SparTap + Ex2  \r\n      \r\n        Else\r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P26_CurrentYr_EFA_NegAdj","Script":"  Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n      \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim EFANeg As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_current_year_negative_adjustment   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n \r\n    If FundingBasis = \"Place\" Then \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181\r\n        \r\n            Result = EFANeg\r\n      \r\n        Else\r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P27_CurrentYr_EFA_PosAdj","Script":"   Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n     \r\n     Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n     Dim EFAPos As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_current_year_positive_adjustment\r\n     Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     \r\n    If FundingBasis = \"Place\" Then   \r\n     \r\n        exclude(rid)\r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = EFAPos\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n       \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P28_1718_Total_MFG","Script":"Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n       \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SBS As Decimal = products.1718_MFG.P20_1718_SBS\r\n    Dim MFGExl As Decimal = products.1718_MFG.P22_1718_MFG_Excl\r\n    Dim MFGTechAdj As Decimal = products.1718_MFG.P23_1718_MFG_TechAdj\r\n    Dim LumpSums As Decimal = products.1718_MFG.P24_1718_LumpSum_AddSum\r\n    Dim Sparsity As Decimal = products.1718_MFG.P25_1718_Sparsity\r\n    Dim EFANeg As Decimal = products.1718_MFG.P26_CurrentYr_EFA_NegAdj\r\n    Dim EFAPos As Decimal = products.1718_MFG.P27_CurrentYr_EFA_PosAdj\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    If FundingBasis = \"Place\" Then\r\n                                               \r\n        exclude(rid) \r\n\r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            result = SBS - MFGExl - MFGTechAdj - LumpSums - Sparsity - EFANeg + EFAPos\r\n       \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P29_1718_NOR","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal =   Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR As Decimal = Products.1718_NOR.NOR_P27a_Total_NOR_MFG\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 Then \r\n        \r\n            Result = NOR\r\n      \r\n        Else\r\n            \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P30_1718_HN_Places","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\nDim result = 0\r\n      \r\n        Dim AcType As Decimal =   Products.1718_Global_Variables.F100_AllAcademies\r\n        Dim HNPlaces As Decimal =  Products.1718_NOR.NOR_P27b_Total_HN_MFG\r\n        Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n  \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 Then \r\n        \r\n            Result = HNPlaces\r\n         \r\n        Else \r\n        \r\n            exclude(rid)                       \r\n    \r\n        End If \r\n    \r\n    End If \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P31_1718_EFA_NegAdj_NOR","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n      \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim EFANegNOR As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_curent_year_neg_NOR_adj_\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     \r\n    If FundingBasis = \"Place\" Then\r\n                                           \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = EFANegNOR\r\n      \r\n        Else \r\n            \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P32_1718_EFA_PosAdj_NOR","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n      \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim EFAPosNOR As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_current_year_pos_NOR_adj_\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n                                           \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = EFAPosNOR\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n        \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P33a_1718_Adjusted_NOR","Script":" Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR As Decimal = Products.1718_MFG.P29_1718_NOR\r\n    Dim HNPlaces As Decimal = Products.1718_MFG.P30_1718_HN_Places\r\n    Dim EFANeg As Decimal = Products.1718_MFG.P31_1718_EFA_NegAdj_NOR\r\n    Dim EFAPos As Decimal = Products.1718_MFG.P32_1718_EFA_PosAdj_NOR\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n  \r\n   Print(NOR, \"NOR 1718\", rid)      \r\n   Print(HNPlaces, \"HN Places\", rid)\r\n   Print(EFANeg, \"EFA Neg Adj\", rid)\r\n   Print(EFAPos, \"EFA Pos Adj\", rid)\r\n       \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n\r\n        If AcType = 17181 then\r\n    \r\n            Result = NOR - HNPlaces - EFANeg + EFAPos\r\n      \r\n        Else\r\n        \r\n            exclude(rid)\r\n    \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P34a_1718_MFG_PPFunding","Script":" Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim BaseFunding As Decimal = Products.1718_MFG.P28_1718_Total_MFG\r\n    Dim AdjNOR As Decimal = Products.1718_MFG.P33a_1718_Adjusted_NOR\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n     \r\n    Print(BaseFunding, \"1718 Total Baseline MFG Funding\", rid)\r\n      \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n                                        \r\n    Else\r\n\r\n        If AcType = 17181 then\r\n    \r\n            Result = BaseFunding / AdjNOR\r\n          \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If\r\n    \r\n    End If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":9},{"Name":"P35a_GuaranteedFunding","Script":" Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n   \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AdjNOR As Decimal = Products.1718_MFG.P33a_1718_Adjusted_NOR\r\n    Dim ProtectPP As Decimal = Products.1718_MFG.P19a_MFG_ProtectedPP\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n   Print(AdjNOR, \"Adj NOR\", rid)\r\n   Print(ProtectPP, \"MFG Protected Per Pupil amount\", rid)\r\n   \r\n    If FundingBasis = \"Place\" Then\r\n   \r\n        exclude(rid) \r\n    \r\n    Else\r\n   \r\n        If AcType = 17181 then        \r\n        \r\n            Result = AdjNOR * ProtectPP \r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End If \r\n    \r\n    End If \r\n   \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P36a_MFG_Adj","Script":"  Public Function GetProductResult(rid As String) As Decimal\r\n    Dim result = 0\r\n     \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim Guarantee As Decimal = Products.1718_MFG.P35a_GuaranteedFunding\r\n    Dim Base As Decimal = Products.1718_MFG.P28_1718_Total_MFG\r\n    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n   \r\n    Print(Guarantee, \"Guaranteed Funding\", rid)\r\n    Print(Base, \"1718 Adjusted SBS Budget\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n                                   \r\n        If AcType = 17181 then\r\n        \r\n            If Guarantee > Base then\r\n            \r\n                result = Guarantee - Base\r\n                \r\n            else\r\n           \r\n                result = 0\r\n                \r\n            End if    \r\n           \r\n        Else \r\n    \r\n            exclude(rid)\r\n\r\n        End If \r\n    \r\n    End If \r\n       \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"2_Current year","DecimalPlaces":6},{"Name":"P42_Apply_Cap_Decision","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As String = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim CapScale As String = Products.1718_MFG.P40_CapScale_YN\r\n    Dim GrowingSchool As String = Products.1718_MFG.P41_GrowingSchool_YN\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    Print(CapScale, \"Capping scale applied\", rid)\r\n    Print(GrowingSchool, \"Growing school\", rid)     \r\n    \r\n    If FundingBasis = \"Place\" Then  \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 Then                                                                                               \r\n        \r\n            If CapScale = \"Yes\" Then \r\n        \r\n                If GrowingSchool = \"No\" then\r\n                \r\n                    Result = 1\r\n                \r\n                Else \r\n                \r\n                    Result = 0\r\n            \r\n                End If \r\n        \r\n            Else Result = 0\r\n        \r\n            End If \r\n    \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n        \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P43_CappingFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim CapFactor As decimal = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Capping_Factor) \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(CapFactor, \"Capping factor\", rid)\r\n    \r\n    If FundingBasis = \"Place\" then\r\n        exclude(rid)\r\n    else\r\n        If AcType=17181 then\r\n            result=CapFactor\r\n        else\r\n            exclude(rid)\r\n        End if\r\n    End if\r\n    \r\n    \r\n    Return result\r\n\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P44_ScaleFactor","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim ScaleFactor As decimal = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Scaling_Factor)\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(ScaleFactor, \"Scale factor\", rid)  \r\n    \r\n    If FundingBasis = \"Place\" Then            \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = ScaleFactor\r\n        \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else\r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P45a_PercentChangeUnitValue","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim PPFunding As Decimal = Products.1718_MFG.P34a_1718_MFG_PPFunding\r\n    Dim MFGPerPupil As Decimal = Products.1718_MFG.P18a_1617_MFGPerPupil    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(PPFunding, \"PP funding\", rid)\r\n    Print(MFGPerPupil, \"MFG per pupil\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then                                       \r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = (PPFunding - MFGPerPupil) / MFGPerPupil\r\n        \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P46a_Change_Exceeds_Cap","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim PercentChangeUnitValue As Decimal = Products.1718_MFG.P45a_PercentChangeUnitValue\r\n    Dim CappingFactor As Decimal = Products.1718_MFG.P43_CappingFactor   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(PercentChangeUnitValue, \"Percent change unit value\", rid)\r\n    Print(CappingFactor, \"Capping factor\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else                                            \r\n    \r\n    If AcType = 17181 then\r\n    \r\n    If PercentChangeUnitValue > CappingFactor  Then \r\n    \r\n        Result = PercentChangeUnitValue - CappingFactor\r\n        \r\n        Else Result = 0\r\n        \r\n    End If \r\n    \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P47a_Scale_Factor_Applied","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim ChangeExceedsCap As Decimal = Products.1718_MFG.P46a_Change_Exceeds_Cap\r\n    Dim ScaleFactor As Decimal = Products.1718_MFG.P44_ScaleFactor   \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(ChangeExceedsCap, \"Change exceeds cap\", rid)\r\n    Print(ScaleFactor, \"Scale factor\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = ChangeExceedsCap * ScaleFactor\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)                  \r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P48a_AffordAdj","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim ApplyCapDec As Decimal = Products.1718_MFG.P42_Apply_Cap_Decision\r\n    Dim ScaleFacApp As Decimal = Products.1718_MFG.P47a_Scale_Factor_Applied\r\n    Dim AdjNOR1718 As Decimal = Products.1718_MFG.P33a_1718_Adjusted_NOR\r\n    Dim MFGPP1617 As Decimal = Products.1718_MFG.P18a_1617_MFGPerPupil    \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(ApplyCapDec, \"Apply cap decision\", rid)\r\n                                           \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            If ApplyCapDec = 1 THEN           \r\n            \r\n                Result = ScaleFacApp * AdjNOR1718 * MFGPP1617\r\n            \r\n            Else \r\n            \r\n                Result = 0\r\n            \r\n            End If\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE       \r\n    \r\n        Else \r\n    \r\n            exclude(rid)\r\n            \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":10},{"Name":"P49a_ChangeBelowFloor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim PercentChangeUnitValue As Decimal = Products.1718_MFG.P45a_PercentChangeUnitValue\r\n    Dim MinFundingGuarantee As Decimal = products.1718_Global_Variables.P017_MFG_Level\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(PercentChangeUnitValue, \"Percentage change unit value\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            If PercentChangeUnitValue < MinFundingGuarantee Then \r\n            \r\n                Result = MinFundingGuarantee - PercentChangeUnitValue\r\n            \r\n            Else \r\n            \r\n                Result = 0\r\n            \r\n            End If\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function","ProductType":"Other","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":9},{"Name":"P50a_OverallNet_Adj","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFG_Adj As Decimal = Products.1718_MFG.P36a_MFG_Adj\r\n    Dim AffordAdj As Decimal = Products.1718_MFG.P48a_AffordAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(MFG_Adj, \"MFG adjustment\", rid)\r\n    Print(AffordAdj, \"Affordability adjustment\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = MFG_Adj - AffordAdj\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P51a_MFG_After_Adj","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim TotalMFG1718 As Decimal = Products.1718_MFG.P28_1718_Total_MFG\r\n    Dim OverallNetAdj As Decimal = Products.1718_MFG.P50a_OverallNet_Adj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(TotalMFG1718, \"MFG adjustment\", rid)\r\n    Print(OverallNetAdj, \"Affordability adjustment\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = TotalMFG1718 + OverallNetAdj\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P52a_MFG_After_Adj_PP","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFGAfterAdj As Decimal = Products.1718_MFG.P51a_MFG_After_Adj\r\n    Dim AdjNOR1718 As Decimal = Products.1718_MFG.P33a_1718_Adjusted_NOR\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(MFGAfterAdj, \"MFG after adjustment\", rid)\r\n    Print(AdjNOR1718, \"Adjusted 1718 NOR\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17181 then\r\n    \r\n    Result = MFGAfterAdj / AdjNOR1718\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P53a_PercentChange_PP","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFGAfterAdjPP As Decimal = Products.1718_MFG.P52a_MFG_After_Adj_PP\r\n    Dim MFG_PP1617 As Decimal = Products.1718_MFG.P18a_1617_MFGPerPupil\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(MFGAfterAdjPP, \"MFG after adjustment PP\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = (MFGAfterAdjPP - MFG_PP1617) / MFG_PP1617\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P54a_Final1718_SBS_MFG","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SBS1718 As Decimal = Products.1718_MFG.P20_1718_SBS\r\n    Dim OverallNetAdj As Decimal = Products.1718_MFG.P50a_OverallNet_Adj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(SBS1718, \"SBS 1718\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 then\r\n        \r\n            Result = SBS1718 + OverallNetAdj\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"3_Capping and scaling","DecimalPlaces":6},{"Name":"P55a_NOR_fromAPT","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim BaseNor As Decimal = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Adjusted_Factors_dataset.APT_Adjusted_Factors_dataset.16-17_Base_NOR]\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n                                                                                          \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17182 Or AcType = 17183 Then \r\n    \r\n           result = BaseNor\r\n                                          \r\n        'EXCLUDE PROVIDERS Not In SCOPE                                                             \r\n    \r\n        Else \r\n        \r\n            exclude(rid)\r\n    \r\n        End if                                                   \r\n    \r\n    End If \r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P56_IYNOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_MFG As Decimal = Products.1718_NOR.NOR_P27a_Total_NOR_MFG\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(NOR_MFG, \"NOR MFG\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17182 Or AcType = 17183 then  \r\n        \r\n            Result = NOR_MFG\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P57_IY1718HNPLaces","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim HN_NOR As Decimal =  Products.1718_NOR.NOR_P27b_Total_HN_MFG\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(HN_NOR, \"HN NOR\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17182 Or AcType = 17183 then\r\n        \r\n            Result = HN_NOR\r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P58_IY1718EFANegAdjNOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NegAdj As Decimal = DataSets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_current_year_negative_adjustment\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(NegAdj, \"Current year negative adjustment\", rid)  \r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17182 Or AcType = 17183 then\r\n    \r\n            Result = NegAdj\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n        Else\r\n        \r\n            exclude(rid)\r\n    \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P59_IY1718EFAPosAdjNOR","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim PosAdj As Decimal = DataSets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_current_year_positive_adjustment\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n\r\n    Print(PosAdj, \"Current year positive adjustment\", rid)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17182 Or AcType = 17183 then\r\n    \r\n            Result = PosAdj\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n        Else \r\n        \r\n            exclude(rid)\r\n    \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P60_IY_1718_AdjNOR","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim IYNOR As Decimal = Products.1718_MFG.P56_IYNOR\r\n    Dim HNPlaces As Decimal = Products.1718_MFG.P57_IY1718HNPLaces\r\n    Dim NegAdjNOR As Decimal = Products.1718_MFG.P58_IY1718EFANegAdjNOR\r\n    Dim PosAdjNOR As Decimal = Products.1718_MFG.P59_IY1718EFAPosAdjNOR\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n                                     \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If (AcType = 17182 Or AcType = 17183) then\r\n    \r\n            Result = IYNOR - HNPlaces - NegAdjNOR + PosAdjNOR\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n        Else \r\n        \r\n            exclude(rid)\r\n    \r\n        End If \r\n    \r\n    End If \r\n    \r\nReturn Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P61_IY_NetAdj_fromAPT","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFGAdj As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_MFG_Adjustment\r\n    Dim OpenClose As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Local_factors_dataset.APT_Local_factors_dataset.Opening/Closing]                                  \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then         \r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17182 Or AcType = 17183 then\r\n    \r\n    Result = MFGAdj / OpenClose\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P62a_IYOpeners_NetAdj","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR_APT As Decimal = Products.1718_MFG.P55a_NOR_fromAPT\r\n    Dim AdjNOR As Decimal = Products.1718_MFG.P60_IY_1718_AdjNOR\r\n    Dim NetAdjAPT As Decimal = Products.1718_MFG.P61_IY_NetAdj_fromAPT\r\n    Dim DaysOpen As Decimal =  Products.1718_Global_Variables.P027_DaysOpen\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n                                                                      \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17182 Or AcType = 17183 then\r\n    \r\n    Result = NetAdjAPT * DaysOpen / 365 * AdjNOR / NOR_APT \r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P63a_IYOpeners_adj_SBS_Total","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SBSFunding As Decimal = Products.1718_SBS.P289_InYearSBSFundingTotal\r\n    Dim IYNetAdj As Decimal = Products.1718_MFG.P62a_IYOpeners_NetAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17182 Or AcType = 17183 then\r\n    \r\n    Result = SBSFunding + IYNetAdj \r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"4_New openers","DecimalPlaces":6},{"Name":"P64_EFA_MFG_Adj","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFGAdj As Decimal = DataSets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.MFG_outcome_adjustment_total\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n        exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If AcType = 17181 Or AcType = 17182 Or AcType = 17183 then                                          \r\n        \r\n            Result = MFGAdj \r\n                                              \r\n        'EXCLUDE PROVIDERS Not In SCOPE\r\n        \r\n        Else \r\n        \r\n            exclude(rid)\r\n        \r\n        End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"5_Totals","DecimalPlaces":6},{"Name":"P65a_Total_Overall_NetAdj","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim OverallNetAdj As Decimal = Products.1718_MFG.P50a_OverallNet_Adj\r\n    Dim IYNetAdj As Decimal = Products.1718_MFG.P62a_IYOpeners_NetAdj\r\n    Dim MFGAdj As Decimal = Products.1718_MFG.P64_EFA_MFG_Adj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17181 Or AcType = 17182 Or AcType = 17183 then\r\n    \r\n    Result = OverallNetAdj + IYNetAdj + MFGAdj \r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"5_Totals","DecimalPlaces":6},{"Name":"P70a_FAP_Baseline","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim MFGBase As Decimal = Products.1718_MFG.P04_1617_MFG_Base_Funding \r\n    Dim PriorNegAdj As Decimal = Products.1718_MFG.P10_PriorYr_NegAdj\r\n    Dim PriorPosAdj As Decimal = Products.1718_MFG.P11_PriorYr_PosAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n                                                                                         \r\n    If AcType = 17181 Then\r\n                                                            \r\n    Result = MFGBase - PriorNegAdj + PriorPosAdj  \r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"6_FAP products","DecimalPlaces":6},{"Name":"P71a_FAP_Baseline_NOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR1617 As Decimal = Products.1718_MFG.P13a_1617_NOR \r\n    Dim NORPosAdj As Decimal = Products.1718_MFG.P16_PriorYr_NOR_PosAdj\r\n    Dim NORNegAdj As Decimal = Products.1718_MFG.P15_PriorYr_NOR_NegAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then                 \r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17181 Then\r\n                                                             \r\n    Result = NOR1617 + NORPosAdj - NORNegAdj\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"6_FAP products","DecimalPlaces":6},{"Name":"P71b_FAP_Baseline_NOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n                                    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim NOR1617 As Decimal = Products.1718_MFG.P13b_1617_NOR \r\n    Dim NORPosAdj As Decimal = Products.1718_MFG.P16_PriorYr_NOR_PosAdj\r\n    Dim NORNegAdj As Decimal = Products.1718_MFG.P15_PriorYr_NOR_NegAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n                                         \r\n    If FundingBasis = \"Place\" Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17181 Then\r\n    \r\n    Result = NOR1617 + NORPosAdj - NORNegAdj\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_MFG","FolderName":"6_FAP products","DecimalPlaces":0},{"Name":"P72_FAP_CurrentYr_SBS_Total","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcType As Decimal = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim SBS1718 As Decimal = Products.1718_MFG.P20_1718_SBS \r\n    Dim CurrentNegAdj As Decimal = Products.1718_MFG.P26_CurrentYr_EFA_NegAdj\r\n    Dim CurrentPosAdj As Decimal = Products.1718_MFG.P27_CurrentYr_EFA_PosAdj\r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    \r\n    If FundingBasis = \"Place\" Then \r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n    If AcType = 17181 Then\r\n    \r\n    Result = SBS1718 - CurrentNegAdj + CurrentPosAdj\r\n                                          \r\n    'EXCLUDE PROVIDERS Not In SCOPE\r\n    \r\n    Else exclude(rid)\r\n    \r\n    End if\r\n    \r\n    End If \r\n    \r\n    Return Result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_MFG","FolderName":"6_FAP products","DecimalPlaces":6},{"Name":"P004_PriRate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Double = 0 \r\n    \r\n        Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        Dim P004_PriRate As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_Primary_Amount_Per_Pupil)\r\n                 \r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)\r\n    \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 1712 Or acadfilter = 17183 Then \r\n                                                                                     \r\n    result = P004_PriRate     \r\n    \r\n    Else \r\n    \r\n        exclude(rid)\r\n        \r\n    End If \r\n     \r\n End If \r\n                        \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P005_PriBESubtotal","Script":"Function GetProductResult(rid As String) As Double\r\n   Dim result = 0\r\n   \r\n            Dim F100_AllAcademies As Double =   Products.1718_Global_Variables.F100_AllAcademies            \r\n            Dim FundingBasis As String =        Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181) \r\n            Dim PrimaryPupils As Double =       Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS      \r\n            Dim P004_PriRate As Double =        Products.1718_SBS.P004_PriRate            \r\n            Dim P005_Pri_BESubtotal As Double = PrimaryPupils * P004_PriRate\r\n            Dim P005_Pri_BESubtotalAPT As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Basic_Entitlement_Primary] \r\n  \r\n            Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n            Print(FundingBasis, \"FundingBasis\", rid)\r\n            Print(PrimaryPupils,\"PrimaryPupils\",rid)\r\n            Print(P004_PriRate,\"P004_PriRate\",rid) \r\n            Print(P005_Pri_BESubtotal,\"P005_Pri_BESubtotal\",rid) \r\n            \r\nIf FundingBasis = \"Place\" Then \r\n\r\n    exclude(rid)\r\n    \r\nElse     \r\n\r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = \"Estimate\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Estimate\") THEN\r\n         \r\n         Result = P005_Pri_BESubtotal\r\n    \r\n    Else\r\n                  \r\n        If (F100_AllAcademies = 17182 And FundingBasis = \"Census\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Census\")  THEN\r\n            \r\n            'Print(P005_Pri_BESubtotalAPT,\"P005_Pri_BESubtotalAPT\",rid)\r\n\r\n            Result = P005_Pri_BESubtotalAPT\r\n       \r\n        Else \r\n\r\n            exclude(rid)\r\n\r\n        End If\r\n      \r\n   \r\n    End If \r\n                    \r\nEnd If\r\n     \r\n                    \r\n     Return result\r\n      \r\nEnd Function\r\n  \r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":2},{"Name":"P006_NSEN_PriBE","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n   Dim result As Decimal = 0 'change to As String if text product\r\n   \r\n   Dim P005_PriBESubtotal As Double =  Products.1718_SBS.P005_PriBESubtotal      \r\n   Dim P006a_NSEN_PriBE_percent As Double = Products.1718_SBS.P006a_NSEN_PriBE_percent / 100             \r\n   Dim P006_NSEN_PriBE As Double =  P005_PriBESubtotal * P006a_NSEN_PriBE_percent\r\n   \r\n   Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n   Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n                               \r\nIf FundingBasis = \"Place\" Then \r\n\r\n    exclude(rid)\r\n    \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n                      \r\n     Result = P006_NSEN_PriBE \r\n\r\n    Else \r\n        \r\n        exclude(rid)\r\n        \r\n    End If \r\n\r\nEnd If \r\n  \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P006a_NSEN_PriBE_percent","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n          \r\n        Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n        Dim NSEN_PriBE_Percent As Double = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_Primary_Notional_SEN)\r\n        Dim P006_NSEN_PriBE_Percent As Double = NSEN_PriBE_Percent * 100    \r\n  \r\n        If (F200_SBS_Academies = 1) Then\r\n          Result = P006_NSEN_PriBE_Percent\r\n\r\n        Else \r\n        \r\n        exclude(rid)\r\n        \r\n        End if\r\n        \r\n       Return result\r\n    \r\nEnd Function\r\n\r\n   ","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":0},{"Name":"P007_InYearPriBE_Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P005_PriBESubtotal As Decimal = Products.1718_SBS.P005_PriBESubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim P25_YearDays_1718 As Decimal = Products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies \r\n    \r\n    \r\n    Print(P005_PriBESubtotal, \"P005_PriBESubtotal\", rid) \r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n    Print(P25_YearDays_1718, \"P25_YearDays_1718\", rid) \r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n    \r\n        Result = (P005_PriBESubtotal) * P001_1718DaysOpen / P25_YearDays_1718\r\n   \r\n        \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P009_KS3Rate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim P009_KS3Rate As Double = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_KS3_Amount_Per_Pupil)\r\n    \r\nIf FundingBasis = \"Place\" Then \r\n\r\n    exclude(rid)\r\n    \r\nElse     \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n\r\n        result = P009_KS3Rate     \r\n\r\n    Else\r\n    \r\n        Exclude(rid)\r\n    \r\n    End If \r\n    \r\nEnd If     \r\n      \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P010_KS3_BESubtotal","Script":"Function GetProductResult(rid As String) As Double\r\n   Dim result = 0\r\n   \r\n            Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n            Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n            Dim AcadFilter As Double = products.1718_Global_Variables.F200_SBS_Academies\r\n            Dim P008_KS3Pupils As Double =  Products.1718_NOR.NOR_P23_Total_NOR_KS3_SBS           \r\n            Dim P009_KS3Rate As Double = Products.1718_SBS.P009_KS3Rate               \r\n            Dim P010_KS3_BESubtotal As Double =  (P008_KS3Pupils * P009_KS3Rate)\r\n            Dim P010_KS3_BESubtotalAPT As Double = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Basic_Entitlement_KS3]\r\n                                                                                                                                               \r\n            Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n            Print(FundingBasis, \"FundingBasis\", rid)\r\n            Print(P008_KS3Pupils,\"P008_KS3Pupils\",rid)\r\n            Print(P009_KS3Rate,\"P009_KS3Rate\",rid) \r\n            \r\nIf FundingBasis = \"Place\" Then \r\n\r\n    exclude(rid)\r\n    \r\nElse     \r\n\r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = \"Estimate\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Estimate\") THEN\r\n        \r\n        Result = P010_KS3_BESubtotal\r\n\r\n    Else\r\n              \r\n        If (F100_AllAcademies = 17182 And FundingBasis = \"Census\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Census\")  THEN\r\n\r\n            Print(P010_KS3_BESubtotalAPT,\"P010_KS3_BESubtotalAPT\",rid)\r\n\r\n            Result = P010_KS3_BESubtotalAPT\r\n   \r\n        Else \r\n\r\n            exclude(rid)\r\n\r\n        End If\r\n               \r\n    End If \r\n\r\nEnd If\r\n\r\n     Return result\r\n      \r\nEnd Function\r\n  \r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":2},{"Name":"P011_NSEN_KS3BE_percent","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim P010_KS3_BESubtotal As Double =  Products.1718_SBS.P010_KS3_BESubtotal      \r\n    Dim P011a_NSEN_KS3BE_percent As Double = Products.1718_SBS.P011a_NSEN_KS3BE_percent / 100            \r\n    Dim P011_NSEN_KS3BE As Double =  P010_KS3_BESubtotal * P011a_NSEN_KS3BE_percent\r\n  \r\n     Print(P010_KS3_BESubtotal,\"P010_KS3_BESubtotal\",rid)\r\n     Print(P011a_NSEN_KS3BE_percent, \"P011a_NSEN_KS3BE_percent\",rid) \r\n                      \r\nIf FundingBasis = \"Place\" Then\r\n \r\n    exclude(rid)\r\n    \r\nElse         \r\n \r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n \r\n        Result = P011_NSEN_KS3BE \r\n \r\n    Else\r\n \r\n        Exclude(rid)\r\n \r\n    End If\r\n\r\nEnd If \r\n         \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P011a_NSEN_KS3BE_Percent","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n      \r\n        Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n        Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n        Dim NSEN_KS3BE_Percent As Double = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_KS3_Notional_SEN)\r\n        Dim P011a_NSEN_KS3BE_Percent As Double = NSEN_KS3BE_Percent * 100    \r\n    \r\n       \r\nIf FundingBasis = \"Place\" Then\r\n     \r\n     exclude(rid)\r\n     \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n     \r\n        Result = P011a_NSEN_KS3BE_Percent\r\n\r\n    Else \r\n\r\n        Exclude(rid)\r\n    \r\n    End If \r\n    \r\nEnd If        \r\n\r\n    Return result\r\n    \r\nEnd Function\r\n\r\n   ","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":0},{"Name":"P012_InYearKS3_BESubtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)    \r\n    Dim P010_KS3_BESubtotal As Double = Products.1718_SBS.P010_KS3_BESubtotal\r\n    Dim Days_Open As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365                     \r\n\r\n        Print(P010_KS3_BESubtotal,\"P010_KS3_BESubtotal\",rid)\r\n        Print(Days_Open,\"Days Open\",rid)\r\n        Print(Year_Days,\"Year Days\",rid)\r\n    \r\nIf FundingBasis = \"Place\" Then\r\n \r\n    exclude(rid)\r\n    \r\nElse     \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n    \r\n        Result = (P010_KS3_BESubtotal) * Days_Open / Year_Days\r\n        \r\n     Else \r\n     \r\n        exclude(rid)\r\n        \r\n    End If \r\n\r\nEnd If\r\n             \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P014_KS4Rate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim P014_KS4Rate As Double = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_KS4_Amount_Per_Pupil)\r\n    \r\nIf FundingBasis = \"Place\"  Then\r\n\r\n    exclude(rid)\r\n    \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n\r\n        result = P014_KS4Rate     \r\n\r\n    Else\r\n\r\n        Exclude(rid)\r\n\r\n    End If\r\n\r\nEnd If \r\n \r\nReturn result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P015_KS4_BESubtotal","Script":"Function GetProductResult(rid As String) As Double\r\n   Dim result = 0\r\n   \r\n            Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n            Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n            Dim P013_KS4Pupils As Double =  Products.1718_NOR.NOR_P24_Total_NOR_KS4_SBS      \r\n            Dim P014_KS4Rate As Double = Products.1718_SBS.P014_KS4Rate               \r\n            Dim P015_KS4_BESubtotal As Double =  (P013_KS4Pupils * P014_KS4Rate)\r\n            Dim P015_KS4_BESubtotalAPT As Double = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Basic_Entitlement_KS4]\r\n  \r\n            Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n            Print(P013_KS4Pupils,\"P013_KS4Pupils\",rid)\r\n            Print(P014_KS4Rate,\"P014_KS4Rate\",rid) \r\n            Print(P015_KS4_BESubtotal, \"P015_KS4_BESubtotal\", rid)\r\n            \r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)\r\n    \r\nElse     \r\n\r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = \"Estimate\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Estimate\")  THEN\r\n     \r\n        Result = P015_KS4_BESubtotal\r\n\r\n    Else\r\n              \r\n        If (F100_AllAcademies = 17182 And FundingBasis = \"Census\") Or (F100_AllAcademies = 17183 And FundingBasis = \"Census\") THEN\r\n\r\n            Result = P015_KS4_BESubtotalAPT\r\n   \r\n        Else \r\n\r\n            exclude(rid)\r\n\r\n        End If\r\n               \r\n    End If \r\n\r\nEnd If \r\n                                    \r\n     Return result\r\n      \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":2},{"Name":"P016_NSEN_KS4BE","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n     \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)   \r\n    Dim P015_KS4_BESubtotal As Double =  Products.1718_SBS.P015_KS4_BESubtotal      \r\n    Dim P016a_NSEN_KS4BE_percent As Double = Products.1718_SBS.P016a_NSEN_KS4BE_percent             \r\n    Dim P016_NSEN_KS4BE As Double =  P015_KS4_BESubtotal * P016a_NSEN_KS4BE_percent\r\n               \r\n     Print(P015_KS4_BESubtotal,\"P015_KS4_BESubtotal\",rid)\r\n     Print(P016a_NSEN_KS4BE_percent, \"P016a_NSEN_KS4BE_percent\",rid) \r\n                      \r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)\r\n    \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n\r\n        Result = P016_NSEN_KS4BE / 100\r\n     \r\n    Else  \r\n\r\n        Exclude(rid) \r\n\r\n    End If\r\n    \r\nEnd If     \r\n     \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P018_InYearKS4_BESubtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim acadfilter As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As String = Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)    \r\n    Dim P015_KS4_BESubtotal As Double = Products.1718_SBS.P015_KS4_BESubtotal\r\n    Dim Days_Open As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365                     \r\n \r\n        Print(P015_KS4_BESubtotal,\"P015_KS4_BESubtotal\",rid)\r\n        Print(Days_Open,\"Days Open\",rid)\r\n        Print(Year_Days,\"Year Days\",rid)\r\n\r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)\r\n    \r\nElse \r\n\r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then\r\n    \r\n        Result = (P015_KS4_BESubtotal) * Days_Open / Year_Days\r\n\r\n    Else\r\n\r\n        Exclude(rid)  \r\n\r\n    End If\r\n\r\nEnd If \r\n        \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":6},{"Name":"P016a_NSEN_KS4BE_Percent","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n      \r\n        Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n        Dim NSEN_KS4BE_Percent As Double = LAtoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Basic_Entitlement_KS4_Notional_SEN)\r\n        Dim P016a_NSEN_KS4BE_Percent As Double = NSEN_KS4BE_Percent *100    \r\n    \r\n       \r\n        If (F200_SBS_Academies = 1 ) Then\r\n             Result = P016a_NSEN_KS4BE_Percent\r\n\r\n        Else \r\n        Exclude(rid)\r\n        End if\r\n        \r\n        Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n        Print(NSEN_KS4BE_Percent, \"NSEN_KS4BE_Percent\", rid)\r\n        Print(P016a_NSEN_KS4BE_Percent, \"P016a_NSEN_KS4BE_Percent\", rid)\r\n\r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":0},{"Name":"P005 Test","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n                                \r\n            Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n            Dim F200_SBSAcademies As Double = Products.1718_Global_Variables.F200_SBS_Academies            \r\n            Dim F900_FundingBasis As decimal = Products.1718_Global_Variables.F900_FundingBasis\r\n            Dim PrimaryPupils As Double =  Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS      \r\n            Dim P004_PriRate As Double = [Products.1718_SBS.P004_PriRate]                  \r\n            Dim P005_Pri_BESubtotal As Double =  ([PrimaryPupils] * [P004_PriRate])\r\n            Dim P005_Pri_BESubtotalAPT As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Basic_Entitlement_Primary] \r\n  \r\n            Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n            Print(F900_FundingBasis, \"F900_FundingBasis\", rid)\r\n            Print(PrimaryPupils,\"PrimaryPupils\",rid)\r\n            Print(P004_PriRate,\"P004_PriRate\",rid) \r\n            Print(P005_Pri_BESubtotal,\"P005_Pri_BESubtotal\",rid) \r\n            \r\n            If F200_SBSAcademies = 1 then\r\n\r\n             'If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2) THEN\r\n                 'Result = P005_Pri_BESubtotal\r\n            \r\n                 If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2) THEN\r\n                 Result = P005_Pri_BESubtotal\r\n            \r\n            Else\r\n                          \r\n               If (F100_AllAcademies = 17182 And F900_FundingBasis = 1) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 1)  THEN\r\n                    \r\n                'Print(P005_Pri_BESubtotalAPT,\"P005_Pri_BESubtotalAPT\",rid)\r\n\r\n                Result = P005_Pri_BESubtotalAPT\r\n               \r\n                Else \r\n     \r\n                'exclude(rid)\r\n     \r\n                End If\r\n                           \r\n            End if\r\n            \r\n            else\r\n            \r\n            exclude(rid)\r\n            \r\n            End If\r\n     \r\n                    \r\n     Return result\r\n      \r\nEnd Function\r\n  \r\n\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n                 ","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Basic Entitlement","DecimalPlaces":0},{"Name":"P019_PriFSMFactor","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FSMCensus As Double = DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Primary_FSM_Proportion\r\n    Dim FSMAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_FSM_Proportion\r\n    Dim FSMAdjString as string = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_FSM_Proportion\r\n    Dim FSMPriCensusString as string  = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Primary_FSM_Proportion\r\n    Dim LA_AV As Double = latoprov(Datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Primary_FSM_Proportion)\r\n\r\n        If (F200_SBS_Academies = 1) Then\r\n\r\n        Print(LA_AV,\"LA average\", rid)\r\n        Print(FSMCensus, \"FSMPri Census\", rid)\r\n        Print(FSMAdj, \"FSM Pri Adjusted\", rid)  \r\n\r\n            If string.IsNullOrEmpty(FSMPriCensusString) And string.IsNullOrEmpty(FSMAdjString) THEN \r\n                   Result = LA_AV\r\n        \r\n            Elseif string.IsNullOrEmpty(FSMAdjString) then\r\n                   Result = FSMCensus\r\n  \r\n            Else\r\n                \r\n                  Result = FSMAdj\r\n            \r\n            End if\r\n        \r\n        else\r\n            \r\n            exclude(rid)\r\n            \r\n        End If \r\n        \r\n     Return result\r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P021_PriFSMRate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n     \r\n        If (F200_SBS_Academies = 1) Then\r\n        \r\n        Dim P021_PriFSMRate As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_Amount_Per_Pupil) \r\n        Dim LAMethod as string = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_FSM/FSM6)\r\n        \r\n        Print(P021_PriFSMRate,\"Pri FSM Per Pupil\",rid)     \r\n        Print(LAMethod, \"FSM/FSM6?\", rid)\r\n    \r\n            If LAMethod = \"FSM % Primary\" then\r\n            \r\n                Result = P021_PriFSMRate\r\n   \r\n            Else\r\n   \r\n                Result = 0\r\n\r\n            end if\r\n\r\n        Else \r\n            \r\n            exclude(rid)\r\n            \r\n        End if    \r\n       \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P022_PriFSMSubtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis  \r\n    Dim P22_Total_NOR_Pri_SBS As Double = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P021_PriFSMRate As Double =   Products.1718_SBS.P021_PriFSMRate\r\n    Dim P019_PriFSMFactor As Double = Products.1718_SBS.P019_PriFSMFactor \r\n    Dim P022_PriFSMSubtotal As Double =  P22_Total_NOR_Pri_SBS * P021_PriFSMRate * P019_PriFSMFactor\r\n    Dim FSMSelectedbyLA As String = LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_FSM/FSM6)    \r\n    Dim P022_PriFSMSubtotalAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Free_School_Meals_Primary]\r\n   \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P22_Total_NOR_Pri_SBS,\"P22_Total_NOR_Pri_SBS\",rid)\r\n    Print(P021_PriFSMRate,\"P021_PriFSMRate\",rid)\r\n    Print(P019_PriFSMFactor,\"P019_PriFSMFactor\",rid)    \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n        \r\n    exclude(rid)\r\n    \r\n    Else\r\n\r\n    If (F100_AllAcademies = 17181) Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2)Then\r\n            Result = P022_PriFSMSubtotal \r\n        \r\n    Else \r\n\r\n    If  (F100_AllAcademies = 17182 And F900_FundingBasis = 1) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 1)Then\r\n                                            \r\n        If FSMSelectedbyLA = \"FSM % Primary\" Then\r\n           Result = P022_PriFSMSubtotalAPT\r\n           \r\n        End If    \r\n       \r\n          \r\n     Else\r\n                            \r\n     End If    \r\n     \r\n      Exclude(rid)\r\n                    \r\n      End If\r\n  \r\n      End If\r\n         \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":2},{"Name":"P023_InYearPriFSMSubtotal","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P022_PriFSMSubtotal As Double = Products.1718_SBS.P022_PriFSMSubtotal\r\n    Dim P001_1718DaysOpen As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365\r\n    \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\",rid)                          \r\n    Print(Year_Days, \"Year_Days\",rid)                           \r\n \r\n           \r\n     If F200_SBS_Academies = 1 Then\r\n        Result = (P022_PriFSMSubtotal) * P001_1718DaysOpen / Year_Days\r\n    \r\n        Else \r\n        \r\n        Exclude(rid)\r\n        \r\n        End If  \r\n       \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P024_PriFSM6Factor","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim FSM6Census As Double = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Primary_Ever_6_Proportion\r\n    Dim FSM6Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_Ever_6_Proportion\r\n    Dim FSM6AdjString as string = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_Ever_6_Proportion\r\n    Dim FSM6PriCensusString as string  = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Primary_Ever_6_Proportion\r\n    Dim LA_AV As Double = latoprov(Datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Primary_Ever_6_Proportion)\r\n\r\n     \r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(LA_AV,\"LA average\", rid)\r\n    Print(FSM6Census, \"FSM6 Pri Census\", rid)\r\n    Print(FSM6Adj, \"FSM6 Pri Adjusted\", rid)  \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n     \r\n        If F200_SBS_Academies = 1 Then\r\n        \r\n            If string.IsNullOrEmpty(FSM6PriCensusString) And string.IsNullOrEmpty(FSM6AdjString) Then\r\n                  Result = LA_AV\r\n                \r\n            Else\r\n                                                      \r\n                If string.IsNullOrEmpty(FSM6AdjString) Then\r\n                      Result = FSM6Census\r\n          \r\n                Else\r\n    \r\n                  Result = FSM6Adj\r\n    \r\n                End if\r\n                \r\n            End if\r\n            \r\n        Else\r\n          \r\n           Exclude(rid)\r\n           \r\n        End If\r\n        \r\n    End If\r\n    \r\n    Return result    \r\n    \r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P026_PriFSM6Rate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P026_PriFSM6Rate As Double = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_Amount_Per_Pupil)\r\n    Dim LAMethod as string = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_FSM/FSM6)\r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P026_PriFSM6Rate,\"Pri FSM6 Per Pupil\",rid)     \r\n    Print(LAMethod, \"FSM/FSM6?\", rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If F200_SBS_Academies = 1 Then\r\n       \r\n       \r\n            If LAMethod = \"FSM6 % Primary\" then\r\n   \r\n                Result = P026_PriFSM6Rate\r\n   \r\n            Else\r\n   \r\n                Result = 0\r\n\r\n            End if\r\n\r\n        Else \r\n            \r\n            exclude(rid)\r\n            \r\n        End if    \r\n            \r\n      End If\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P027_PriFSM6Subtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis  \r\n    Dim P22_Total_NOR_Pri_SBS As Double = Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P026_PriFSM6Rate As Double =   Products.1718_SBS.P026_PriFSM6Rate\r\n    Dim P024_PriFSM6Factor As Double = Products.1718_SBS.P024_PriFSM6Factor \r\n    Dim P027_PriFSM6Subtotal As Double =  P22_Total_NOR_Pri_SBS * P026_PriFSM6Rate * P024_PriFSM6Factor\r\n    Dim FSM6SelectedbyLA As String = LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_FSM/FSM6)    \r\n    Dim P027_PriFSM6SubtotalAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Free_School_Meals_Primary]\r\n   \r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P22_Total_NOR_Pri_SBS,\"P22_Total_NOR_Pri_SBS\",rid)\r\n    Print(P026_PriFSM6Rate,\"P026_PriFSM6Rate\",rid)\r\n    Print(P024_PriFSM6Factor,\"P024_PriFSM6Factor\",rid)    \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n        exclude(rid)\r\n    Else\r\n         If (F100_AllAcademies = 17181) Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2) Then\r\n             Result = P027_PriFSM6Subtotal \r\n         Else \r\n             If  (F100_AllAcademies = 17182 And F900_FundingBasis = 1) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2) Then\r\n                If FSM6SelectedbyLA = \"FSM6 % Primary\" Then\r\n                    Result = P027_PriFSM6SubtotalAPT\r\n                End If    \r\n             Else\r\n             End If    \r\n         Exclude(rid)\r\n    End If\r\n End If\r\n Return result\r\n    \r\nEnd Function ","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":2},{"Name":"P028_NSENFSMPri","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim PriFSMSubtotal As Double = Products.1718_SBS.P022_PriFSMSubtotal   \r\n    Dim PriFSM6Subtotal As Double = Products.1718_SBS.P027_PriFSM6Subtotal   \r\n    Dim FSM_Pri_SEN As Double = Products.1718_SBS.P028a_NSENFSMPri_Percent / 100\r\n    Dim NSENFSMPri As Double = (PriFSMSubtotal + PriFSM6Subtotal) * FSM_Pri_SEN\r\n    \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"FundingBasis\",rid)\r\n    Print(PriFSMSubtotal,\"P022_PriFSMSubtotal\",rid)\r\n    Print(PriFSM6Subtotal,\"P027_PriFSM6Subtotal\",rid)    \r\n    Print(FSM_Pri_SEN,\"FSM_Pri_SEN\",rid)   \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If F200_SBS_Academies = 1 Then\r\n                Result = NSENFSMPri\r\n        \r\n        else\r\n        \r\n        exclude(rid)\r\n\r\n        End If \r\n\r\n    End If\r\n \r\n    \r\n    Return result\r\n\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P028a_NSENFSMPri_Percent","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim FSM_Pri_SEN As Double =  LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Primary_Notional_SEN)   \r\n    Dim NSENFSMPri_Percent As Double = FSM_Pri_SEN  \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n  \r\n        If F200_SBS_Academies = 1 Then\r\n            Result = NSENFSMPri_Percent * 100\r\n        \r\n        else\r\n        \r\n            exclude(rid)\r\n\r\n        End If \r\n        \r\n    End If\r\n    \r\n    Return result\r\n\r\nEnd Function\r\n     \r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":0},{"Name":"P029_InYearPriFSM6Subtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P027_PriFSM6Subtotal As Double = Products.1718_SBS.P027_PriFSM6Subtotal\r\n    Dim P001_1718DaysOpen As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365\r\n        \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\",rid)                          \r\n    Print(Year_Days, \"Year_Days\",rid)                           \r\n \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n\r\n        If F200_SBS_Academies = 1 Then\r\n        \r\n             Result = (P027_PriFSM6Subtotal) * P001_1718DaysOpen / Year_Days\r\n    \r\n        Else \r\n        \r\n        Exclude(rid)\r\n        \r\n        End If  \r\n        \r\n    End If\r\n     \r\n    Return result\r\n    \r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P030_SecFSMFactor","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim FSMCensus As Double = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Secondary_FSM_Proportion\r\n    Dim FSMAdj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_FSM_Proportion\r\n    Dim FSMAdjString as string = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_FSM_Proportion\r\n    Dim FSMCensusCensusString as string  = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Secondary_FSM_Proportion\r\n    Dim LA_AV As Double = latoprov(Datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Secondary_FSM_Proportion)\r\n\r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(LA_AV, \"LA average\", rid)\r\n    Print(FSMCensus, \"FSM Sec Census\", rid)\r\n    Print(FSMAdj, \"FSMAdj\", rid) \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n        \r\n        If F200_SBS_Academies = 1 Then     \r\n      \r\n  \r\n            If string.IsNullOrEmpty(FSMCensusCensusString) And string.IsNullOrEmpty(FSMAdjString) Then \r\n                \r\n                 Result = LA_AV\r\n                \r\n            ElseIf string.IsNullOrEmpty(FSMAdjString) Then\r\n                        \r\n                 result = FSMCensus\r\n          \r\n            else\r\n        \r\n                 result = FSMAdj\r\n                        \r\n            End if\r\n                    \r\n        else\r\n        \r\n        exclude(rid)\r\n        \r\n        End if\r\n        \r\n    End If\r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P032_SecFSMRate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P032_SecFSMRate As Double = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_Amount_Per_Pupil)\r\n    Dim LAMethod as string = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_FSM/FSM6)\r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P032_SecFSMRate,\"Sec FSM Per Pupil\",rid)     \r\n    Print(LAMethod, \"FSM/FSM6?\", rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If F200_SBS_Academies = 1 Then\r\n       \r\n            If LAMethod = \"FSM % Secondary\" then\r\n   \r\n              Result = P032_SecFSMRate\r\n   \r\n          Else\r\n   \r\n              Result = 0\r\n\r\n           End if\r\n\r\n           Else \r\n            \r\n           Exclude(rid)\r\n            \r\n           End if    \r\n            \r\n      End If\r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P033_SecFSMSubtotal","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P25_TotalNORSecSBS As Double = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P032_SecFSMRate As Double =   Products.1718_SBS.P032_SecFSMRate\r\n    Dim P030_SecFSMFactor As Double = Products.1718_SBS.P030_SecFSMFactor \r\n    Dim P033_SecFSMSubtotal As Double =  P25_TotalNORSecSBS * P032_SecFSMRate * P030_SecFSMFactor\r\n    Dim P001_1718DaysOpen As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim FSMSelectedbyLA As String = LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_FSM/FSM6)\r\n    Dim P033_SecFSMSubtotalAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Free_School_Meals_Secondary]\r\n                            \r\n               \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P25_TotalNORSecSBS,\"P25_TotalNORSecSBS\",rid)\r\n    Print(P032_SecFSMRate,\"P032_SecFSMRate\",rid)\r\n    Print(P030_SecFSMFactor,\"P030_SecFSMFactor\",rid) \r\n    Print(FSMSelectedbyLA,\"FSMSelectedbyLA\",rid)\r\n    Print(P033_SecFSMSubtotalAPT,\"P033_SecFSMSubtotalAPT\",rid)\r\n  \r\n    If F900_FundingBasis = 3 Then\r\n        \r\n        Exclude(rid)\r\n    \r\n    Else\r\n                   \r\n    End if\r\n        \r\n           \r\n     If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2)   Then\r\n\r\n        Result = P033_SecFSMSubtotal \r\n        \r\n     Else                                                                     \r\n  \r\n        If (F100_AllAcademies = 17182 And F900_FundingBasis = 1) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 1) Then\r\n      \r\n            If FSMSelectedbyLA = \"FSM % Secondary\" Then\r\n                                 \r\n                Result = P033_SecFSMSubtotalAPT\r\n                            \r\n            Else\r\n                            \r\n                Result = 0\r\n                            \r\n            End If\r\n      \r\n        Else \r\n                    \r\n        Exclude(rid)\r\n                    \r\n        End If\r\n  \r\n      End if\r\n            \r\n       \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":2},{"Name":"P034_InYearSecFSMSubtotal","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P033_SecFSMSubtotal As Double = Products.1718_SBS.P033_SecFSMSubtotal\r\n    Dim P001_1718DaysOpen As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365\r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P001_1718DaysOpen, \"Days_Open\",rid)                          \r\n    Print(Year_Days, \"Year_Days\",rid)       \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n\r\n        If F200_SBS_Academies = 1 Then\r\n                                         \r\n           Result = (P033_SecFSMSubtotal) * P001_1718DaysOpen / Year_Days\r\n    \r\n        Else \r\n        \r\n        Exclude(rid)\r\n        \r\n        End If  \r\n        \r\n    End If\r\n     \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P035_SecFSM6Factor","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim FSM6Census As Double = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Secondary_Ever_6_Proportion\r\n    Dim FSM6Adj As Double = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_Ever_6_Proportion\r\n    Dim FSM6AdjString as string = Datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_Ever_6_Proportion\r\n    Dim FSM6SecCensusString as string  = Datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Secondary_Ever_6_Proportion  \r\n    Dim LA_AV As Double = latoprov(Datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Secondary_Ever_6_Proportion)\r\n\r\n    Print(LA_AV,\"LA average\", rid)\r\n    Print(FSM6Census, \"FSM6 Sec Census\", rid)\r\n    Print(FSM6Adj, \"FSM6 Sec Adjusted\", rid)  \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    Exclude(rid) \r\n    \r\n    Else\r\n     \r\n        If F200_SBS_Academies = 1 Then\r\n        \r\n            If string.IsNullOrEmpty(FSM6SecCensusString) And string.IsNullOrEmpty(FSM6AdjString) Then\r\n            \r\n               Result = LA_AV\r\n            \r\n            Else\r\n                                                      \r\n                If string.IsNullOrEmpty(FSM6AdjString) Then\r\n                    \r\n                  Result = FSM6Census\r\n      \r\n                Else\r\n    \r\n                  Result = FSM6Adj\r\n    \r\n                End if\r\n                \r\n            End if\r\n            \r\n        Else\r\n            \r\n            Exclude(rid)\r\n            \r\n        End If\r\n        \r\n    End If\r\n    \r\n    Return result    \r\n    \r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P037_SecFSM6Rate","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P037_SecFSM6Rate As Double = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_Amount_Per_Pupil)\r\n    Dim LAMethod as string = LAtoProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_FSM/FSM6)\r\n    \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    Print(P037_SecFSM6Rate,\"Sec FSM6 Per Pupil\",rid)     \r\n    Print(LAMethod, \"FSM/FSM6?\", rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If F200_SBS_Academies = 1 Then\r\n       \r\n            If LAMethod = \"FSM6 % Secondary\" Then\r\n   \r\n            Result = P037_SecFSM6Rate\r\n   \r\n            Else\r\n   \r\n            Result = 0\r\n\r\n            End if\r\n\r\n            Else \r\n            \r\n            Exclude(rid)\r\n            \r\n            End if    \r\n            \r\n      End If\r\n    \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P038_SecFSM6Subtotal","Script":"         Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P25_Total_NOR_Sec_SBS As Double = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P037_SecFSM6Rate As Double =   Products.1718_SBS.P037_SecFSM6Rate\r\n    Dim P035_SecFSM6Factor As Double = Products.1718_SBS.P035_SecFSM6Factor\r\n    Dim P038_SecFSM6Subtotal As Double =  P25_Total_NOR_Sec_SBS * P037_SecFSM6Rate * P035_SecFSM6Factor\r\n    Dim FSMSelectedbyLA As String = LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_FSM/FSM6)                        \r\n    Dim P038_SecFSM6SubtotalAPT As Double = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Free_School_Meals_Secondary] \r\n                            \r\n    Print(P038_SecFSM6SubtotalAPT,\"P038_SecFSM6SubtotalAPT\",rid)\r\n    Print(FSMSelectedbyLA,\"FSMSelectedbyLA\",rid)\r\n    Print(P25_Total_NOR_Sec_SBS ,\"P25_Total_NOR_Sec_SBS\",rid)\r\n    Print(P037_SecFSM6Rate ,\"P037_SecFSM6Rate\",rid)\r\n    Print(P035_SecFSM6Factor,\"P035_SecFSM6Factor\",rid)                \r\n    Print(F100_AllAcademies, \"F100_AllAcademies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    \r\n         If F900_FundingBasis = 3 Then\r\n    \r\n    Exclude(rid) \r\n    \r\n    Else\r\n               \r\n    End if\r\n            \r\n         If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And F900_FundingBasis = 2) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 2)   Then\r\n\r\n           Result = P038_SecFSM6Subtotal \r\n        \r\n     Else\r\n \r\n         If  (F100_AllAcademies = 17182 And F900_FundingBasis = 1) Or (F100_AllAcademies = 17183 And F900_FundingBasis = 1) Then\r\n                    \r\n                                   \r\n              If FSMSelectedbyLA = \"FSM6 % Secondary\" Then\r\n                        \r\n                       \r\n                    Result = P038_SecFSM6SubtotalAPT\r\n                    \r\n               Else\r\n                    \r\n                    Result = 0\r\n                    \r\n               End If\r\n                        \r\n          Else \r\n                    \r\n                exclude(rid)\r\n                    \r\n          End If  \r\n                    \r\n       End if\r\n                     \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":2},{"Name":"P039_NSENFSMSec","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim SecFSMSubtotal As Double = Products.1718_SBS.P033_SecFSMSubtotal   \r\n    Dim SecFSM6Subtotal As Double = Products.1718_SBS.P038_SecFSM6Subtotal   \r\n    Dim FSM_Sec_SEN As Double = products.1718_SBS.P039a_NSENFSMSec_Percent / 100\r\n    Dim NSENFSMSec As Double = (SecFSMSubtotal + SecFSM6Subtotal) * FSM_Sec_SEN\r\n    \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"FundingBasis\",rid)\r\n    Print(SecFSMSubtotal,\"P033_SecFSMSubtotal\",rid)\r\n    Print(SecFSM6Subtotal,\"P038_SecFSM6Subtotal\",rid)    \r\n    Print(FSM_Sec_SEN,\"FSM_Sec_SEN\",rid)   \r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    exclude(rid) \r\n    \r\n    Else\r\n    \r\n        If F200_SBS_Academies = 1 Then\r\n                Result = NSENFSMSec\r\n        \r\n        else\r\n        \r\n        exclude(rid)\r\n\r\n        End If \r\n\r\n    End If\r\n \r\n    \r\n    Return result\r\n\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P039a_NSENFSMSec_Percent","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim FSM_Sec_SEN As Double =  LaToProv(Datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.FSM_Secondary_Notional_SEN)   \r\n    Dim NSENFSMSec_Percent As Double = FSM_Sec_SEN * 100 \r\n    \r\n     \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    Exclude(rid) \r\n    \r\n    Else\r\n  \r\n        If F200_SBS_Academies = 1 Then\r\n            \r\n            Result = NSENFSMSec_Percent \r\n        \r\n        else\r\n        \r\n        exclude(rid)\r\n\r\n        End If \r\n        \r\n    End If\r\n    \r\n    Return result\r\n\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":0},{"Name":"P040_InYearSecFSM6Subtotal","Script":" Public Function GetProductResult(rid As String) As Double\r\n    Dim result = 0\r\n    \r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim F900_FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P038_SecFSM6Subtotal As Double = Products.1718_SBS.P038_SecFSM6Subtotal\r\n    Dim P001_1718DaysOpen As Double = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double = 365\r\n        \r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\",rid)                          \r\n    Print(Year_Days, \"Year_Days\",rid)                    \r\n    Print(F200_SBS_Academies,\"F200_SBS_Academies\",rid)\r\n    Print(F900_FundingBasis,\"F900_FundingBasis\",rid)\r\n    \r\n    If F900_FundingBasis = 3 Then\r\n    \r\n    Exclude(rid) \r\n    \r\n    Else\r\n\r\n        If F200_SBS_Academies = 1 Then\r\n\r\n              Result = (P038_SecFSM6Subtotal) * P001_1718DaysOpen / Year_Days\r\n    \r\n        Else \r\n        \r\n        Exclude(rid)\r\n        \r\n        End If  \r\n        \r\n    End If\r\n     \r\n    Return result\r\n    \r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FSM","DecimalPlaces":6},{"Name":"P041_IDACIFPriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_F]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_F]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_F] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_F]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_F] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_F])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACIFPriAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_F\r\n    Dim IDACIFPriCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_F\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIFPriAdjString) And string.IsNullOrEmpty(IDACIFPriCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_F] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIFPriAdjString) Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_F]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_F]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_F, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_F\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_F, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_F\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_F, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_F\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P043_IDACIFPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BF_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P044_IDACIFPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P043_IDACIFPriRate As Decimal = products.1718_SBS.P043_IDACIFPriRate\r\n    Dim P041_IDACIFPriFactor As Decimal = products.1718_SBS.P041_IDACIFPriFactor\r\n    Dim APT_ISB_IDACIF_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_F)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter =1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P22*P043_IDACIFPriRate*P041_IDACIFPriFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIF_Primary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P043_IDACIFPriRate, \"P043_IDACIFPriRate\", rid)\r\n    Print(P041_IDACIFPriFactor, \"P041_IDACIFPriFactor\", rid)\r\n    Print(APT_ISB_IDACIF_Primary, \"APT_ISB_IDACIF_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P045_NSENIDACIFPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P044_IDACIFPriSubtotal As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P045a_NSENIDACIFPri_Percent As Decimal = products.1718_SBS.P045a_NSENIDACIFPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P044_IDACIFPriSubtotal*P045a_NSENIDACIFPri_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P044_IDACIFPriSubtotal, \"P044_IDACIFPriSubtotal\", rid)\r\n    Print(P045a_NSENIDACIFPri_Percent,\"P045a_NSENIDACIFPri_Percent\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P045a_NSENIDACIFPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BF_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN  * 100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P046_InYearIDACIFPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P044_IDACIFPriSubtotal As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P044_IDACIFPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P044_IDACIFPriSubtotal, \"P044_IDACIFPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P047_IDACIEPriFactor","Script":"      Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_E]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_E]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_E] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_E]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_E] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_E])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACIEPriAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_E\r\n    Dim IDACIEPriCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_E\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIEPriAdjString) And string.IsNullOrEmpty(IDACIEPriCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_E] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIEPriAdjString) Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_E]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_E]   \r\n            End if\r\n        End if    \r\n    Else\r\n    exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_E, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_E\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_E, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_E\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_E, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_E\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P049_IDACIEPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BE_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P050_IDACIEPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P049_IDACIEPriRate As Decimal = products.1718_SBS.P049_IDACIEPriRate\r\n    Dim P047_IDACIEPriFactor As Decimal = products.1718_SBS.P047_IDACIEPriFactor\r\n    Dim APT_ISB_IDACIE_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_E)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P22*P049_IDACIEPriRate*P047_IDACIEPriFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n                result = APT_ISB_IDACIE_Primary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P049_IDACIEPriRate, \"P049_IDACIEPriRate\", rid)\r\n    Print(P047_IDACIEPriFactor, \"P047_IDACIEPriFactor\", rid)\r\n    Print(APT_ISB_IDACIE_Primary, \"APT_ISB_IDACIE_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P051_NSENIDACIEPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P050_IDACIEPriSubtotal As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P051a_NSENIDACIEPri_Percent As Decimal = products.1718_SBS.P051a_NSENIDACIEPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P050_IDACIEPriSubtotal*P051a_NSENIDACIEPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P050_IDACIEPriSubtotal, \"P050_IDACIEPriSubtotal\", rid)\r\n    Print(P051a_NSENIDACIEPri_Percent,\"P051a_NSENIDACIEPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P052_InYearIDACIEPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P050_IDACIEPriSubtotal As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P050_IDACIEPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P050_IDACIEPriSubtotal, \"P050_IDACIEPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P051a_NSENIDACIEPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BE_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN  * 100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P053_IDACIDPriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_D]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_D]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_D] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_D]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_D] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_D])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACIDPriAdjString as string = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_D]\r\n    Dim IDACIDPriCensusString as string  = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_D]\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIDPriAdjString) And string.IsNullOrEmpty(IDACIDPriCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_D] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIDPriAdjString) Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_D]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_D]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_D, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_D\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_D, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_D\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_D, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_D\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P055_IDACIDPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BD_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P056_IDACIDPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P055_IDACIDPriRate As Decimal = products.1718_SBS.P055_IDACIDPriRate\r\n    Dim P053_IDACIDPriFactor As Decimal = products.1718_SBS.P053_IDACIDPriFactor\r\n    Dim APT_ISB_IDACID_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_D)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then\r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then  \r\n                result = SBS_P22 * P055_IDACIDPriRate * P053_IDACIDPriFactor\r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis =  1 Then\r\n            If  P055_IDACIDPriRate > 0 then\r\n                result = APT_ISB_IDACID_Primary\r\n            else\r\n                result = 0\r\n            End if \r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P055_IDACIDPriRate, \"P055_IDACIDPriRate\", rid)\r\n    Print(P053_IDACIDPriFactor, \"P053_IDACIDPriFactor\", rid)\r\n    Print(APT_ISB_IDACID_Primary, \"APT_ISB_IDACID_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P057_NSENIDACIDPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P056_IDACIDPriSubtotal As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P057a_NSENIDACIDPri_Percent As Decimal = products.1718_SBS.P057a_NSENIDACIDPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P056_IDACIDPriSubtotal*P057a_NSENIDACIDPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P056_IDACIDPriSubtotal, \"P056_IDACIDPriSubtotal\", rid)\r\n    Print(P057a_NSENIDACIDPri_Percent,\"P057a_NSENIDACIDPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P057a_NSENIDACIDPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BD_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P058_InYearIDACIDPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P056_IDACIDPriSubtotal As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P056_IDACIDPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P056_IDACIDPriSubtotal, \"P056_IDACIDPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P059_IDACICPriFactor","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_C]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_C]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_C] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_C]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_C] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_C])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACICPriAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_C\r\n    Dim IDACICPriCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_C\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACICPriAdjString) And string.IsNullOrEmpty(IDACICPriCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_C] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACICPriAdjString) Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_C]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_C]   \r\n            End if\r\n        End if    \r\n    Else\r\n    exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_C, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_C\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_C, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_C\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_C, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_C\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P061_IDACICPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BC_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P062_IDACICPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P061_IDACICPriRate As Decimal = products.1718_SBS.P061_IDACICPriRate\r\n    Dim P059_IDACICPriFactor As Decimal = products.1718_SBS.P059_IDACICPriFactor\r\n    Dim APT_ISB_IDACIC_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_C)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P22*P061_IDACICPriRate*P059_IDACICPriFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIC_Primary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P061_IDACICPriRate, \"P061_IDACICPriRate\", rid)\r\n    Print(P059_IDACICPriFactor, \"P059_IDACICPriFactor\", rid)\r\n    Print(APT_ISB_IDACIC_Primary, \"APT_ISB_IDACIC_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P063_NSENIDACICPri","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P062_IDACICPriSubtotal As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P063a_NSENIDACICPri_Percent As Decimal = products.1718_SBS.P063a_NSENIDACICPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P062_IDACICPriSubtotal*P063a_NSENIDACICPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P062_IDACICPriSubtotal, \"P062_IDACICPriSubtotal\", rid)\r\n    Print(P063a_NSENIDACICPri_Percent,\"P063a_NSENIDACICPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P063a_NSENIDACICPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BC_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN  *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P064_InYearIDACICPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P062_IDACICPriSubtotal As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P062_IDACICPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P062_IDACICPriSubtotal, \"P062_IDACICPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P065_IDACIBPriFactor","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_B]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_B]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_B] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_B]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_B] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_B])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACIBPriAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_C\r\n    Dim IDACIBPriCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_C\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIBPriAdjString) And string.IsNullOrEmpty(IDACIBPriCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_B] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIBPriAdjString) Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_B]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_B]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_B, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_B\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_B, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_B\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_B, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_B\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P067_IDACIBPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BB_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P068_IDACIBPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P067_IDACIBPriRate As Decimal = products.1718_SBS.P067_IDACIBPriRate\r\n    Dim P065_IDACIBPriFactor As Decimal = products.1718_SBS.P065_IDACIBPriFactor\r\n    Dim APT_ISB_IDACIB_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_B)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P22*P067_IDACIBPriRate*P065_IDACIBPriFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIB_Primary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P067_IDACIBPriRate, \"P067_IDACIBPriRate\", rid)\r\n    Print(P065_IDACIBPriFactor, \"P065_IDACIBPriFactor\", rid)\r\n    Print(APT_ISB_IDACIB_Primary, \"APT_ISB_IDACIB_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P069_NSENIDACIBPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P068_IDACIBPriSubtotal As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P069a_NSENIDACIBPri_Percent As Decimal = products.1718_SBS.P069a_NSENIDACIBPri_Percent  /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P068_IDACIBPriSubtotal*P069a_NSENIDACIBPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P068_IDACIBPriSubtotal, \"P068_IDACIBPriSubtotal\", rid)\r\n    Print(P069a_NSENIDACIBPri_Percent,\"P069a_NSENIDACIBPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P069a_NSENIDACIBPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BB_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN  *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P070_InYearIDACIBPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P068_IDACIBPriSubtotal As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P068_IDACIBPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P068_IDACIBPriSubtotal, \"P068_IDACIBPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P071_IDACIAPriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_A]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_A]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_A] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_A]\r\n    Dim [Local_Authority_Averages_IDACI_Primary_Proportion_Band_A] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Primary_Proportion_Band_A])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim IDACIAPriAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Primary_Proportion_Band_A\r\n    Dim IDACIAPriCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Primary_Proportion_Band_A\r\n\r\n    \r\n    If AcadFilter = 1 Then\r\n    If string.IsNullOrEmpty(IDACIAPriAdjString) And string.IsNullOrEmpty(IDACIAPriCensusString) Then\r\n    result = [Local_Authority_Averages_IDACI_Primary_Proportion_Band_A] \r\n    Else\r\n    If string.IsNullOrEmpty(IDACIAPriAdjString) Then\r\n    result = [Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_A]\r\n    Else\r\n    result = [APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_A]   \r\n    End if\r\n    End if    \r\n    Else\r\n    exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_A, \"Census_Pupil_Characteristics_IDACI_Primary_Proportion_Band_A\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_A, \"APT_Inputs_and_Adjustments_IDACI_Primary_Proportion_Band_A\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Primary_Proportion_Band_A, \"Local_Authority_Averages_IDACI_Primary_Proportion_Band_A\", rid) \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P073_IDACIAPriRate","Script":"   Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Primary_BA_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P074_IDACIAPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P073_IDACIAPriRate As Decimal = products.1718_SBS.P073_IDACIAPriRate\r\n    Dim P071_IDACIAPriFactor As Decimal = products.1718_SBS.P071_IDACIAPriFactor\r\n    Dim APT_ISB_IDACIA_Primary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(P_A)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter =1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P22*P073_IDACIAPriRate*P071_IDACIAPriFactor \r\n        ElseIf F100_AllAcademies <> 16171 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIA_Primary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P073_IDACIAPriRate, \"P073_IDACIAPriRate\", rid)\r\n    Print(P071_IDACIAPriFactor, \"P071_IDACIAPriFactor\", rid)\r\n    Print(APT_ISB_IDACIA_Primary, \"APT_ISB_IDACIA_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P075_NSENIDACIAPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P074_IDACIAPriSubtotal As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P075a_NSENIDACIAPri_Percent As Decimal = products.1718_SBS.P075a_NSENIDACIAPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P074_IDACIAPriSubtotal*P075a_NSENIDACIAPri_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P074_IDACIAPriSubtotal, \"P074_IDACIAPriSubtotal\", rid)\r\n    Print(P075a_NSENIDACIAPri_Percent,\"P075a_NSENIDACIAPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P075a_NSENIDACIAPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BA_Primary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P076_InYearIDACIAPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P074_IDACIAPriSubtotal As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P074_IDACIAPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P074_IDACIAPriSubtotal, \"P074_IDACIAPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P077_IDACIFSecFactor","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_F]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_F]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_F] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_F]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_F] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_F])\r\n    Dim IDACIFSecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_F\r\n    Dim IDACIFSecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_F\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIFSecAdjString) And string.IsNullOrEmpty(IDACIFSecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_F] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIFSecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_F]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_F]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_F, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_F\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_F, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_F\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_F, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_F\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P079_IDACIFSecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BF_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P080_IDACIFSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P079_IDACIFSecRate As Decimal = products.1718_SBS.P079_IDACIFSecRate\r\n    Dim P077_IDACIFSecFactor As Decimal = products.1718_SBS.P077_IDACIFSecFactor\r\n    Dim APT_ISB_IDACIF_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_F)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P25*P079_IDACIFSecRate*P077_IDACIFSecFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIF_Secondary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P079_IDACIFSecRate, \"P079_IDACIFSecRate\", rid)\r\n    Print(P077_IDACIFSecFactor, \"P077_IDACIFSecFactor\", rid)\r\n    Print(APT_ISB_IDACIF_Secondary, \"APT_ISB_IDACIF_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P081_NSENIDACIFSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P080_IDACIFSecSubtotal As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P081a_NSENIDACIFSec_Percent As Decimal = products.1718_SBS.P081a_NSENIDACIFSec_Percent  /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P080_IDACIFSecSubtotal*P081a_NSENIDACIFSec_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P080_IDACIFSecSubtotal, \"P080_IDACIFSecSubtotal\", rid)\r\n    Print(P081a_NSENIDACIFSec_Percent,\"P081a_NSENIDACIFSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P081a_NSENIDACIFSec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BF_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN  *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P082_InYearIDACIFSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P080_IDACIFSecSubtotal As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P080_IDACIFSecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P080_IDACIFSecSubtotal, \"P080_IDACIFSecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P083_IDACIESecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_E]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_E]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_E] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_E]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_E] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_E])\r\n    Dim IDACIESecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_E\r\n    Dim IDACIESecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_E\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIESecAdjString) And string.IsNullOrEmpty(IDACIESecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_E] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIESecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_E]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_E]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_E, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_E\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_E, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_E\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_E, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_E\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P085_IDACIESecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BE_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P086_IDACIESecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P085_IDACIESecRate As Decimal = products.1718_SBS.P085_IDACIESecRate\r\n    Dim P083_IDACIESecFactor As Decimal = products.1718_SBS.P083_IDACIESecFactor\r\n    Dim APT_ISB_IDACIE_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_E)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal=  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P25 * P085_IDACIESecRate * P083_IDACIESecFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 2  Then \r\n            result = APT_ISB_IDACIE_Secondary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P085_IDACIESecRate, \"P085_IDACIESecRate\", rid)\r\n    Print(P083_IDACIESecFactor, \"P083_IDACIESecFactor\", rid)\r\n    Print(APT_ISB_IDACIE_Secondary, \"APT_ISB_IDACIE_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P087_NSENIDACIESec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P086_IDACIESecSubtotal As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P087a_NSENIDACIESec_Percent As Decimal = products.1718_SBS.P087a_NSENIDACIESec_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P086_IDACIESecSubtotal*P087a_NSENIDACIESec_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P086_IDACIESecSubtotal, \"P086_IDACIESecSubtotal\", rid)\r\n    Print(P087a_NSENIDACIESec_Percent,\"P087a_NSENIDACIESec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P087a_NSENIDACIESec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BE_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN *100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P088_InYearIDACIESecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P086_IDACIESecSubtotal As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P086_IDACIESecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P086_IDACIESecSubtotal, \"P086_IDACIESecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P089_IDACIDSecFactor","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_D]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_D]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_D] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_D]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_D] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_D])\r\n    Dim IDACIDSecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_D\r\n    Dim IDACIDSecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_D\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIDSecAdjString) And string.IsNullOrEmpty(IDACIDSecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_D] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIDSecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_D]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_D]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_D, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_D\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_D, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_D\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_D, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_D\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P091_IDACIDSecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BD_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P092_IDACIDSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P091_IDACIDSecRate As Decimal = products.1718_SBS.P091_IDACIDSecRate\r\n    Dim P089_IDACIDSecFactor As Decimal = products.1718_SBS.P089_IDACIDSecFactor\r\n    Dim APT_ISB_IDACID_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_D)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter=1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n        Result = SBS_P25*P091_IDACIDSecRate*P089_IDACIDSecFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n        result = APT_ISB_IDACID_Secondary\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End If        \r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P091_IDACIDSecRate, \"P091_IDACIDSecRate\", rid)\r\n    Print(P089_IDACIDSecFactor, \"P089_IDACIDSecFactor\", rid)\r\n    Print(APT_ISB_IDACID_Secondary, \"APT_ISB_IDACID_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P093_NSENIDACIDSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P092_IDACIDSecSubtotal As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P093a_NSENIDACIDSec_Percent As Decimal = products.1718_SBS.P093a_NSENIDACIDSec_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P092_IDACIDSecSubtotal*P093a_NSENIDACIDSec_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P092_IDACIDSecSubtotal, \"P092_IDACIDSecSubtotal\", rid)\r\n    Print(P093a_NSENIDACIDSec_Percent,\"P093a_NSENIDACIDSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P093a_NSENIDACIDSec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BD_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN  *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P094_InYearIDACIDSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P092_IDACIDSecSubtotal As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P092_IDACIDSecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P092_IDACIDSecSubtotal, \"P092_IDACIDSecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P095_IDACICSecFactor","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_C]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_C]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_C] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_C]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_C] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_C])\r\n    Dim IDACICSecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_C\r\n    Dim IDACICSecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_C\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACICSecAdjString) And string.IsNullOrEmpty(IDACICSecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_C] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACICSecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_C]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_C]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_C, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_C\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_C, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_C\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_C, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_C\", rid) \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P097_IDACICSecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BC_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P098_IDACICSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P097_IDACICSecRate As Decimal = products.1718_SBS.P097_IDACICSecRate\r\n    Dim P095_IDACICSecFactor As Decimal = products.1718_SBS.P095_IDACICSecFactor\r\n    Dim APT_ISB_IDACIC_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_C)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As Decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter = 1 then\r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P25*P097_IDACICSecRate*P095_IDACICSecFactor \r\n        ElseIf F100_AllAcademies <> 16171 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIC_Secondary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End If \r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P097_IDACICSecRate, \"P097_IDACICSecRate\", rid)\r\n    Print(P095_IDACICSecFactor, \"P095_IDACICSecFactor\", rid)\r\n    Print(APT_ISB_IDACIC_Secondary, \"APT_ISB_IDACIC_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P099_NSENIDACICSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P098_IDACICSecSubtotal As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P099a_NSENIDACICSec_Percent As Decimal = products.1718_SBS.P099a_NSENIDACISec_Percent  /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P098_IDACICSecSubtotal * P099a_NSENIDACICSec_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P098_IDACICSecSubtotal, \"P098_IDACICSecSubtotal\", rid)\r\n    Print(P099a_NSENIDACICSec_Percent,\"P099a_NSENIDACICSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P099a_NSENIDACISec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BC_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN *100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P100_InYearIDACICSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P098_IDACICSecSubtotal As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P098_IDACICSecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P098_IDACICSecSubtotal, \"P098_IDACICSecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P101_IDACIBSecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_B]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_B]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_B] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_B]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_B] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_B])\r\n    Dim IDACIBSecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_B\r\n    Dim IDACIBSecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_B\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIBSecAdjString) And string.IsNullOrEmpty(IDACIBSecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_B] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIBSecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_B]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_B]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_B, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_B\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_B, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_B\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_B, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_B\", rid) \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P103_IDACIBSecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BB_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P104_IDACIBSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P103_IDACIBSecRate As Decimal = products.1718_SBS.P103_IDACIBSecRate\r\n    Dim P101_IDACIBSecFactor As Decimal = products.1718_SBS.P101_IDACIBSecFactor\r\n    Dim APT_ISB_IDACIB_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_B)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =   products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter =1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P25*P103_IDACIBSecRate*P101_IDACIBSecFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIB_Secondary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P103_IDACIBSecRate, \"P103_IDACIBSecRate\", rid)\r\n    Print(P101_IDACIBSecFactor, \"P101_IDACIBSecFactor\", rid)\r\n    Print(APT_ISB_IDACIB_Secondary, \"APT_ISB_IDACIB_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P105_NSENIDACIBSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P104_IDACIBSecSubtotal As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P105a_NSENIDACIBSec_Percent As Decimal = products.1718_SBS.P105a_NSENIDACIBSec_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P104_IDACIBSecSubtotal*P105a_NSENIDACIBSec_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P104_IDACIBSecSubtotal, \"P104_IDACIBSecSubtotal\", rid)\r\n    Print(P105a_NSENIDACIBSec_Percent,\"P105a_NSENIDACIBSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P105a_NSENIDACIBSec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BB_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN *100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P106_InYearIDACIBSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P104_IDACIBSecSubtotal As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P104_IDACIBSecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P104_IDACIBSecSubtotal, \"P104_IDACIBSecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P107_IDACIASecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_A]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_A]\r\n    Dim [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_A] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_A]\r\n    Dim [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_A] As Double = LAtoProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.IDACI_Secondary_Proportion_Band_A])\r\n    Dim IDACIASecAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.IDACI_Secondary_Proportion_Band_A\r\n    Dim IDACIASecCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.IDACI_Secondary_Proportion_Band_A\r\n\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(IDACIASecAdjString) And string.IsNullOrEmpty(IDACIASecCensusString) Then\r\n            result = [Local_Authority_Averages_IDACI_Secondary_Proportion_Band_A] \r\n        Else\r\n            If string.IsNullOrEmpty(IDACIASecAdjString)  Then\r\n                result = [Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_A]\r\n            Else\r\n                result = [APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_A]   \r\n            End if\r\n        End if    \r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_A, \"Census_Pupil_Characteristics_IDACI_Secondary_Proportion_Band_A\", rid) \r\n    Print(APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_A, \"APT_Inputs_and_Adjustments_IDACI_Secondary_Proportion_Band_A\", rid) \r\n    Print(Local_Authority_Averages_IDACI_Secondary_Proportion_Band_A, \"Local_Authority_Averages_IDACI_Secondary_Proportion_Band_A\", rid) \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P109_IDACIASecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_Secondary_BA_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = APT_PP\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P110_IDACIASECSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P109_IDACIASecRate As Decimal = products.1718_SBS.P109_IDACIASecRate\r\n    Dim P107_IDACIASecFactor As Decimal = products.1718_SBS.P107_IDACIASecFactor\r\n    Dim APT_ISB_IDACIA_Secondary As Decimal = [datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_A)]\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    \r\n    If AcadFilter=1 then    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            Result = SBS_P25*P109_IDACIASecRate*P107_IDACIASecFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n            result = APT_ISB_IDACIA_Secondary\r\n        Else\r\n            Exclude(rid)\r\n        End If\r\n    else\r\n        exclude(rid)\r\n    End if\r\n        \r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P109_IDACIASecRate, \"P109_IDACIASecRate\", rid)\r\n    Print(P107_IDACIASecFactor, \"P107_IDACIASecFactor\", rid)\r\n    Print(APT_ISB_IDACIA_Secondary, \"APT_ISB_IDACIA_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":2},{"Name":"P111_NSENIDACIASec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P110_IDACIASecSubtotal As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P111a_NSENIDACIASec_Percent As Decimal = products.1718_SBS.P111a_NSENIDACIASec_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P110_IDACIASecSubtotal*P111a_NSENIDACIASec_Percent\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P110_IDACIASecSubtotal, \"P110_IDACIASecSubtotal\", rid)\r\n    Print(P111a_NSENIDACIASec_Percent,\"P111a_NSENIDACIASec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P111a_NSENIDACIASec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.IDACI_BA_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN *100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":0},{"Name":"P112_InYearIDACIASecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P110_IDACIASecSubtotal As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n         Result = P110_IDACIASecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P110_IDACIASecSubtotal, \"P110_IDACIASecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"IDACI","DecimalPlaces":6},{"Name":"P114_LACFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim LACCensus As Double = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.LAC__X_Proportion\r\n    Dim LACAdj As Double = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.LAC_X_Proportion\r\n    Dim LACAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.LAC_X_Proportion\r\n    Dim LACCensusString as string  = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.LAC__X_Proportion\r\n    Dim LA_AV As Double = latoprov(datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.LAC__X_Proportion)    \r\n \r\nIf F200_SBS_Academies = 1 then\r\n    If string.IsNullOrEmpty(LACAdjString) And string.IsNullOrEmpty(LACCensusString) THEN\r\n        Result = 0\r\n    else \r\n        If string.IsNullOrEmpty(LACAdjString) THEN\r\n            Result = LACCensus\r\n        ELSE\r\n            Result = LACAdj\r\n        End if\r\n     End If\r\nelse\r\n    exclude(rid)\r\nEnd if\r\n\r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(LA_AV, \"LA average\", rid)\r\n      Print(LACCensus, \"LACCensus\", rid)\r\n      Print(LACAdj, \"LACAdj\", rid) \r\n      Print(LACAdjString, \"LACAdjString\", rid)\r\n      Print(LACCensusString, \"LACCensusString\", rid) \r\n      \r\n    Return result\r\n    \r\nEnd Function\r\n   \r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":6},{"Name":"P116_LACRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =  products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Looked_After_Children_Amount_Per_Pupil As Double = LatoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Looked_After_Children_Amount_Per_Pupil)\r\n \r\n    If F200_SBS_Academies = 1 then\r\n        Result = Looked_After_Children_Amount_Per_Pupil\r\n    else\r\n        exclude(rid)                                 \r\n    End if\r\n    \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(Looked_After_Children_Amount_Per_Pupil, \"Looked_After_Children_Amount_Per_Pupil\", rid)\r\n       \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":6},{"Name":"P117_LACSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P114_LACFactor As Decimal = Products.1718_SBS.P114_LACFactor\r\n    Dim P116_LACRate As Decimal = Products.1718_SBS.P116_LACRate\r\n    Dim P26_Total_NOR_SBS As Decimal = Products.1718_NOR.NOR_P26_Total_NOR_SBS\r\n    Dim P117_LACSubtotal As Decimal = P26_Total_NOR_SBS * P116_LACRate * P114_LACFactor\r\n    Dim LAC As Decimal = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.IDACI_(S_A)]\r\n    \r\n       If F200_SBS_Academies <> 1 Then                                                       \r\n          exclude(rid)\r\n       End if\r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = P117_LACSubtotal\r\n       Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n            Result = LAC\r\n          End If  \r\n       End If   \r\n        \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P114_LACFactor, \"P114_LACFactor\", rid)\r\n      Print(P116_LACRate, \"P116_LACRate\", rid)\r\n      Print(P26_Total_NOR_SBS, \"P26_Total_NOR_SBS\", rid)\r\n      Print(LAC, \"LAC\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":2},{"Name":"P118_NSENLAC","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =   products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P117_LACSubtotal As Decimal = Products.1718_SBS.P117_LACSubtotal\r\n    Dim P118a_NSENLAC_Percent As Decimal = Products.1718_SBS.P118a_NSENLAC_Percent /100\r\n    \r\n   \r\n    \r\n       If F200_SBS_Academies = 1 Then\r\n          Result= P117_LACSubtotal * P118a_NSENLAC_Percent\r\n          Else\r\n          exclude(rid)                            \r\n        End if\r\n \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P117_LACSubtotal, \"P117_LACSubtotal\", rid)\r\n      Print(P118a_NSENLAC_Percent, \"P118a_NSENLAC_Percent\", rid) \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":6},{"Name":"P118a_NSENLAC_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =   products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Looked_After_Children_Notional_SEN As Decimal = LatoProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Looked_After_Children_Notional_SEN)\r\n \r\n       If F200_SBS_Academies = 1 then\r\n             Result = Looked_After_Children_Notional_SEN * 100\r\n       else\r\n            exclude(rid)\r\n       End if                                     \r\n    \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(Looked_After_Children_Notional_SEN, \"Looked_After_Children_Notional_SEN\", rid)\r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":6},{"Name":"P119_InYearLACSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n     \r\n     \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =   products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P117_LACSubtotal As Decimal = Products.1718_SBS.P117_LACSubtotal\r\n    Dim Days_Open As Double = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Double =   365\r\n   \r\n    \r\n       If F200_SBS_Academies = 1 Then\r\n          Result= P117_LACSubtotal * Days_Open/Year_Days\r\n          Else\r\n          exclude(rid)\r\n        End if                                        \r\n \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P117_LACSubtotal, \"P117_LACSubtotal\", rid)\r\n      Print(Days_Open, \"Days_Open\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"LAC","DecimalPlaces":0},{"Name":"P120_PPAIndicator","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As string = \"0\" 'change to As String if text product\r\n    \r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Prior_Attainment_Primary_String As String = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Primary_73/78/NA])\r\n    'Dim Prior_Attainment_Primary As Decimal\r\n        \r\n                                                    \r\n       If F200_SBS_Academies = 1 Then\r\n                               \r\n            If Prior_Attainment_Primary_String = \"Low Attainment % old FSP 78\" then\r\n            \r\n                result = 78\r\n                \r\n            ElseIf Prior_Attainment_Primary_String = \"Low Attainment % old FSP 73\" then\r\n            \r\n                result = 73\r\n                \r\n            Else\r\n                \r\n                result = 0\r\n            \r\n            End If \r\n\r\n        Else\r\n                \r\n            exclude(rid)\r\n            \r\n        End If\r\n\r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(Prior_Attainment_Primary_String, \"Prior_Attainment_Primary_String\", rid)\r\n      'Print(Prior_Attainment_Primary, \"Prior_Attainment_Primary\", rid)\r\n    \r\n    Return result\r\nEnd Function                                                                 \r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P121_PPAY5to6Proportion73","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =  products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim LowAttP73PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainnment_under_old_EYFSP_proportion_73]\r\n    Dim LowAttPrimaryP73Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_under_old_FSP_Proportion_73\r\n    Dim LAAV_Y25P73 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Low_Attainment_under_old_EYFSP_Proportion_73])    \r\n    Dim PupilCharacCensusP73 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainnment_under_old_EYFSP_proportion_73]\r\n    Dim AdjP73 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_under_old_FSP_Proportion_73\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n        If string.IsNullOrEmpty(LowAttP73PupilCharac_String) And String.IsNullOrEmpty(LowAttPrimaryP73Adj_String) then\r\n            \r\n            Result = LAAV_Y25P73\r\n            \r\n        Else\r\n  \t\r\n            If String.IsNullOrEmpty(LowAttPrimaryP73Adj_String) then\r\n                \r\n                Result = PupilCharacCensusP73  \r\n                \r\n            Else \r\n                \r\n                Result = AdjP73\r\n                \r\n            End If\r\n                \r\n        End If\r\n    \r\n    Else \r\n            \r\n        exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(LowAttP73PupilCharac_String, \"LowAttP73PupilCharac_String\", rid)\r\n      Print(LowAttPrimaryP73Adj_String, \"LowAttPrimaryP73Adj_String\", rid)\r\n      Print(LAAV_Y25P73, \"LAAV_Y25P73\", rid)\r\n      Print(PupilCharacCensusP73, \"PupilCharacCensusP73\", rid)\r\n      Print(AdjP73, \"AdjP73\", rid)\r\n    \r\n                   \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P122_PPAY5to6Proportion78","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim LowAttP78PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainnment_under_old_EYFSP_proportion_78]\r\n    Dim LowAttPrimaryP78Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_under_old_FSP_Proportion_78\r\n    Dim LAAV_Y25P78 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Low_Attainment_under_old_EYFSP_Proportion_78])    \r\n    Dim PupilCharacCensusP78 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainnment_under_old_EYFSP_proportion_78]\r\n    Dim AdjP78 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_under_old_FSP_Proportion_78\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(LowAttP78PupilCharac_String) And String.IsNullOrEmpty(LowAttPrimaryP78Adj_String) then\r\n            \r\n            Result = LAAV_Y25P78\r\n            \r\n            Else\r\n  \t\r\n                If String.IsNullOrEmpty(LowAttPrimaryP78Adj_String) then\r\n                \r\n                Result = PupilCharacCensusP78  \r\n                \r\n                Else \r\n                \r\n                Result = AdjP78\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(LowAttP78PupilCharac_String, \"LowAttP78PupilCharac_String\", rid)\r\n      Print(LowAttPrimaryP78Adj_String, \"LowAttPrimaryP78Adj_String\", rid)\r\n      Print(LAAV_Y25P78, \"LAAV_Y25P78\", rid)\r\n      Print(PupilCharacCensusP78, \"PupilCharacCensusP78\", rid)\r\n      Print(AdjP78, \"AdjP78\", rid) \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P122a_PPAY7378ForFAPOnly","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_Academies As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P120_PPAIndicator As String = products.1718_SBS.P120_PPAIndicator\r\n    Dim P121_PPAYr5to6Proportion73 As Decimal = products.1718_SBS.P121_PPAY5to6Proportion73\r\n    Dim P122_PPAYr5to6Proportion78 As Decimal = products.1718_SBS.P122_PPAY5to6Proportion78\r\n    \r\n    If SBS_Academies=1 then\r\n        If P120_PPAIndicator=\"73\" then\r\n            result = P121_PPAYr5to6Proportion73\r\n        ElseIf P120_PPAIndicator=\"78\" then\r\n            result = P122_PPAYr5to6Proportion78\r\n        else\r\n            result = 0\r\n        End If   \r\n    End If \r\n     \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P123_PPAY1to4ProportionUnder","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = products.1718_Global_Variables.F900_FUndingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim LowAttPEYPupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainment_Proportion_under_new_EYFSP]\r\n    Dim LowAttPrimaryPEYAdj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_attainment_Proportion_under_new_EYFSP\r\n    Dim LAAV_PEY As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Low_attainment_Proportion_under_new_EYFSP])    \r\n    Dim PupilCharacCensusPEY As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_attainment_Proportion_under_new_EYFSP]\r\n    Dim AdjPEY As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_attainment_Proportion_under_new_EYFSP\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(LowAttPEYPupilCharac_String) And String.IsNullOrEmpty(LowAttPrimaryPEYAdj_String) then\r\n            \r\n            Result = LAAV_PEY\r\n            \r\n            Else\r\n  \t\r\n                If String.IsNullOrEmpty(LowAttPrimaryPEYAdj_String) then\r\n                \r\n                Result = PupilCharacCensusPEY  \r\n                \r\n                Else \r\n                \r\n                Result = AdjPEY\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(LowAttPEYPupilCharac_String, \"LowAttPEYPupilCharac_String\", rid)\r\n      Print(LowAttPrimaryPEYAdj_String, \"LowAttPrimaryPEYAdj_String\", rid)\r\n      Print(LAAV_PEY, \"LAAV_YPEY\", rid)\r\n      Print(PupilCharacCensusPEY, \"PupilCharacCensusPEY\", rid)\r\n      Print(AdjPEY, \"AdjPEY\", rid) \r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P124_PPAY5to6NOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim NOR_P04_Y5Y6 As Decimal = Products.1718_NOR.NOR_P04_Y5Y6\r\n     \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = NOR_P04_Y5Y6\r\n            Else\r\n            Exclude(rid)                                       \r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(NOR_P04_Y5Y6, \"NOR_04_Y5Y6\", rid)\r\n     \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P125_PPAY1to4NOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FUndingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim NOR_P03_Y1Y4 As Decimal = Products.1718_NOR.NOR_P03_Y1Y4\r\n     \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = NOR_P03_Y1Y4\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(NOR_P03_Y1Y4, \"NOR_P03_Y1Y4\", rid)\r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P126_PPAPriNOR","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P22_Total_NOR_PRI_SBS As Decimal =Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n             \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P22_Total_NOR_PRI_SBS\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P22_Total_NOR_PRI_SBS, \"P22_Total_NOR_PRI_SBS\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P127_PPARate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FUndingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PA_PrimAmountPerPupil As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Primary_Amount_Per_Pupil])\r\n     \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = PA_PrimAmountPerPupil\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PA_PrimAmountPerPupil, \"PA_PrimAmountPerPupil\", rid)\r\n    \r\n                  \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P128_PPAWeighting","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PAPriY1Weight As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Primary_new_EFSP_Weighting])\r\n    \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = PAPriY1Weight\r\n            Else\r\n            Exclude(rid)\r\n        End IF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PAPriY1Weight, \"PAPriY1Weight\", rid)\r\n  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P129_PPAPupilsY5to6NotAchieving","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As   Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P120_PPAindicator As string = Products.1718_SBS.P120_PPAindicator\r\n    Dim P121_PPAY5to6Proportion73 As Decimal = Products.1718_SBS.P121_PPAY5to6Proportion73\r\n    Dim P124_PPAY5to6NOR As Decimal = Products.1718_SBS.P124_PPAY5to6NOR\r\n    Dim P122_PPAY5to6Proportion78 As Decimal = Products.1718_SBS.P122_PPAY5to6Proportion78 \r\n\r\n\r\n       If F200_SBS_Academies = 1 then\r\n       \r\n            IF P120_PPAindicator = \"73\" THEN \r\n            Result = P121_PPAY5to6Proportion73 * P124_PPAY5to6NOR \r\n            End IF\r\n            \r\n            IF P120_PPAindicator = \"78\" THEN \r\n            Result = P122_PPAY5to6Proportion78 * P124_PPAY5to6NOR \r\n            End IF\r\n           \r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P120_PPAindicator, \"P120_PPAindicator\", rid)\r\n      Print(P121_PPAY5to6Proportion73, \"P121_PPAY5to6Proportion73\", rid)\r\n      Print(P124_PPAY5to6NOR, \"P124_PPAY5to6NOR\", rid)\r\n      Print(P122_PPAY5to6Proportion78, \"P122_PPAY5to6Proportion78\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P130_PPAPupilsY1to4NotAchieving","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P123_PPAY1to4ProportionUnder As Decimal = Products.1718_SBS.P123_PPAY1to4ProportionUnder\r\n    Dim P125_PPAY1to4NOR As Decimal = Products.1718_SBS.P125_PPAY1to4NOR\r\n    Dim P128_PPAWeighting As Decimal = Products.1718_SBS.P128_PPAWeighting\r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P123_PPAY1to4ProportionUnder * P128_PPAWeighting * P125_PPAY1to4NOR\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n \r\n        \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P123_PPAY1to4ProportionUnder, \"P123_PPAY1to4ProportionUnder\", rid)\r\n      Print(P125_PPAY1to4NOR, \"P125_PPAY1to4NOR\", rid)\r\n      Print(P128_PPAWeighting, \"P128_PPAWeighting\", rid)\r\n        \r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P131_PPATotalPupilsY1to6NotAchieving","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P130_PPAPupilsY1to4NotAchieving As Decimal = Products.1718_SBS.P130_PPAPupilsY1to4NotAchieving\r\n    Dim P129_PPAPupilsY5to6NotAchieving As Decimal = Products.1718_SBS.P129_PPAPupilsY5to6NotAchieving\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result =  P130_PPAPupilsY1to4NotAchieving + P129_PPAPupilsY5to6NotAchieving\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P129_PPAPupilsY5to6NotAchieving, \"P129_PPAPupilsY5to6NotAchieving\", rid)\r\n      Print(P130_PPAPupilsY1to4NotAchieving, \"P130_PPAPupilsY1to4NotAchieving\", rid) \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P132_PPATotalProportionNotAchieving","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As   Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P131_PPATotalPupilsY1to6NotAchieving As Decimal = Products.1718_SBS.P131_PPATotalPupilsY1to6NotAchieving\r\n    Dim P124_PPAY5to6NOR As Decimal = Products.1718_SBS.P124_PPAY5to6NOR\r\n    Dim P125_PPAY1to4NOR As Decimal = Products.1718_SBS.P125_PPAY1to4NOR\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P131_PPATotalPupilsY1to6NotAchieving / (P124_PPAY5to6NOR + P125_PPAY1to4NOR)\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P131_PPATotalPupilsY1to6NotAchieving, \"P131_PPATotalPupilsY1to6NotAchieving\", rid)\r\n      Print(P124_PPAY5to6NOR, \"P124_PPAY5to6NOR\", rid) \r\n      Print(P125_PPAY1to4NOR, \"P125_PPAY1to4NOR\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P133_PPATotalFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P126_PPAPriNOR As Decimal = Products.1718_SBS.P126_PPAPriNOR\r\n    Dim P127_PPARate As Decimal = Products.1718_SBS.P127_PPARate\r\n    Dim P132_PPATotalProportionNotAchieving As Decimal = Products.1718_SBS.P132_PPATotalProportionNotAchieving\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result =  P126_PPAPriNOR * P127_PPARate * P132_PPATotalProportionNotAchieving\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P126_PPAPriNOR, \"P126_PPAPriNOR\", rid)\r\n      Print(P127_PPARate, \"P127_PPARate\", rid) \r\n      Print(P132_PPATotalProportionNotAchieving, \"P132_PPATotalProportionNotAchieving\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":2},{"Name":"P134_NSENPPA","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P133_PPATotalFunding As Decimal = Products.1718_SBS.P133_PPATotalFunding\r\n    Dim P134a_NSENPPA_Percent As Decimal = Products.1718_SBS.P134a_NSENPPA_Percent  /100\r\n  \r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result =  P133_PPATotalFunding * P134a_NSENPPA_Percent\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P133_PPATotalFunding, \"P133_PPATotalFunding\", rid)\r\n      Print(P134a_NSENPPA_Percent, \"P134a_NSENPPA_Percent\", rid) \r\n       \r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P134a_NSENPPA_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PAPrimaryNotionalSEN As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Primary_Notional_SEN])*100\r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = PAPrimaryNotionalSEN\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PAPrimaryNotionalSEN, \"PAPrimaryNotionalSEN\", rid)\r\n      \r\n    \r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P135_InYearPPASubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As   Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P133_PPATotalFunding As Decimal = Products.1718_SBS.P133_PPATotalFunding\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P133_PPATotalFunding * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P133_PPATotalFunding, \"P133_PPATotalFunding\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P136_SecPAFactor_Y7Factor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PCLow_AttSecProp_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainent_Secondary_Proportion_-_Y7]\r\n    Dim AdjLow_AttSecProp_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_Secondary_Proportion_Y7\r\n    Dim LAAV_SecProp As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Low_Attainent_Secondary_Proportion_-_Y7])    \r\n    Dim PupCharCensusSecProp As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainent_Secondary_Proportion_-_Y7]\r\n    Dim AdjSecProp As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_Secondary_Proportion_Y7\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n            If string.IsNullOrEmpty(PCLow_AttSecProp_String) And String.IsNullOrEmpty(AdjLow_AttSecProp_String) then\r\n            \r\n                Result = LAAV_SecProp\r\n            \r\n            Else                                                                                                                                                              \r\n  \t\r\n                If String.IsNullOrEmpty(AdjLow_AttSecProp_String) then\r\n                \r\n                    Result = PupCharCensusSecProp \r\n                \r\n                Else \r\n                \r\n                    Result = AdjSecProp\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n    Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PCLow_AttSecProp_String, \"PCLow_AttSecProp_String\", rid)\r\n      Print(AdjLow_AttSecProp_String, \"AdjLow_AttSecProp_String\", rid)\r\n      Print(LAAV_SecProp, \"LAAV_SecProp\", rid)\r\n      Print(PupCharCensusSecProp, \"PupCharCensusSecProp\", rid)\r\n      Print(AdjSecProp, \"AdjSecProp\", rid)\r\n  \r\n  Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P138_SecPARate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PA_SecAmountPerPupil As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Secondary_Amount_Per_Pupil])\r\n    \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = PA_SecAmountPerPupil\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PA_SecAmountPerPupil, \"PA_SecAmountPerPupil\", rid)\r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P139_SecPASubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P138_SecPARate As Decimal = Products.1718_SBS.P138_SecPARate\r\n    Dim P138a_SecPA_Y7Factor As Decimal = Products.1718_SBS.P138a_SecPA_AdjustedSecFactor\r\n    Dim P25_Total_NOR_SEC_SBS As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim calc As Decimal = P25_Total_NOR_SEC_SBS * P138_SecPARate * P138a_SecPA_Y7Factor\r\n    Dim PA_Secondary As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Low_Attainment_S\r\n         \r\n       If F200_SBS_Academies <> 1 Then\r\n          exclude(rid)\r\n        End if\r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = calc\r\n          Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n          Result = PA_Secondary\r\n          End If  \r\n       End If   \r\n         \r\n \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P138_SecPARate, \"P138_SecPARate\", rid)\r\n      Print(P25_Total_NOR_SEC_SBS, \"P25_Total_NOR_SEC_SBS\", rid)\r\n      Print(PA_Secondary, \"PA_Secondary\", rid)\r\n      Print(calc, \"calc\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":2},{"Name":"P140_NSENSecPA","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P139_SecPASubtotal As Decimal = Products.1718_SBS.P139_SecPASubtotal\r\n    Dim P140a_NSENSecPA_Percent As Decimal = Products.1718_SBS.P140a_NSENSecPA_Percent  /100\r\n    \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result =P139_SecPASubtotal * P140a_NSENSecPA_Percent\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P139_SecPASubtotal, \"P139_SecPASubtotal\", rid)\r\n      Print(P140a_NSENSecPA_Percent, \"P140a_NSENSecPA_Percent\", rid)\r\n      \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P140a_NSENSecPA_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PA_SecNotionalSEN As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Prior_Attainment_Secondary_Notional_SEN])  *100\r\n     \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = PA_SecNotionalSEN\r\n            Else\r\n            Exclude(rid)\r\n        End iF\r\n \r\n \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PA_SecNotionalSEN, \"PA_SecNotionalSEN\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":0},{"Name":"P141_InYearSecPASubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P139_SecPASubtotal As Decimal = Products.1718_SBS.P139_SecPASubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P139_SecPASubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P139_SecPASubtotal, \"P139_SecPASubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1617DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P137_SecPA_Y8to11Factor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PCLow_AttSecProp_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainent_Secondary_Proportion_-_Y8-11]\r\n    Dim AdjLow_AttSecProp_String As String = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_Secondary_Proportion_Y8-11]\r\n    Dim LAAV_SecProp As Decimal = LaToProv([datasets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.Low_Attainent_Secondary_Proportion_-_Y8-11])    \r\n    Dim PupCharCensusSecProp As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Low_Attainent_Secondary_Proportion_-_Y8-11]\r\n    Dim AdjSecProp As Decimal = [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Low_Attainment_Secondary_Proportion_Y8-11]\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n            If string.IsNullOrEmpty(PCLow_AttSecProp_String) And String.IsNullOrEmpty(AdjLow_AttSecProp_String) then\r\n            \r\n                Result = LAAV_SecProp\r\n            \r\n            Else                                                                                                                                                              \r\n  \t\r\n                If String.IsNullOrEmpty(AdjLow_AttSecProp_String) then\r\n                \r\n                    Result = PupCharCensusSecProp \r\n                \r\n                Else \r\n                \r\n                    Result = AdjSecProp\r\n                \r\n                End If                    \r\n                \r\n            End If\r\n    \r\n    Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(PCLow_AttSecProp_String, \"PCLow_AttSecProp_String\", rid)\r\n      Print(AdjLow_AttSecProp_String, \"AdjLow_AttSecProp_String\", rid)\r\n      Print(LAAV_SecProp, \"LAAV_SecProp\", rid)\r\n      Print(PupCharCensusSecProp, \"PupCharCensusSecProp\", rid)\r\n      Print(AdjSecProp, \"AdjSecProp\", rid)  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P136a_SecPA_Y7NationalWeight","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim APTLowAttainmentY7 As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_low_attainment_(year_7)_weighting])\r\n    \r\n    If F200 = 1 then\r\n    \r\n        result = APTLowAttainmentY7\r\n\r\n    else\r\n    \r\n        exclude(rid)\r\n    \r\n    End If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P138a_SecPA_AdjustedSecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P08a_Y7 As Decimal = Products.1718_NOR.NOR_P08a_Y7\r\n    Dim P08b_Y8to11 As Decimal = Products.1718_NOR.NOR_P08b_Y8to11\r\n    Dim P136_SecPA_Y7Factor As Decimal = Products.1718_SBS.P136_SecPAFactor_Y7Factor\r\n    Dim P136a_SecPA_Y7NationalWeight As Decimal = Products.1718_SBS.P136a_SecPA_Y7NationalWeight \r\n    Dim P137_SecPA_Y8to11Factor As Decimal = Products.1718_SBS.P137_SecPA_Y8to11Factor\r\n    \r\n    If F200 = 1 then\r\n    \r\n        result = ((P136_SecPA_Y7Factor * P08a_Y7 * P136a_SecPA_Y7NationalWeight) + (P137_SecPA_Y8to11Factor * P08b_Y8to11)) / (P08a_Y7 + P08b_Y8to11)\r\n    \r\n    Else\r\n    \r\n        exclude(rid)\r\n    \r\n    End if\r\n    \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Prior Attainment","DecimalPlaces":6},{"Name":"P142_EAL1PriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal =          Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal =               products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal =         Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALPrimP1PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_1_Primary_Proportion]\r\n    Dim EALPrimaryP1Adj_String As String =      [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_1_Primary_Proportion]\r\n    Dim LAAV_EALPrimP1 As Decimal =             LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_1_Primary_Proportion])    \r\n    Dim PupilCharacCensusEALP1 As Decimal =     [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_1_Primary_Proportion]\r\n    Dim AdjEALP1 As Decimal =                   [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_1_Primary_Proportion]\r\n\r\n    If F200_SBS_Academies = 1 then\r\n                   \r\n        If string.IsNullOrEmpty(EALPrimP1PupilCharac_String) And String.IsNullOrEmpty(EALPrimaryP1Adj_String) then\r\n            \r\n            Result = LAAV_EALPrimP1\r\n            \r\n        Else\r\n  \t\r\n            If String.IsNullOrEmpty(EALPrimaryP1Adj_String) then\r\n                \r\n                Result = PupilCharacCensusEALP1  \r\n                \r\n            Else \r\n                \r\n                Result = AdjEALP1\r\n                \r\n            End If\r\n                \r\n        End If\r\n    \r\n    Else \r\n            \r\n        exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALPrimP1PupilCharac_String, \"EALPrimP1PupilCharac_String\", rid)\r\n      Print(EALPrimaryP1Adj_String, \"EALPrimaryP1Adj_String\", rid)\r\n      Print(LAAV_EALPrimP1, \"LAAV_EALPrimP1\", rid)\r\n      Print(PupilCharacCensusEALP1, \"PupilCharacCensusEALP1\", rid)\r\n      Print(AdjEALP1, \"AdjEALP1\", rid)\r\n      \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P144_EAL1PriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim F100_AllAcademies As Decimal =              Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal =                   Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal =             Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Primary As String =                     LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_1/2/3/NA])\r\n    Dim EAL_Primary_Amount_Per_Pupil As Decimal =   LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_Amount_Per_Pupil])\r\n    \r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Primary = \"EAL 1 Primary\" Then \r\n          Result = EAL_Primary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF\r\n     Else \r\n     exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Primary, \"EEAL_Primary_1/2/3/NA\", rid)\r\n      Print(EAL_Primary_Amount_Per_Pupil, \"EAL_Primary_Amount_Per_Pupil\", rid)\r\n      \r\n\r\n \r\n    Return result\r\nEnd Function\r\n\r\n\r\n   ","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P145_EAL1PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double =       Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal =           Products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double =      Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P142_EAL1PriFactor As Decimal =     Products.1718_SBS.P142_EAL1PriFactor\r\n    Dim P144_EAL1PriRate As Decimal =       Products.1718_SBS.P144_EAL1PriRate\r\n    Dim P22_Total_NOR_PRI_SBS As Decimal =  Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim calc As Decimal =                   P22_Total_NOR_PRI_SBS * P144_EAL1PriRate * P142_EAL1PriFactor\r\n    Dim EAL_P As Decimal =                  LAToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_P])\r\n    \r\n       If F200_SBS_Academies <> 1 Then\r\n          exclude(rid)\r\n        End if\r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = calc\r\n          Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n            If P144_EAL1PriRate>0           \r\n            Result = EAL_P\r\n            Else Result = 0\r\n            End If\r\n          End If  \r\n       End If   \r\n         \r\n       \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P142_EAL1PriFactor, \"P142_EAL1PriFactor\", rid)\r\n      Print(P144_EAL1PriRate, \"P144_EAL1PriRate\", rid)\r\n      Print(P22_Total_NOR_PRI_SBS, \"P22_Total_NOR_PRI_SB\", rid)\r\n      Print(EAL_P, \"EAL_P\", rid)\r\n      Print(calc, \"calc\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P146_InYearEAL1PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal =      Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal =           Products.1718_Global_Variables.F900_FUndingBasis\r\n    Dim F200_SBS_Academies As Decimal =     Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P145_EAL1PriSubtotal As Decimal =   Products.1718_SBS.P145_EAL1PriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal =      Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal =              365       \r\n      \r\n       If F200_SBS_Academies = 1 Then \r\n            \r\n            Result = P145_EAL1PriSubtotal * P001_1718DaysOpen / Year_Days\r\n       \r\n       Else\r\n            \r\n            Exclude(rid)\r\n       \r\n       End If                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P145_EAL1PriSubtotal, \"P145_EAL1PriSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1617DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P147_EAL2PriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim acadfilter As Decimal =                 Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =                Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim F200_SBS_Academies As Decimal =         Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALPrimP2PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_2_Primary_Proportion]\r\n    Dim EALPrimaryP2Adj_String As String =      [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_2_Primary_Proportion]\r\n    Dim LAAV_EALPrimP2 As Decimal =             LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_2_Primary_Proportion])    \r\n    Dim PupilCharacCensusEALP2 As Decimal =     [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_2_Primary_Proportion]\r\n    Dim AdjEALP2 As Decimal =                   [DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_2_Primary_Proportion]\r\n\r\nIf FundingBasis = \"Place\" Then \r\n                   \r\n    exclude(rid)\r\n    \r\nElse     \r\n    \r\n    If acadfilter = 17181 Or acadfilter = 17182 Or acadfilter = 17183 Then \r\n    \r\n        If string.IsNullOrEmpty(EALPrimP2PupilCharac_String) And String.IsNullOrEmpty(EALPrimaryP2Adj_String) Then \r\n\r\n            Result = LAAV_EALPrimP2\r\n\r\n        Else\r\n\r\n            If String.IsNullOrEmpty(EALPrimaryP2Adj_String) Then \r\n\r\n                Result = PupilCharacCensusEALP2  \r\n\r\n            Else \r\n\r\n                Result = AdjEALP2\r\n\r\n            End If\r\n\r\n        End If\r\n\r\n    Else \r\n    \r\n        exclude(rid)    \r\n\r\n    End If\r\n            \r\nEnd If \r\n  \r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALPrimP2PupilCharac_String, \"EALPrimP2PupilCharac_String\", rid)\r\n      Print(EALPrimaryP2Adj_String, \"EALPrimaryP2Adj_String\", rid)\r\n      Print(LAAV_EALPrimP2, \"LAAV_EALPrimP2\", rid)\r\n      Print(PupilCharacCensusEALP2, \"PupilCharacCensusEALP2\", rid)\r\n      Print(AdjEALP2, \"AdjEALP2\", rid)\r\n      \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P149_EAL2PriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Primary As String = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_1/2/3/NA)\r\n    Dim EAL_Primary_Amount_Per_Pupil As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_Amount_Per_Pupil)\r\n    \r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Primary = \"EAL 2 Primary\" Then \r\n          Result = EAL_Primary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF\r\n     Else \r\n     exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Primary, \"EEAL_Primary_1/2/3/NA\", rid)\r\n      Print(EAL_Primary_Amount_Per_Pupil, \"EAL_Primary_Amount_Per_Pupil\", rid)\r\n      \r\n\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P150_EAL2PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double =       Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =            Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim F200_SBS_Academies As Double =      Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P149_EAL2PriRate As Decimal =       Products.1718_SBS.P149_EAL2PriRate\r\n    Dim P147_EAL2PriFactor As Decimal =     Products.1718_SBS.P147_EAL2PriFactor\r\n    Dim P22_Total_NOR_PRI_SBS As Decimal =  Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim calc As Decimal =                   P22_Total_NOR_PRI_SBS * P149_EAL2PriRate * P147_EAL2PriFactor \r\n    Dim EAL_P As Decimal =                  LAToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_P])\r\n    \r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)                                                                                     \r\n    \r\nElse \r\n\r\n    If (F100_AllAcademies = 17181) Or (FundingBasis = \"Estimate\" And F100_AllAcademies = 17182) Or (FundingBasis = \"Estimate\" And F100_AllAcademies = 17183) Then   \r\n\r\n        result = calc\r\n        \r\n    Else \r\n  \r\n        If (FundingBasis = \"Census\" And F100_AllAcademies = 17182) Or (FundingBasis = \"Census\" And F100_AllAcademies = 17183) Then   'new opener\r\n    \r\n            If P149_EAL2PriRate > 0\r\n            \r\n                Result = EAL_P\r\n        \r\n            Else\r\n                \r\n                Result = 0\r\n                \r\n            End If\r\n  \r\n        Else \r\n        \r\n            exclude(rid)\r\n            \r\n        End If  \r\n\r\n    End If   \r\n         \r\nEnd If        \r\n      \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P151_InYearEAL2PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P150_EAL2PriSubtotal As Decimal = Products.1718_SBS.P150_EAL2PriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P150_EAL2PriSubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P150_EAL2PriSubtotal, \"P150_EAL2PriSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P152_EAL3PriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALPrimP3PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_3_Primary_Proportion]\r\n    Dim EALPrimaryP3Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_3_Primary_Proportion\r\n    Dim LAAV_EALPrimP3 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_3_Primary_Proportion])    \r\n    Dim PupilCharacCensusEALP3 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_3_Primary_Proportion]\r\n    Dim AdjEALP3 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_3_Primary_Proportion\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(EALPrimP3PupilCharac_String) And String.IsNullOrEmpty(EALPrimaryP3Adj_String) then\r\n            \r\n            Result = LAAV_EALPrimP3\r\n            \r\n            Else\r\n      \r\n                If String.IsNullOrEmpty(EALPrimaryP3Adj_String) then\r\n                \r\n                Result = PupilCharacCensusEALP3  \r\n                \r\n                Else \r\n                \r\n                Result = AdjEALP3\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALPrimP3PupilCharac_String, \"EALPrimP3PupilCharac_String\", rid)\r\n      Print(EALPrimaryP3Adj_String, \"EALPrimaryP3Adj_String\", rid)\r\n      Print(LAAV_EALPrimP3, \"LAAV_EALPrimP3\", rid)\r\n      Print(PupilCharacCensusEALP3, \"PupilCharacCensusEALP3\", rid)\r\n      Print(AdjEALP3, \"AdjEALP3\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P154_EAL3PriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Primary As String = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_1/2/3/NA])\r\n    Dim EAL_Primary_Amount_Per_Pupil As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_Amount_Per_Pupil)\r\n    \r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Primary = \"EAL 3 Primary\" Then \r\n          Result = EAL_Primary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF\r\n     Else \r\n     exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Primary, \"EEAL_Primary_1/2/3/NA\", rid)\r\n      Print(EAL_Primary_Amount_Per_Pupil, \"EAL_Primary_Amount_Per_Pupil\", rid)\r\n      \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P155_EAL3PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Double =       Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String =            Datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim P154_EAL3PriRate As Decimal =       Products.1718_SBS.P154_EAL3PriRate\r\n    Dim P152_EAL3PriFactor As Decimal =     Products.1718_SBS.P152_EAL3PriFactor\r\n    Dim P22_Total_NOR_PRI_SBS As Decimal =  Products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim calc As Decimal =                   P22_Total_NOR_PRI_SBS * P154_EAL3PriRate * P152_EAL3PriFactor \r\n    Dim EAL_P As Decimal =                  LAtoProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_P])\r\n    \r\nIf FundingBasis = \"Place\" Then\r\n\r\n    exclude(rid)\r\n\r\nElse \r\n\r\n    If (F100_AllAcademies = 17181) Or (FundingBasis = \"Estimate\" And F100_AllAcademies = 17182) Or (FundingBasis = \"Estimate\" And F100_AllAcademies = 17183) Then   \r\n        \r\n        result = calc\r\n    \r\n    Else \r\n        \r\n        If (FundingBasis = \"Census\" And F100_AllAcademies = 17182) Or (FundingBasis = \"Census\" And F100_AllAcademies = 17183) Then   'new opener\r\n    \r\n            If P154_EAL3PriRate > 0\r\n            \r\n                Result = EAL_P\r\n    \r\n            Else \r\n    \r\n                Result = 0\r\n    \r\n            End If\r\n  \r\n        Else \r\n        \r\n            exclude(rid)\r\n  \r\n        End If  \r\n\r\n    End If   \r\n         \r\nEnd If        \r\n       \r\n                               \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P156_NSENPriEAL","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P145_EAL1PriSubtotal As Decimal =Products.1718_SBS.P145_EAL1PriSubtotal \r\n    Dim P150_EAL2PriSubtotal As Decimal =Products.1718_SBS.P150_EAL2PriSubtotal \r\n    Dim P155_EAL3PriSubtotal As Decimal =Products.1718_SBS.P155_EAL3PriSubtotal \r\n    Dim P156a_NSENPriEAL_Percent As Decimal = Products.1718_SBS.P156a_NSENPriEAL_Percent / 100\r\n    \r\n    \r\n\r\n     If F200_SBS_Academies = 1 then  \r\n           Result = (P145_EAL1PriSubtotal + P150_EAL2PriSubtotal + P155_EAL3PriSubtotal) * P156a_NSENPriEAL_Percent\r\n           Else \r\n         exclude(rid)     \r\n        End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P145_EAL1PriSubtotal, \"P145_EAL1PriSubtotal\", rid)\r\n      Print(P150_EAL2PriSubtotal, \"P150_EAL2PriSubtotal\", rid)\r\n      Print(P155_EAL3PriSubtotal, \"P155_EAL3PriSubtotal\", rid)\r\n      Print(P156a_NSENPriEAL_Percent, \"P156a_NSENPriEAL_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P156a_NSENPriEAL_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Primary_Notional_SEN As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Primary_Notional_SEN)\r\n  \r\n\r\n     If F200_SBS_Academies = 1 then      \r\n           Result = EAL_Primary_Notional_SEN * 100   \r\n           Else \r\n           exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Primary_Notional_SEN, \"EAL_Primary_Notional_SEN\", rid)\r\n      \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":0},{"Name":"P157_InYearEAL3PriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P155_EAL3PriSubtotal As Decimal = Products.1718_SBS.P155_EAL3PriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P155_EAL3PriSubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE                    \r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P155_EAL3PriSubtotal, \"P155_EAL3PriSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P158_EAL1SecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALSecP1PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_1_Secondary_Proportion]\r\n    Dim EALSecondaryP1Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_1_Secondary_Proportion\r\n    Dim LAAV_EALSecP1 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_1_Secondary_Proportion])    \r\n    Dim PupilCharacCensusEALSecP1 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_1_Secondary_Proportion]\r\n    Dim AdjEALSecP1 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_1_Secondary_Proportion\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(EALSecP1PupilCharac_String) And String.IsNullOrEmpty(EALSecondaryP1Adj_String) then\r\n            \r\n            Result = LAAV_EALSecP1\r\n            \r\n            Else\r\n      \r\n                If String.IsNullOrEmpty(EALSecondaryP1Adj_String) then\r\n                \r\n                Result = PupilCharacCensusEALSecP1  \r\n                \r\n                Else \r\n                \r\n                Result = AdjEALSecP1\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALSecP1PupilCharac_String, \"EALSecP1PupilCharac_String\", rid)\r\n      Print(EALSecondaryP1Adj_String, \"EALSecondaryP1Adj_String\", rid)\r\n      Print(LAAV_EALSecP1, \"LAAV_EALSecP1\", rid)\r\n      Print(PupilCharacCensusEALSecP1, \"PupilCharacCensusEALSecP1\", rid)\r\n      Print(AdjEALSecP1, \"AdjEALSecP1\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P160_EAL1SecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Secondary As String = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_1/2/3/NA)\r\n    Dim EAL_Secondary_Amount_Per_Pupil As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_Amount_Per_Pupil)\r\n    \r\n                                                  \r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Secondary = \"EAL 1 Secondary\" Then \r\n          Result = EAL_Secondary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF\r\n     Else \r\n     exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Secondary, \"EEAL_Secondary_1/2/3/NA\", rid)\r\n      Print(EAL_Secondary_Amount_Per_Pupil, \"EAL_Secondary_Amount_Per_Pupil\", rid)\r\n      \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P161_EAL1SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P160_EAL1SecRate As Decimal = Products.1718_SBS.P160_EAL1SecRate\r\n    Dim P158_EAL1SecFactor As Decimal = Products.1718_SBS.P158_EAL1SecFactor\r\n    Dim P25_Total_NOR_SEC_SBS As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim calc As Decimal = P25_Total_NOR_SEC_SBS * P160_EAL1SecRate * P158_EAL1SecFactor\r\n    Dim EAL_S As Decimal = LAToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_S)\r\n    \r\n       If F200_SBS_Academies <> 1 Then\r\n          exclude(rid)\r\n        End if                                       \r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = calc\r\n          Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n            If P160_EAL1SecRate>0           \r\n            Result = EAL_S\r\n            Else Result = 0\r\n            End If\r\n          End If  \r\n       End If   \r\n         \r\n       \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P160_EAL1SecRate, \"P160_EAL1SecRate\", rid)\r\n      Print(P158_EAL1SecFactor, \"P158_EAL1SecFactor\", rid)\r\n      Print(P25_Total_NOR_SEC_SBS, \"P25_Total_NOR_SEC_SBS\", rid)\r\n      Print(EAL_S, \"EAL_S\", rid)\r\n      Print(calc, \"calc\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P162_InYearEAL1SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P161_EAL1SecSubtotal As Decimal = Products.1718_SBS.P161_EAL1SecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P161_EAL1SecSubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                 \r\n                                                                \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P161_EAL1SecSubtotal, \"P161_EAL1SecSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P163_EAL2SecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALSecP2PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_2_Secondary_Proportion]\r\n    Dim EALSecondaryP2Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_2_Secondary_Proportion\r\n    Dim LAAV_EALSecP2 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_2_Secondary_Proportion])    \r\n    Dim PupilCharacCensusEALSecP2 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_2_Secondary_Proportion]\r\n    Dim AdjEALSecP2 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_2_Secondary_Proportion\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(EALSecP2PupilCharac_String) And String.IsNullOrEmpty(EALSecondaryP2Adj_String) then\r\n            \r\n            Result = LAAV_EALSecP2\r\n                                                                         \r\n            Else\r\n      \r\n                If String.IsNullOrEmpty(EALSecondaryP2Adj_String) then\r\n                \r\n                Result = PupilCharacCensusEALSecP2  \r\n                \r\n                Else \r\n                \r\n                Result = AdjEALSecP2\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALSecP2PupilCharac_String, \"EALSecP2PupilCharac_String\", rid)\r\n      Print(EALSecondaryP2Adj_String, \"EALSecondaryP2Adj_String\", rid)\r\n      Print(LAAV_EALSecP2, \"LAAV_EALSecP2\", rid)\r\n      Print(PupilCharacCensusEALSecP2, \"PupilCharacCensusEALSecP2\", rid)\r\n      Print(AdjEALSecP2, \"AdjEALSecP2\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P165_EAL2SecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Secondary As String = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_1/2/3/NA)\r\n    Dim EAL_Secondary_Amount_Per_Pupil As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_Amount_Per_Pupil)\r\n    \r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Secondary = \"EAL 2 Secondary\" Then \r\n          Result = EAL_Secondary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF                \r\n     Else \r\n     exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Secondary, \"EEAL_Secondary_1/2/3/NA\", rid)\r\n      Print(EAL_Secondary_Amount_Per_Pupil, \"EAL_Secondary_Amount_Per_Pupil\", rid)\r\n      \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P166_EAL2SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P165_EAL2SecRate As Decimal = Products.1718_SBS.P165_EAL2SecRate\r\n    Dim P163_EAL2SecFactor As Decimal = Products.1718_SBS.P163_EAL2SecFactor\r\n    Dim P25_Total_NOR_SEC_SBS As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim calc As Decimal = P25_Total_NOR_SEC_SBS * P165_EAL2SecRate * P163_EAL2SecFactor\r\n    Dim EAL_S As Decimal = LAToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_S)\r\n    \r\n       If F200_SBS_Academies <> 1 Then\r\n          exclude(rid)\r\n        End if                            \r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = calc\r\n          Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n            If P165_EAL2SecRate>0           \r\n            Result = EAL_S\r\n            Else Result = 0\r\n            End If\r\n          End If  \r\n       End If   \r\n         \r\n       \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P165_EAL2SecRate, \"P165_EAL2SecRate\", rid)\r\n      Print(P163_EAL2SecFactor, \"P163_EAL2SecFactor\", rid)\r\n      Print(P25_Total_NOR_SEC_SBS, \"P25_Total_NOR_SEC_SBS\", rid)\r\n      Print(EAL_S, \"EAL_S\", rid)\r\n      Print(calc, \"calc\", rid)\r\n      \r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P167_InYearEAL2SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P166_EAL2SecSubtotal As Decimal = Products.1718_SBS.P166_EAL2SecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P166_EAL2SecSubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF\r\n                                       \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P166_EAL2SecSubtotal, \"P166_EAL2SecSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P168_EAL3SecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EALSecP3PupilCharac_String As String = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_3_Secondary_Proportion]\r\n    Dim EALSecondaryP3Adj_String As String = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_3_Secondary_Proportion\r\n    Dim LAAV_EALSecP3 As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.Weights.Local_Authority_Averages.Local_Authority_Averages.EAL_3_Secondary_Proportion])    \r\n    Dim PupilCharacCensusEALSecP3 As Decimal = [DataSets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.EAL_3_Secondary_Proportion]\r\n    Dim AdjEALSecP3 As Decimal = DataSets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.EAL_3_Secondary_Proportion\r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n      If string.IsNullOrEmpty(EALSecP3PupilCharac_String) And String.IsNullOrEmpty(EALSecondaryP3Adj_String) then\r\n            \r\n            Result = LAAV_EALSecP3\r\n            \r\n            Else\r\n                                    \r\n                If String.IsNullOrEmpty(EALSecondaryP3Adj_String) then\r\n                \r\n                Result = PupilCharacCensusEALSecP3  \r\n                \r\n                Else \r\n                \r\n                Result = AdjEALSecP3\r\n                \r\n                End If\r\n                \r\n            End If\r\n    \r\n            Else \r\n            \r\n            exclude(rid)\r\n            \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EALSecP3PupilCharac_String, \"EALSecP3PupilCharac_String\", rid)\r\n      Print(EALSecondaryP3Adj_String, \"EALSecondaryP3Adj_String\", rid)\r\n      Print(LAAV_EALSecP3, \"LAAV_EALSecP3\", rid)\r\n      Print(PupilCharacCensusEALSecP3, \"PupilCharacCensusEALSecP3\", rid)\r\n      Print(AdjEALSecP3, \"AdjEALSecP3\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P170_EAL3SecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Secondary As String = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_1/2/3/NA)\r\n    Dim EAL_Secondary_Amount_Per_Pupil As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_Amount_Per_Pupil)\r\n    \r\n\r\n     If F200_SBS_Academies = 1 then\r\n                   \r\n         If EAL_Secondary = \"EAL 3 Secondary\" Then \r\n          Result = EAL_Secondary_Amount_Per_Pupil \r\n          Else Result = 0\r\n          End IF\r\n     Else \r\n     exclude(rid)                                          \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Secondary, \"EEAL_Secondary_1/2/3/NA\", rid)\r\n      Print(EAL_Secondary_Amount_Per_Pupil, \"EAL_Secondary_Amount_Per_Pupil\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P171_EAL3SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F100_AllAcademies As Double = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P170_EAL3SecRate As Decimal = Products.1718_SBS.P170_EAL3SecRate\r\n    Dim P168_EAL3SecFactor As Decimal = Products.1718_SBS.P168_EAL3SecFactor\r\n    Dim P25_Total_NOR_SEC_SBS As Decimal = Products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim calc As Decimal = P25_Total_NOR_SEC_SBS * P170_EAL3SecRate * P168_EAL3SecFactor\r\n    Dim EAL_S As Decimal = LAToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.EAL_S)\r\n    \r\n       If F200_SBS_Academies <> 1 Then\r\n          exclude(rid)                         \r\n        End if\r\n        \r\n       If (F100_AllAcademies = 17181) Or (FundingBasis = 2 And F100_AllAcademies = 17182) Or (FundingBasis = 2 And F100_AllAcademies = 17183) then  \r\n          result = calc\r\n          Else \r\n          If (FundingBasis = 1 And F100_AllAcademies = 17182) Or (FundingBasis = 1 And F100_AllAcademies = 17183) then  'new opener\r\n            If P170_EAL3SecRate>0           \r\n            Result = EAL_S\r\n            Else Result = 0\r\n            End If\r\n          End If  \r\n       End If   \r\n         \r\n       \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P170_EAL3SecRate, \"P170_EAL3SecRate\", rid)\r\n      Print(P168_EAL3SecFactor, \"P168_EAL3SecFactor\", rid)\r\n      Print(P25_Total_NOR_SEC_SBS, \"P25_Total_NOR_SEC_SBS\", rid)\r\n      Print(EAL_S, \"EAL_S\", rid)\r\n      Print(calc, \"calc\", rid)\r\n      \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":2},{"Name":"P172_NSENSecEAL","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P161_EAL1SecSubtotal As Decimal =Products.1718_SBS.P161_EAL1SecSubtotal \r\n    Dim P166_EAL2SecSubtotal As Decimal =Products.1718_SBS.P166_EAL2SecSubtotal \r\n    Dim P171_EAL3SecSubtotal As Decimal =Products.1718_SBS.P171_EAL3SecSubtotal \r\n    Dim P172a_NSENSecEAL_Percent As Decimal = Products.1718_SBS.P172a_NSENSecEAL_Percent / 100 \r\n    \r\n    \r\n\r\n     If F200_SBS_Academies = 1 then  \r\n           Result =  (P161_EAL1SecSubtotal + P166_EAL2SecSubtotal + P171_EAL3SecSubtotal) * P172a_NSENSecEAL_Percent\r\n           Else \r\n         exclude(rid)     \r\n        End If\r\n                                                                                        \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P161_EAL1SecSubtotal, \"P161_EAL1SecSubtotal\", rid)\r\n      Print(P166_EAL2SecSubtotal, \"P166_EAL2SecSubtotal\", rid)\r\n      Print(P171_EAL3SecSubtotal, \"P171_EAL3SecSubtotal\", rid)\r\n      Print(P172a_NSENSecEAL_Percent, \"P172a_NSENSecEAL_Percent\", rid)\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P173_InYearEAL3SecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As   Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P171_EAL3SecSubtotal As Decimal = Products.1718_SBS.P171_EAL3SecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n        \r\n      \r\n       If F200_SBS_Academies = 1 then\r\n            Result = P171_EAL3SecSubtotal * P001_1718DaysOpen / Year_Days\r\n            ELSE\r\n            Exclude(rid)\r\n        End IF                 \r\n                                 \r\n       \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(P171_EAL3SecSubtotal, \"P171_EAL3SecSubtotal\", rid)\r\n      Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid) \r\n      Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":6},{"Name":"P172a_NSENSecEAL_Percent","Script":"  Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim EAL_Secondary_Notional_SEN As Decimal = LaToProv(DataSets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.EAL_Secondary_Notional_SEN)\r\n  \r\n\r\n     If F200_SBS_Academies = 1 then      \r\n           Result = EAL_Secondary_Notional_SEN * 100   \r\n           Else \r\n           exclude(rid)     \r\n    End If\r\n            \r\n      \r\n      Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n      Print(FundingBasis,\"FundingBasis\",rid)\r\n      Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n      Print(EAL_Secondary_Notional_SEN, \"EAL_Secondary_Notional_SEN\", rid)\r\n      \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"EAL","DecimalPlaces":0},{"Name":"P174_MobPriFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_Mobility_Primary_Proportion]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Mobility_Primary_Proportion]\r\n    Dim [APT_Inputs_and_Adjustments_Mobility_Primary_Proportion] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Mobility_Primary_Proportion]\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n     Dim ModPriProAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Mobility_Primary_Proportion\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(ModPriProAdjString) Then \r\n            If [Census_Pupil_Characteristics_Mobility_Primary_Proportion]>0.1 Then\r\n                result = [Census_Pupil_Characteristics_Mobility_Primary_Proportion] -0.1\r\n            Else \r\n                result = 0\r\n            End if\r\n        Else \r\n            If [APT_Inputs_and_Adjustments_Mobility_Primary_Proportion]>0.1 Then\r\n                result = [APT_Inputs_and_Adjustments_Mobility_Primary_Proportion] -0.1\r\n            Else \r\n                result = 0\r\n            End if\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    \r\n \r\n    Print(Census_Pupil_Characteristics_Mobility_Primary_Proportion, \"Census_Pupil_Characteristics_Mobility_Primary_Proportion\", rid) \r\n    Print(APT_Inputs_and_Adjustments_Mobility_Primary_Proportion, \"APT_Inputs_and_Adjustments_Mobility_Primary_Proportion\", rid) \r\n     \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P176_MobPriRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Mobility_Primary_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P177_MobPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P22 As Decimal = products.1718_NOR.NOR_P22_Total_NOR_PRI_SBS\r\n    Dim P174_MobPriFactor As Decimal = products.1718_SBS.P174_MobPriFactor\r\n    Dim P176_MobPriRate As Decimal = products.1718_SBS.P176_MobPriRate\r\n    Dim APT_ISB_Mobility_Primary As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Mobility_P\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n\r\n\r\n    If F200 = 1 then\r\n    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n        Result = SBS_P22*P176_MobPriRate*P174_MobPriFactor \r\n        ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1 Then \r\n        result = APT_ISB_Mobility_Primary\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    \r\n    Else \r\n        \r\n        exclude(rid)\r\n\r\n    End if\r\n        \r\n    Print(SBS_P22, \"SBS_P22\", rid)\r\n    Print(P174_MobPriFactor, \"P174_MobPriFactor\", rid)\r\n    Print(P176_MobPriRate, \"P176_MobPriRate\", rid)\r\n    Print(APT_ISB_Mobility_Primary, \"APT_ISB_Mobility_Primary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":2},{"Name":"P178_NSENMobPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P177_MobPriSubtotal As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P178a_NSENMobPri_Percent As Decimal = products.1718_SBS.P178a_NSENMobPri_Percent /100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P177_MobPriSubtotal*P178a_NSENMobPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P177_MobPriSubtotal, \"P177_MobPriSubtotal\", rid)\r\n    Print(P178a_NSENMobPri_Percent,\"P178a_NSENMobPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P178a_NSENMobPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Mobility_Primary_Notional_SEN])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN *100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P179_InYearMobPriSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P177_MobPriSubtotal As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P177_MobPriSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P177_MobPriSubtotal, \"P177_MobPriSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P180_MobSecFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim [Census_Pupil_Characteristics_Mobility_Secondary_Proportion]  As Double = [datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Mobility_Secondary_Proportion]\r\n    Dim [APT_Inputs_and_Adjustments_Mobility_Secondary_Proportion] As Double = [datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Mobility_Secondary_Proportion]\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim MobSecProAdj as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Mobility_Secondary_Proportion \r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(MobSecProAdj) Then \r\n            If [Census_Pupil_Characteristics_Mobility_Secondary_Proportion]>0.1 Then\r\n                result = [Census_Pupil_Characteristics_Mobility_Secondary_Proportion] -0.1\r\n            Else \r\n                result = 0\r\n            End if\r\n        Else \r\n            If [APT_Inputs_and_Adjustments_Mobility_Secondary_Proportion]>0.1 Then\r\n                result = [APT_Inputs_and_Adjustments_Mobility_Secondary_Proportion] -0.1\r\n            Else \r\n                result = 0\r\n            End if\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    \r\n \r\n    Print(Census_Pupil_Characteristics_Mobility_Secondary_Proportion, \"Census_Pupil_Characteristics_Mobility_Secondary_Proportion\", rid) \r\n    Print(APT_Inputs_and_Adjustments_Mobility_Secondary_Proportion, \"APT_Inputs_and_Adjustments_Mobility_Secondary_Proportion\", rid) \r\n     \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P182_MobSecRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_PP As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Mobility_Secondary_Amount_Per_Pupil)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = APT_PP\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(APT_PP, \"APT_PP\", rid)\r\n   \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P183_MobSecSubtotal","Script":"     Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SBS_P25 As Decimal = products.1718_NOR.NOR_P25_Total_NOR_SEC_SBS\r\n    Dim P180_MobSecFactor As Decimal = products.1718_SBS.P180_MobSecFactor\r\n    Dim P182_MobSecRate As Decimal = products.1718_SBS.P182_MobSecRate\r\n    Dim APT_ISB_Mobility_Secondary As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Mobility_S\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal =  products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n\r\nIf F200 = 1 then\r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n    Result = SBS_P25*P182_MobSecRate*P180_MobSecFactor \r\n    ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n    result = APT_ISB_Mobility_Secondary\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\nelse \r\n    exclude(rid)\r\n    \r\nEnd if\r\n    \r\n    Print(SBS_P25, \"SBS_P25\", rid)\r\n    Print(P180_MobSecFactor, \"P180_MobSecFactor\", rid)\r\n    Print(P182_MobSecRate, \"P182_MobSecRate\", rid)\r\n    Print(APT_ISB_Mobility_Secondary, \"APT_ISB_Mobility_Secondary\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":2},{"Name":"P184_NSENMobSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P183_MobSecSubtotal As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n    Dim P184a_NSENMobSec_Percent As Decimal = products.1718_SBS.P184a_NSENMobSec_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P184a_NSENMobSec_Percent*P183_MobSecSubtotal\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(P183_MobSecSubtotal, \"P183_MobSecSubtotal\", rid)\r\n    Print(P184a_NSENMobSec_Percent,\"P184a_NSENMobSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P184a_NSENMobSec_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Mobility_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN * 100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P185_InYearMobSecSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P183_MobSecSubtotal As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P183_MobSecSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P183_MobSecSubtotal, \"P183_MobSecSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Mobility","DecimalPlaces":6},{"Name":"P185a_Phase","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim APT_Inputs_and_Adjustments_Phase As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Phase \r\n    Dim Census_Pupil_Characteristics_Phase As String = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Phase\r\n    Dim PhaseString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Phase\r\n    \r\n    Print(APT_Inputs_and_Adjustments_Phase, \"APT_Inputs_and_Adjustments_Phase\", rid)\r\n    Print(Census_Pupil_Characteristics_Phase, \"Census_Pupil_Characteristics_Phase\", rid)\r\n \r\nIf AcadFilter = 1 Then                                 \r\n    If string.IsNullOrEmpty(PhaseString) Then\r\n        If Census_Pupil_Characteristics_Phase = \"Primary\" Then\r\n            result = 1      \r\n        Else If Census_Pupil_Characteristics_Phase =  \"Middle-deemed Primary\" Then\r\n            result = 2\r\n        Else If Census_Pupil_Characteristics_Phase = \"Secondary\" Then\r\n            result = 3\r\n        Else If Census_Pupil_Characteristics_Phase = \"Middle-deemed Secondary\" Then\r\n            result = 4\r\n        Else If Census_Pupil_Characteristics_Phase = \"All-through\" Then\r\n            result = 5\r\n        Else\r\n            result = 0\r\n        End If\r\n    Else    \r\n        If  APT_Inputs_and_Adjustments_Phase = \"Primary\" Then\r\n            result = 1\r\n        Else If APT_Inputs_and_Adjustments_Phase =  \"Middle-deemed Primary\" Then\r\n            result = 2\r\n        Else If APT_Inputs_and_Adjustments_Phase = \"Secondary\" Then\r\n            result = 3\r\n        Else If APT_Inputs_and_Adjustments_Phase = \"Middle-deemed Secondary\" Then\r\n            result = 4\r\n        Else If APT_Inputs_and_Adjustments_Phase = \"All-through\" Then\r\n            result = 5\r\n        Else\r\n            result = 0\r\n        End If\r\n    End If\r\nElse\r\nexclude(rid)\r\nEnd If\r\n    \r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":0},{"Name":"P186_SparsityTaperFlagPri","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Decimal\r\n    \r\n    Dim AcadFilter As Decimal  = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SBS_SparsityTaperFlagPri As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Fixed_or_tapered_sparsity_primary_lump_sum]) \r\n    \r\n    If AcadFilter = 1 Then\r\n        If SBS_SparsityTaperFlagPri = \"Tapered\" Then\r\n            result = 1\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(SBS_SparsityTaperFlagPri, \"SBS_SparsityTaperFlagPri\", rid) \r\n  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":0},{"Name":"P187_SparsityTaperFlagMid","Script":"    Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Decimal\r\n    \r\n    Dim AcadFilter As Decimal  = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SBS_SparsityTaperFlagMid As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Fixed_or_tapered_sparsity_middle_school_lump_sum]) \r\n    \r\n    If AcadFilter = 1 Then\r\n        If SBS_SparsityTaperFlagMid = \"Tapered\" Then\r\n            result = 1\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(SBS_SparsityTaperFlagMid, \"SBS_SparsityTaperFlagMid\", rid) \r\n  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P188_SparsityTaperFlagSec","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Decimal\r\n    \r\n    Dim AcadFilter As Decimal  = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SBS_SparsityTaperFlagSec As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Fixed_or_tapered_sparsity_secondary_lump_sum]) \r\n    \r\n    If AcadFilter = 1 Then\r\n        If SBS_SparsityTaperFlagSec = \"Tapered\" Then\r\n            result = 1\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(SBS_SparsityTaperFlagSec, \"SBS_SparsityTaperFlagSec\", rid) \r\n  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P189_SparsityTaperFlagAllthru","Script":"Public Function GetProductResult(rid As String) As Double\r\n    Dim result As Decimal\r\n    \r\n    Dim AcadFilter As Decimal  = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SBS_SparsityTaperFlagSec As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Fixed_or_tapered_sparsity_all-through_lump_sum]) \r\n    \r\n    If AcadFilter = 1 Then\r\n        If SBS_SparsityTaperFlagSec = \"Tapered\" Then\r\n            result = 1\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n \r\n    Print(SBS_SparsityTaperFlagSec, \"SBS_SparsityTaperFlagSec\", rid) \r\n  \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P190_SparsityUnit","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim PriLumpSum As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Sparsity_Primary_Lump_Sum)\r\n    Dim SecLumpSum As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Sparsity_Secondary_Lump_Sum)\r\n    Dim MidLumpSum As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Sparsity_Middle_School_Lump_Sum)\r\n    Dim AllLumpSum As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Sparsity_All-Through_Lump_Sum])\r\n    \r\n    \r\n    If AcadFilter = 1 Then \r\n        If Phase = 1 Then\r\n            result = PriLumpSum\r\n        Else If Phase = 2 Or Phase = 4 Then\r\n            result = MidLumpSum\r\n        Else If Phase = 3 Then\r\n            result = SecLumpSum\r\n        Else If Phase = 5 Then\r\n            result = AllLumpSum\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Phase, \"Phase\", rid)  \r\n    Print(PriLumpSum, \"PriLumpSum\", rid)   \r\n    Print(SecLumpSum, \"SecLumpSum\", rid)\r\n    Print(MidLumpSum, \"MidLumpSum\", rid)\r\n    Print(AllLumpSum, \"AllLumpSum\", rid)\r\n   \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P191_SparsityDistance","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim PriDistanceCensus As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Primary_sparsity_av_Distance_to_2nd_school\r\n    Dim PriDistanceIandA As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_sparsity_av_Distance_to_2nd_school_miles\r\n    Dim SecDistanceCensus As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.Secondary_sparsity_av_Distance_to_2nd_school\r\n    Dim SecDistanceIandA As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_sparsity_av_Distance_to_2nd_school_miles\r\n    Dim PriDistAdjString as string = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Primary_sparsity_av_Distance_to_2nd_school_miles   \r\n    Dim SecDistAdjString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.Secondary_sparsity_av_Distance_to_2nd_school_miles\r\nIf AcadFilter = 1 Then \r\n    If Phase = 1 Then\r\n        If string.IsNullOrEmpty(PriDistAdjString) Then\r\n        result = PriDistanceCensus\r\n        Else\r\n        result = PriDistanceIandA\r\n        End if\r\n    Else\r\n         If string.IsNullOrEmpty(SecDistAdjString) Then\r\n        result = SecDistanceCensus\r\n        Else\r\n        result = SecDistanceIandA\r\n        End if\r\n    End if        \r\nElse\r\nexclude(rid)\r\nEnd if\r\n    \r\n    Print(Phase, \"Phase\", rid)  \r\n    Print(PriDistanceIandA, \"PriDistanceIandA\", rid)\r\n    Print(PriDistanceCensus, \"PriDistanceCensus\", rid)\r\n    Print(SecDistanceIandA, \"SecDistanceIandA\", rid)\r\n    Print(SecDistanceCensus, \"SecDistanceCensus\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"p192_SparsityDistThreshold","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim PriDistanceThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_Distance_Threshold])\r\n    Dim MidDistanceThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Middle_School_Distance_Threshold])\r\n    Dim SecDistanceThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_Distance_Threshold])\r\n    Dim AllthruDistanceThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.All-Through_Distance_Threshold])\r\n    Dim PriDistanceThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_Distance_Threshold])\r\n    Dim MidDistanceThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Middle_School_Distance_Threshold])\r\n    Dim SecDistanceThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_Distance_Threshold])\r\n    Dim AllthruDistanceThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.All-Through_Distance_Threshold])\r\n      \r\n    \r\nIf AcadFilter = 1 Then \r\n    If Phase = 1 Then\r\n        If string.IsNullOrEmpty(PriDistanceThresholdString) Then\r\n        result = 2\r\n        Else\r\n        result = PriDistanceThreshold\r\n        End if\r\n   Else If Phase = 2 Or Phase = 4 Then\r\n        If string.IsNullOrEmpty(MidDistanceThresholdString) Then\r\n        result = 2\r\n        Else\r\n        result = MidDistanceThreshold\r\n        End if\r\n   Else If Phase = 3 Then\r\n        If string.IsNullOrEmpty(SecDistanceThresholdString) Then\r\n        result = 3\r\n        Else\r\n        result = SecDistanceThreshold\r\n        End if \r\n   Else If Phase = 5 Then\r\n        If string.IsNullOrEmpty(AllthruDistanceThresholdString) Then\r\n        result = 2\r\n        Else\r\n        result = AllthruDistanceThreshold\r\n        End if\r\n    Else\r\n    result = 0    \r\n    End if        \r\nElse\r\nexclude(rid)\r\nEnd if\r\n    \r\n    Print(Phase, \"Phase\", rid)  \r\n    Print(PriDistanceThreshold, \"PriDistanceThreshold\", rid)\r\n    Print(MidDistanceThreshold, \"MidDistanceThreshold\", rid)\r\n    Print(SecDistanceThreshold, \"SecDistanceThreshold\", rid)\r\n    Print(AllthruDistanceThreshold, \"AllthruDistanceThreshold\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P193_SparsitydistMet_YN","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P191_SparsityDistance As Decimal = products.1718_SBS.P191_SparsityDistance\r\n    Dim P192_SparsityDistThreshold As Decimal = products.1718_SBS.P192_SparsityDistThreshold\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If P191_SparsityDistance >= P192_SparsityDistThreshold Then\r\n            result = 1\r\n        Else\r\n            result = 0\r\n        End if\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    \r\n    \r\n    Print(P191_SparsityDistance, \"P191_SparsityDistance\", rid)\r\n    Print(P192_SparsityDistThreshold, \"P192_SparsityDistThreshold\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P194_SparsityAveYGSize","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim NOR26 As Decimal = products.1718_NOR.NOR_P26_Total_NOR_SBS\r\n    Dim AcadFilter As Decimal  = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P212_PYG As Decimal = products.1718_SBS.P212_PYG\r\n    Dim P213_SYG As Decimal = products.1718_SBS.P213_SYG\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = NOR26/(P212_PYG + P213_SYG)\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    \r\n    Print(NOR26, \"NOR26\", rid)\r\n    Print(P212_PYG, \"P212_PYG\", rid)\r\n    Print(P213_SYG, \"P213_SYG\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Learners","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P195_SparsityYGThreshold","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim PriAveYGThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_pupil_number_average_year_group_threshold])\r\n    Dim MidAveYGThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Middle_School_pupil_number_average_year_group_threshold])\r\n    Dim SecAveYGThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_pupil_number_average_year_group_threshold])\r\n    Dim AllthruAveYGThreshold As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.All-Through_pupil_number_average_year_group_threshold])\r\n    Dim PriAveYGThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_pupil_number_average_year_group_threshold])\r\n    Dim MidAveYGThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Middle_School_pupil_number_average_year_group_threshold])\r\n    Dim SecAveYGThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_pupil_number_average_year_group_threshold])\r\n    Dim AllthruAveYGThresholdString As String = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.All-Through_pupil_number_average_year_group_threshold])\r\n    \r\n    \r\nIf AcadFilter = 1 Then \r\n    If Phase = 1 Then\r\n        If string.IsNullOrEmpty(PriAveYGThresholdString) Then\r\n        result = 21.4\r\n        Else\r\n        result = PriAveYGThreshold\r\n        End if\r\n   Else If Phase = 2 Or Phase = 4 Then\r\n        If string.IsNullOrEmpty(MidAveYGThresholdString) Then\r\n        result = 69.2\r\n        Else\r\n        result = MidAveYGThreshold\r\n        End if\r\n   Else If Phase = 3 Then\r\n        If string.IsNullOrEmpty(SecAveYGThresholdString) Then\r\n        result = 120\r\n        Else\r\n        result = SecAveYGThreshold\r\n        End if \r\n   Else If Phase = 5 Then\r\n        If string.IsNullOrEmpty(AllthruAveYGThresholdString) Then\r\n        result = 62.5\r\n        Else\r\n        result = AllthruAveYGThreshold\r\n        End if\r\n    Else\r\n    result = 0    \r\n    End if        \r\nElse\r\nexclude(rid)\r\nEnd if\r\n    \r\n    Print(Phase, \"Phase\", rid)  \r\n    Print(PriAveYGThreshold, \"PriAveYGThreshold\", rid)\r\n    Print(MidAveYGThreshold, \"MidAveYGThreshold\", rid)\r\n    Print(SecAveYGThreshold, \"SecAveYGThreshold\", rid)\r\n    Print(AllthruAveYGThreshold, \"AllthruAveYGThreshold\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P196_SparsityYGThresholdMet_YN","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P194_SparsityAveYGSize As Decimal = products.1718_SBS.P194_SparsityAveYGSize \r\n    Dim P195_SparsityYGThreshold As Decimal = products.1718_SBS.P195_SparsityYGThreshold\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n        If P194_SparsityAveYGSize <= P195_SparsityYGThreshold And P194_SparsityAveYGSize > 0 Then\r\n        result = 1\r\n        Else\r\n        result = 0\r\n        End if\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    \r\n    Print(P194_SparsityAveYGSize, \"P194_SparsityAveYGSize\", rid)\r\n    Print(P195_SparsityYGThreshold, \"P195_SparsityYGThreshold\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P197_SparsitylumpSumSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim P186_SparsityTaperFlagPri As Decimal = products.1718_SBS.P186_SparsityTaperFlagPri\r\n    Dim P193_SparsityDistMet_YN   As Decimal = products.1718_SBS.P193_SparsityDistMet_YN\r\n    Dim P196_SparsityYGThresholdMet_YN  As Decimal = products.1718_SBS.P196_SparsityYGThresholdMet_YN\r\n    Dim P190_SparsityUnit         As Decimal = products.1718_SBS.P190_SparsityUnit\r\n    Dim P187_SparsityTaperFlagMid As Decimal = products.1718_SBS.P187_SparsityTaperFlagMid\r\n    Dim P188_SparsityTaperFlagSec As Decimal = products.1718_SBS.P188_SparsityTaperFlagSec\r\n    Dim P189_SparsityTaperFlagAllthru As Decimal = products.1718_SBS.P189_SparsityTaperFlagAllthru\r\n    Dim APT_ISB_SparsityFunding As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Sparsity_Funding\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n        \r\nIf F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n        If Phase = 1 And P186_SparsityTaperFlagPri = 0 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit\r\n        Else\r\n        result = 0\r\n               \r\n        If Phase = 2 And P187_SparsityTaperFlagMid = 0 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit\r\n        Else\r\n        result = 0\r\n        \r\n        If Phase = 4 And P187_SparsityTaperFlagMid = 0 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit\r\n        Else\r\n        result = 0\r\n              \r\n        If Phase = 3 And P188_SparsityTaperFlagSec = 0 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit\r\n        Else\r\n        result = 0\r\n        \r\n        If Phase = 5 And P189_SparsityTaperFlagAllthru = 0 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit\r\n        Else\r\n        result = 0\r\n        End if\r\n        End if\r\n        End if\r\n        End if\r\n        End if\r\nElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\nresult = APT_ISB_SparsityFunding\r\nElse\r\nExclude(rid)\r\nEnd If\r\n    \r\n    \r\n    Print(Phase, \"Phase\", rid)\r\n    Print(P190_SparsityUnit, \"P190_SparsityUnit\", rid)\r\n    Print(P193_SparsityDistMet_YN, \"P193_SparsityDistMet_YN\", rid)\r\n    Print(P196_SparsityYGThresholdMet_YN, \"P196_SparsityYGThresholdMet_YN\", rid)\r\n    Print(P186_SparsityTaperFlagPri, \"P186_SparsityTaperFlagPri\", rid)\r\n    Print(P187_SparsityTaperFlagMid, \"P187_SparsityTaperFlagMid\", rid)\r\n    Print(P188_SparsityTaperFlagSec, \"P188_SparsityTaperFlagSec\", rid)\r\n    Print(P189_SparsityTaperFlagAllthru, \"P189_SparsityTaperFlagAllthru\", rid)\r\n    Print(F100_AllAcademies, \"F100_Academies\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P198_SparsityTaperSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n  \r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim P186_SparsityTaperFlagPri As Decimal = products.1718_SBS.P186_SparsityTaperFlagPri\r\n    Dim P193_SparsityDistMet_YN   As Decimal = products.1718_SBS.P193_SparsityDistMet_YN\r\n    Dim P196_SparsityYGThresholdMet_YN  As Decimal = products.1718_SBS.P196_SparsityYGThresholdMet_YN\r\n    Dim P190_SparsityUnit         As Decimal = products.1718_SBS.P190_SparsityUnit\r\n    Dim P187_SparsityTaperFlagMid As Decimal = products.1718_SBS.P187_SparsityTaperFlagMid\r\n    Dim P188_SparsityTaperFlagSec As Decimal = products.1718_SBS.P188_SparsityTaperFlagSec\r\n    Dim P189_SparsityTaperFlagAllthru As Decimal = products.1718_SBS.P189_SparsityTaperFlagAllthru\r\n    Dim APT_ISB_SparsityFunding As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Sparsity_Funding\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P194_SparsityAveYGSize As Decimal = products.1718_SBS.P194_SparsityAveYGSize\r\n    Dim P195_SparsityYGThreshold As Decimal = products.1718_SBS.P195_SparsityYGThreshold\r\n    \r\n    \r\n        \r\nIf F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n        If Phase = 1 And P186_SparsityTaperFlagPri = 1 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit * (1-(P194_SparsityAveYGSize/P195_SparsityYGThreshold))\r\n        Else\r\n        result = 0\r\n               \r\n        If Phase = 2 And P187_SparsityTaperFlagMid = 1 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit * (1-(P194_SparsityAveYGSize/P195_SparsityYGThreshold))\r\n        Else\r\n        result = 0\r\n        \r\n        If Phase = 4 And P187_SparsityTaperFlagMid = 1 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit * (1-(P194_SparsityAveYGSize/P195_SparsityYGThreshold))\r\n        Else\r\n        result = 0\r\n               \r\n        If Phase = 3 And P188_SparsityTaperFlagSec =1 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit * (1-(P194_SparsityAveYGSize/P195_SparsityYGThreshold))\r\n        Else\r\n        result = 0\r\n        \r\n        If Phase = 5 And P189_SparsityTaperFlagAllthru = 1 And P193_SparsityDistMet_YN = 1 And P196_SparsityYGThresholdMet_YN = 1 then\r\n        result = P190_SparsityUnit * (1-(P194_SparsityAveYGSize/P195_SparsityYGThreshold))\r\n        Else\r\n        result = 0\r\n        End if\r\n        End if\r\n        End if\r\n        End if\r\n        End if\r\nElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\nresult = 0\r\nElse\r\nExclude(rid)\r\nEnd If\r\n    \r\n    \r\n    Print(Phase, \"Phase\", rid)\r\n    Print(P190_SparsityUnit, \"P190_SparsityUnit\", rid)\r\n    Print(P193_SparsityDistMet_YN, \"P193_SparsityDistMet_YN\", rid)\r\n    Print(P196_SparsityYGThresholdMet_YN, \"P196_SparsityYGThresholdMet_YN\", rid)\r\n    Print(P195_SparsityYGThreshold, \"P195_SparsityYGThreshold\", rid)\r\n    Print(P194_SparsityAveYGSize, \"P194_SparsityAveYGSize\", rid)\r\n    Print(P186_SparsityTaperFlagPri, \"P186_SparsityTaperFlagPri\", rid)\r\n    Print(P187_SparsityTaperFlagMid, \"P187_SparsityTaperFlagMid\", rid)\r\n    Print(P188_SparsityTaperFlagSec, \"P188_SparsityTaperFlagSec\", rid)\r\n    Print(P189_SparsityTaperFlagAllthru, \"P189_SparsityTaperFlagAllthru\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P198a_SubtotalLump_Taper_For_FAP_Only","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P197_SparsityLumpSumSubtotal As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P198_SparsityTaperSubtotal As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P197_SparsityLumpSumSubtotal + P198_SparsityTaperSubtotal \r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(P198_SparsityTaperSubtotal, \"P198_SparsityTaperSubtotal\", rid)\r\n    Print(P197_SparsityLumpSumSubtotal, \"P197_SparsityLumpSumSubtotal\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P199_InyearSparsityLumpSumSubtotal","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P197_SparsityLumpSumSubtotal As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P197_SparsityLumpSumSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P197_SparsityLumpSumSubtotal, \"P197_SparsityLumpSumSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":5},{"Name":"P200_InYearSparsityTaperSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P198_SparsityTaperSubtotal As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P198_SparsityTaperSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P198_SparsityTaperSubtotal, \"P198_SparsityTaperSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P200a_InYear_SubtotalLump_Taper_For_Fap_only","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P199_InYearSparsityLumpSumSubtotal As Decimal = products.1718_SBS.P199_InYearSparsityLumpSumSubtotal\r\n    Dim P200_InYearSparsityTaperSubtotal As Decimal = products.1718_SBS.P200_InYearSparsityTaperSubtotal\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P199_InYearSparsityLumpSumSubtotal + P200_InYearSparsityTaperSubtotal \r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(P200_InYearSparsityTaperSubtotal, \"P200_InYearSparsityTaperSubtotal\", rid)\r\n    Print(P199_InYearSparsityLumpSumSubtotal, \"P199_InYearSparsityLumpSumSubtotal\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P212_PYG","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim NOR42a As Decimal = products.1718_NOR.NOR_P42a_Year_Groups_Primary\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = NOR42a\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(NOR42a, \"NOR42a\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":0},{"Name":"P213_SYG","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim NOR42b As Decimal = products.1718_NOR.NOR_P42b_Year_Groups_Secondary\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = NOR42b\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(NOR42b, \"NOR42b\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":0},{"Name":"P236_NSENSparsity","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P197_SparsityLumpSumSubtotal As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P198_SparsityTaperSubtotal As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim P236a_NSENSparsity_Percent As Decimal = products.1718_SBS.P236a_NSENSparsity_Percent /100\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = (P197_SparsityLumpSumSubtotal + P198_SparsityTaperSubtotal)*P236a_NSENSparsity_Percent\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(P198_SparsityTaperSubtotal, \"P198_SparsityTaperSubtotal\", rid)\r\n    Print(P197_SparsityLumpSumSubtotal, \"P197_SparsityLumpSumSubtotal\", rid)\r\n    Print(P236a_NSENSparsity_Percent, \"P236a_NSENSparsity_Percent\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P236a_NSENSparsity_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    Dim PriSparsityNotionalSEN As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_Sparsity_Notional_SEN])\r\n    Dim SecSparsityNotionalSEN As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_Sparsity_Notional_SEN])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then \r\n        If Phase = 1 Then   \r\n        result = PriSparsityNotionalSEN *100\r\n        Else If Phase = 2 Or Phase = 3 Or Phase = 4 Or Phase =5 Then\r\n        result = SecSparsityNotionalSEN *100\r\n        Else \r\n        result = 0\r\n        End if\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n      Print(Phase, \"Phase\", rid)\r\n      Print(PriSparsityNotionalSEN, \"PriSparsityNotionalSEN\", rid)\r\n      Print(SecSparsityNotionalSEN, \"SecSparsityNotionalSEN\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Sparsity","DecimalPlaces":6},{"Name":"P239_PriLumpSumFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim P212_PYG As Decimal = products.1718_SBS.P212_PYG \r\n    Dim P213_SYG As Decimal = products.1718_SBS.P213_SYG\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    \r\n    If AcadFilter = 1 Then\r\n        If P212_PYG = 0 And P213_SYG = 0 Then\r\n            result = 0\r\n            Else\r\n            If Phase = 1 Then\r\n                result = 1\r\n                Else If Phase = 2 Or Phase = 4 Then\r\n                result = P212_PYG/(P212_PYG + P213_SYG)\r\n                Else\r\n                result = 0\r\n            End If\r\n        End If\r\n        Else\r\n        exclude(rid)\r\n    End If\r\n \r\n    \r\n    Print(Phase, \"Phase\", rid)\r\n    Print(P212_PYG, \"P212_PYG\", rid)\r\n    Print(P213_SYG, \"P213_SYG\", rid)\r\n    \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P240_PriLumpSumRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim PrimaryLumpSum As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_Lump_Sum)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = PrimaryLumpSum\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(PrimaryLumpSum, \"PrimaryLumpSum\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P241_priLumpSumSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P239_PriLumpSumFactor As Decimal = products.1718_SBS.P239_PriLumpSumFactor\r\n    Dim P240_PriLumpSumRate As Decimal = products.1718_SBS.P240_PriLumpSumRate\r\n    Dim APT_ISB_LumpSum As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Lump_Sum\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n        \r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n    Result = P239_PriLumpSumFactor*P240_PriLumpSumRate \r\n    ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1 Then \r\n    result = APT_ISB_LumpSum\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n        \r\n    \r\n    Print(P239_PriLumpSumFactor, \"P239_PriLumpSumFactor\", rid)\r\n    Print(P240_PriLumpSumRate, \"P240_PriLumpSumRate\", rid)\r\n    Print(APT_ISB_LumpSum, \"APT_ISB_LumpSum\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P242_InYearPriLumpSumSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P241_PriLumpSumSubtotal As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P241_PriLumpSumSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P241_PriLumpSumSubtotal, \"P241_PriLumpSumSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P243_SecLumpSumFactor","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies \r\n    Dim P212_PYG As Decimal = products.1718_SBS.P212_PYG \r\n    Dim P213_SYG As Decimal = products.1718_SBS.P213_SYG\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    \r\n    If AcadFilter = 1 Then\r\n        If P212_PYG = 0 And P213_SYG = 0 Then\r\n            result = 0\r\n            Else\r\n            If Phase = 3 Or Phase = 5 Then\r\n                result = 1\r\n                Else If Phase = 2 Or Phase = 4 Then\r\n                result = P213_SYG/(P212_PYG + P213_SYG)\r\n                Else\r\n                result = 0\r\n            End If\r\n        End If\r\n        Else\r\n        exclude(rid)\r\n    End If\r\n \r\n    \r\n    Print(Phase, \"Phase\", rid)\r\n    Print(P212_PYG, \"P212_PYG\", rid)\r\n    Print(P213_SYG, \"P213_SYG\", rid)\r\n    \r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P244_SecLumpSumRate","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim SecondaryLumpSum As Double = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_Lump_Sum)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = SecondaryLumpSum\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(SecondaryLumpSum, \"SecondaryLumpSum\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P245_SecLumpSumSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P243_SecLumpSumFactor As Decimal = products.1718_SBS.P243_SecLumpSumFactor\r\n    Dim P244_SecLumpSumRate As Decimal = products.1718_SBS.P244_SecLumpSumRate\r\n    Dim APT_ISB_LumpSum As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Lump_Sum\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n        \r\n    If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n    Result = P243_SecLumpSumFactor*P244_SecLumpSumRate \r\n    ElseIf F100_AllAcademies <> 17181 And FundingBasis = 1  Then \r\n    result = APT_ISB_LumpSum\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n        \r\n    \r\n    Print(P243_SecLumpSumFactor, \"P239_PriLumpSumFactor\", rid)\r\n    Print(P244_SecLumpSumRate, \"P244_SecLumpSumRate\", rid)\r\n    Print(APT_ISB_LumpSum, \"APT_ISB_LumpSum\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P246_InYearSecLumpSumSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P245_SecLumpSumSubtotal As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P245_SecLumpSumSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P245_SecLumpSumSubtotal, \"P245_SecLumpSumSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P247_NSENLumpSumPri","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P241_PriLumpSumSubtotal As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P247a_NSENLumpSumPri_Percent As Decimal = products.1718_SBS.P247a_NSENLumpSumPri_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P241_PriLumpSumSubtotal* P247a_NSENLumpSumPri_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P241_PriLumpSumSubtotal, \"P241_PriLumpSumSubtotal\", rid)\r\n    Print(P247a_NSENLumpSumPri_Percent,\"P247a_NSENLumpSumPri_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P247a_NSENLumpSumPri_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Primary_Lump_Sum_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P248_NSENLumpSumSec","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P245_SecLumpSumSubtotal As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P248a_NSENLumpSumSec_Percent As Decimal = products.1718_SBS.P248a_NSENLumpSumSec_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P245_SecLumpSumSubtotal * P248a_NSENLumpSumSec_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P245_SecLumpSumSubtotal, \"P245_SecLumpSumSubtotal\", rid)\r\n    Print(P248a_NSENLumpSumSec_Percent,\"P248a_NSENLumpSumSec_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P248a_NSENLumpSumSec_Percent","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Secondary_Lump_Sum_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P252_PFISubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim PFIString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.PFI\r\n    Dim ISB_PFI As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.PFI\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(PFIString) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_PFI\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_PFI, \"ISB_PFI\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P253_NSENPFI","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P252_PFISubtotal As Decimal = products.1718_SBS.P252_PFISubtotal\r\n    Dim P253a_NSENPFI_Percent As Decimal = products.1718_SBS.P253a_NSENPFI_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P252_PFISubtotal*P253a_NSENPFI_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P252_PFISubtotal, \"P252_PFISubtotal\", rid)\r\n    Print(P253a_NSENPFI_Percent,\"P253a_NSENPFI_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P253a_NSENPFI_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.PFI_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P254_InYearPFISubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P252_PFISubtotal As Decimal = products.1718_SBS.P252_PFISubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P252_PFISubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P252_PFISubtotal, \"P252_PFISubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P255_FringeSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_ISB_LondonFringe As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.London_Fringe\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim LondonFringeIandA As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe    \r\n    Dim LondonFringeCensus As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n    Dim FringeIandAString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe\r\n    Dim FringeCensusString As string = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n    Dim LondonFringeCensusTest As Decimal = 0\r\n    Dim LondonFringeIandATest As Decimal = 0\r\n    \r\n    Dim P005 As Decimal = products.1718_SBS.P005_PriBESubtotal\r\n    Dim P010 As Decimal = products.1718_SBS.P010_KS3_BESubtotal\r\n    Dim P015 As Decimal = products.1718_SBS.P015_KS4_BESubtotal\r\n    Dim P022 As Decimal = products.1718_SBS.P022_PriFSMSubtotal\r\n    Dim P027 As Decimal = products.1718_SBS.P027_PriFSM6Subtotal\r\n    Dim P033 As Decimal = products.1718_SBS.P033_SecFSMSubtotal\r\n    Dim P038 As Decimal = products.1718_SBS.P038_SecFSM6Subtotal\r\n    Dim P044 As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P050 As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P056 As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P062 As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P068 As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P074 As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P080 As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P086 As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P092 As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P098 As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P104 As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P110 As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P145 As Decimal = products.1718_SBS.P145_EAL1PriSubtotal\r\n    Dim P150 As Decimal = products.1718_SBS.P150_EAL2PriSubtotal\r\n    Dim P155 As Decimal = products.1718_SBS.P155_EAL3PriSubtotal\r\n    Dim P161 As Decimal = products.1718_SBS.P161_EAL1SecSubtotal\r\n    Dim P166 As Decimal = products.1718_SBS.P166_EAL2SecSubtotal\r\n    Dim P171 As Decimal = products.1718_SBS.P171_EAL3SecSubtotal\r\n    Dim P117 As Decimal = products.1718_SBS.P117_LACSubtotal\r\n    Dim P133 As Decimal = products.1718_SBS.P133_PPATotalFunding\r\n    Dim P139 As Decimal = products.1718_SBS.P139_SecPASubtotal\r\n    Dim P177 As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P183 As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n    Dim P241 As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P261 As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n\r\nPrint(P005, \"P005\", rid)\r\nPrint(P010, \"P010\", rid)\r\nPrint(P015, \"P015\", rid)\r\nPrint(P022, \"P022\", rid)\r\nPrint(P027, \"P027\", rid)\r\nPrint(P033, \"P033\", rid)\r\nPrint(P038, \"P038\", rid)\r\nPrint(P044, \"P044\", rid)\r\nPrint(P050, \"P050\", rid)\r\nPrint(P056, \"P056\", rid)\r\nPrint(P062, \"P062\", rid)\r\nPrint(P068, \"P068\", rid)\r\nPrint(P074, \"P074\", rid)\r\nPrint(P080, \"P080\", rid)\r\nPrint(P086, \"P086\", rid)\r\nPrint(P092, \"P092\", rid)\r\nPrint(P098, \"P098\", rid)\r\nPrint(P104, \"P104\", rid)\r\nPrint(P110, \"P110\", rid)\r\nPrint(P145, \"P145\", rid)\r\nPrint(P150, \"P150\", rid)\r\nPrint(P155, \"P155\", rid)\r\nPrint(P161, \"P161\", rid)\r\nPrint(P166, \"P166\", rid)\r\nPrint(P171, \"P171\", rid)\r\nPrint(P117, \"P117\", rid)\r\nPrint(P133, \"P133\", rid)\r\nPrint(P139, \"P139\", rid)\r\nPrint(P177, \"P177\", rid)\r\nPrint(P183, \"P183\", rid)\r\nPrint(P241, \"P241\", rid)\r\nPrint(P245, \"P245\", rid)\r\nPrint(P261, \"P261\", rid)\r\n    \r\n    If AcadFilter = 1 then\r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then       \r\n            If string.IsNullOrEmpty(FringeIandAString) Then\r\n                If LondonFringeCensus < 1 Then \r\n                    LondonFringeCensusTest = 0\r\n                Else \r\n                    LondonFringeCensusTest = LondonFringeCensus - 1\r\n                End If \r\n            Result = (P005+P010+P015+P022+P027+P033+P038+P044+P050+P056+P062+P068+P074+P080+P086+P092+P098+P104+P110+P145+P150+P155+P161+P166+P171+P117+P133+P139+P177+P183+P241+P245+P261)*(LondonFringeCensusTest)\r\n            Else \r\n                If LondonFringeIandA < 1 Then \r\n                    LondonFringeIandATest = 0\r\n                Else \r\n                    LondonFringeIandATest = LondonFringeIandA - 1\r\n                End If\r\n            Result = (P005+P010+P015+P022+P027+P033+P038+P044+P050+P056+P062+P068+P074+P080+P086+P092+P098+P104+P110+P145+P150+P155+P161+P166+P171+P117+P133+P139+P177+P183+P241+P245+P261)*(LondonFringeIandATest)  \r\n            End if \r\n        ElseIf F100_AllAcademies <> 17181 Then 'And FundingBasis = \"Estimate\"  Then \r\n        result = APT_ISB_LondonFringe\r\n        Else\r\n        Exclude(rid)\r\n        \r\n        End if\r\n    else\r\n        exclude(rid)\r\n    End if        \r\n\r\n    Print(APT_ISB_LondonFringe, \"APT_ISB_LondonFringe\", rid)\r\n    Print(F100_AllAcademies,\"F100_AllAcademies\",rid)\r\n    Print(FundingBasis,\"Funding_Basis\",rid)\r\n    Print(LondonFringeIandA, \"LondonFringeIandA\", rid)   \r\n    Print(LondonFringeCensus, \"LondonFringeCensus\", rid) \r\n    Print(LondonFringeIandATest, \"LondonFringeIandATest\", rid)   \r\n    Print(LondonFringeCensusTest, \"LondonFringeCensusTest\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P257_InYearFringeSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P255_FringeSubtotal As Decimal = products.1718_SBS.P255_FringeSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P255_FringeSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P255_FringeSubtotal, \"P255_FringeSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P261_Ex1Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim  Ex1String As String = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.17-18_Approved_Exceptional__Circumstance_1:_Reserved_for_Additional_lump_sum_for_schools_amalgamated_during__FY16-17] \r\n    Dim ISB_Ex1 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.17-18_Approved_Exceptional__Circumstance_1:_Reserved_for_Additional_lump_sum_for_schools_amalgamated_during__FY16-17]\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex1String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex1\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex1, \"ISB_Ex1\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P262_NSENEx1","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P239_PriLumpSumFactor As Decimal = products.1718_SBS.P239_PriLumpSumFactor\r\n    Dim P243_SecLumpSumFactor As Decimal = products.1718_SBS.P243_SecLumpSumFactor\r\n    Dim P247a_NSENLumpSumPri_Percent As Decimal = products.1718_SBS.P247a_NSENLumpSumPri_Percent / 100\r\n    Dim P248a_NSENLumpSumSec_Percent  As Decimal = products.1718_SBS.P248a_NSENLumpSumSec_Percent / 100\r\n    Dim P261_Ex1Subtotal As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = (P261_Ex1Subtotal*P239_PriLumpSumFactor*P247a_NSENLumpSumPri_Percent)+(P261_Ex1Subtotal*P243_SecLumpSumFactor*P248a_NSENLumpSumSec_Percent)\r\n    Else\r\n    exclude(rid)    \r\n    End if\r\n    \r\n   \r\n    Print(P239_PriLumpSumFactor, \"P239_PriLumpSumFactor\", rid)\r\n    Print(P243_SecLumpSumFactor, \"P243_SecLumpSumFactor\", rid)\r\n    Print(P247a_NSENLumpSumPri_Percent, \"P247a_NSENLumpSumPri_Percent\", rid)\r\n    Print(P248a_NSENLumpSumSec_Percent, \"P248a_NSENLumpSumSec_Percent\", rid)\r\n    Print(P261_Ex1Subtotal, \"P261_Ex1Subtotal\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P264_InYearEx1Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P261_Ex1Subtotal As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result =P261_Ex1Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P261_Ex1Subtotal, \"P261_Ex1Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P265_Ex2Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex2String As String = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_2:_Reserved_for_additional_sparsity_lump_sum]\r\n    Dim ISB_Ex2 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_2:_Reserved_for_additional_sparsity_lump_sum]\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex2String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex2\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex2, \"ISB_Ex2\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P266_NSENEx2","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P265_Ex2Subtotal As Decimal = products.1718_SBS.P265_Ex2Subtotal\r\n    Dim P266a_NSENEx2_Percent As Decimal = products.1718_SBS.P266a_NSENEx2_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P265_Ex2Subtotal *  P266a_NSENEx2_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P265_Ex2Subtotal, \"P265_Ex2Subtotal\", rid)\r\n    Print(P266a_NSENEx2_Percent,\"P266a_NSENEx2_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P266a_NSENEx2_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv([datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_2_Notional_SEN])\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P267_InYearEx2Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P265_Ex2Subtotal As Decimal = products.1718_SBS.P265_Ex2Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P265_Ex2Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P265_Ex2Subtotal, \"P265_Ex2Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P269_Ex3Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex3String As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_3]\r\n    Dim ISB_Ex3 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_3]\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex3String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex3\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex3, \"ISB_Ex3\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P270_NSENEx3","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P269_Ex3Subtotal As Decimal = products.1718_SBS.P269_Ex3Subtotal\r\n    Dim P270a_NSENEx3_Percent As Decimal = products.1718_SBS.P270a_NSENEx3Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P269_Ex3Subtotal*  P270a_NSENEx3_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P269_Ex3Subtotal, \"P269_Ex3Subtotal\", rid)\r\n    Print(P270a_NSENEx3_Percent,\"P270a_NSENEx3_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P270a_NSENEx3Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_3_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P262a_NSENEx1_percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SENPri As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_1_Primary_Notional_SEN)\r\n    Dim Notional_SENSec As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_1_Secondary_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Phase As Decimal = products.1718_SBS.P185a_Phase\r\n    \r\n    If AcadFilter = 1 then\r\n        If Phase = 1 Or phase = 2 then\r\n            result = Notional_SENPri * 100\r\n        ElseIf phase = 3 Or phase = 4 Or phase = 5 then\r\n            result=Notional_SENSec * 100\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SENPri, \"Notional_SENPri\", rid)\r\n    Print(Notional_SENSec, \"Notional_SENSec\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P271_InYearEx3Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P269_Ex3Subtotal As Decimal = products.1718_SBS.P269_Ex3Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P269_Ex3Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P269_Ex3Subtotal, \"P269_Ex3Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P274_NSENEx4","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex4String As String = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_4]\r\n    Dim ISB_Ex4 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_4]\r\n    Dim Ex4NSEN As Decimal = products.1718_SBS.P274a_NSENEx4_Percent / 100\r\n     \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex4String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex4 * EX4NSEN\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex4, \"ISB_Ex4\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P274a_NSENEx4_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_4_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN  * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P275_InyearEx4Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P273_Ex4Subtotal As Decimal = products.1718_SBS.P273_Ex4Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P273_Ex4Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P273_Ex4Subtotal, \"P273_Ex4Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P277_Ex5Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex5String As String  = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_5]\r\n    Dim ISB_Ex5 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_5]\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex5String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex5\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex5, \"ISB_Ex5\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P278_NSENEx5","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P277_Ex5Subtotal As Decimal = products.1718_SBS.P277_Ex5Subtotal\r\n    Dim P278a_NSENEx5_Percent As Decimal = products.1718_SBS.P278a_NSENEx5_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P277_Ex5Subtotal * P278a_NSENEx5_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P277_Ex5Subtotal, \"P277_Ex5Subtotal\", rid)\r\n    Print(P278a_NSENEx5_Percent,\"P278a_NSENEx5_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n    \r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P278a_NSENEx5_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_5_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P279_InYearEx5Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P277_Ex5Subtotal As Decimal = products.1718_SBS.P277_Ex5Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result =P277_Ex5Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P277_Ex5Subtotal, \"P277_Ex5Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P281_Ex6Subtotal","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex6String As  String = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_6]\r\n    Dim ISB_Ex6 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_6]\r\n    Dim SBSP286 As Decimal = Products.1718_SBS.P286_PriorYearAdjustmentSubtotal\r\n   \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex6String) Then\r\n        result = SBSP286\r\n        Else\r\n        result = ISB_Ex6 + SBSP286\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex6, \"ISB_Ex6\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P282_NSENEx6","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P281_Ex6Subtotal As Decimal = products.1718_SBS.P281_Ex6Subtotal\r\n    Dim P282a_NSENEx6_Percent As Decimal = products.1718_SBS.P282a_NSENEx6_Percent / 100\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SBSP286 As Decimal = Products.1718_SBS.P286_PriorYearAdjustmentSubtotal\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = (P281_Ex6Subtotal - SBSP286) *  P282a_NSENEx6_Percent\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(P281_Ex6Subtotal, \"P281_Ex6Subtotal\", rid)\r\n    Print(P282a_NSENEx6_Percent,\"P282a_NSENEx6_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n    \r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P282a_NSENEx6_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Exceptional_Circumstance_6_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n    result = Notional_SEN * 100\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P283_InYearEx6Subtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P281_Ex6Subtotal As Decimal = products.1718_SBS.P281_Ex6Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result =P281_Ex6Subtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P281_Ex6Subtotal, \"P281_Ex6Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P284_NSENSubtotal","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim APT_NSENSubtotal As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Notional_SEN_Budget\r\n    Dim F100_AllAcademies As Decimal = products.1718_Global_Variables.F100_AllAcademies\r\n    Dim FundingBasis As  Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim LondonFringeIandA As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe\r\n    Dim LondonFringeIandAString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_Inputs_and_Adjustments.APT_Inputs_and_Adjustments.London_Fringe     \r\n    Dim LondonFringeCensus As Decimal = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n    Dim LondonFringeCensusString As String = datasets.Academy_Allocations.AY_2017/18.Weights.Census_Pupil_Characteristics.Census_Pupil_Characteristics.London_Fringe\r\n    Dim Fringe As Decimal = 0 \r\n    Dim P006 As Decimal = products.1718_SBS.P006_NSEN_PriBE\r\n    Dim P011 As Decimal = products.1718_SBS.P011_NSEN_KS3BE_percent\r\n    Dim P016 As Decimal = products.1718_SBS.P016_NSEN_KS4BE\r\n    Dim P028 As Decimal = products.1718_SBS.P028_NSENFSMPri\r\n    Dim P039 As Decimal = products.1718_SBS.P039_NSENFSMSec\r\n    Dim P045 As Decimal = products.1718_SBS.P045_NSENIDACIFPri\r\n    Dim P051 As Decimal = products.1718_SBS.P051_NSENIDACIEPri\r\n    Dim P057 As Decimal = products.1718_SBS.P057_NSENIDACIDPri\r\n    Dim P063 As Decimal = products.1718_SBS.P063_NSENIDACICPri\r\n    Dim P069 As Decimal = products.1718_SBS.P069_NSENIDACIBPri\r\n    Dim P075 As Decimal = products.1718_SBS.P075_NSENIDACIAPri\r\n    Dim P081 As Decimal = products.1718_SBS.P081_NSENIDACIFSec\r\n    Dim P087 As Decimal = products.1718_SBS.P087_NSENIDACIESec\r\n    Dim P093 As Decimal = products.1718_SBS.P093_NSENIDACIDSec\r\n    Dim P099 As Decimal = products.1718_SBS.P099_NSENIDACICSec\r\n    Dim P105 As Decimal = products.1718_SBS.P105_NSENIDACIBSec\r\n    Dim P111 As Decimal = products.1718_SBS.P111_NSENIDACIASec\r\n    Dim P156 As Decimal = products.1718_SBS.P156_NSENPriEAL\r\n    Dim P172 As Decimal = products.1718_SBS.P172_NSENSecEAL\r\n    Dim P178 As Decimal = products.1718_SBS.P178_NSENMobPri\r\n    Dim P184 As Decimal = products.1718_SBS.P184_NSENMobSec\r\n    Dim P118 As Decimal = products.1718_SBS.P118_NSENLAC\r\n    Dim P134 As Decimal = products.1718_SBS.P134_NSENPPA\r\n    Dim P140 As Decimal = products.1718_SBS.P140_NSENSecPA\r\n    Dim P236 As Decimal = products.1718_SBS.P236_NSENSparsity\r\n    Dim P247 As Decimal = products.1718_SBS.P247_NSENLumpSumPri\r\n    Dim P248 As Decimal = products.1718_SBS.P248_NSENLumpSumSec\r\n    Dim P250 As Decimal = products.1718_SBS.P250_NSENSplitSites\r\n    Dim P253 As Decimal = products.1718_SBS.P253_NSENPFI\r\n    Dim P262 As Decimal = products.1718_SBS.P262_NSENEx1\r\n    Dim P266 As Decimal = products.1718_SBS.P266_NSENEx2\r\n    Dim P270 As Decimal = products.1718_SBS.P270_NSENEx3\r\n    Dim P274 As Decimal = products.1718_SBS.P274_NSENEx4\r\n    Dim P278 As Decimal = products.1718_SBS.P278_NSENEx5\r\n    Dim P282 As Decimal = products.1718_SBS.P282_NSENEx6\r\n    Dim F200 As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n     \r\n    If F200 = 1 then\r\n    \r\n        If F100_AllAcademies = 17181 Or (F100_AllAcademies = 17182 And FundingBasis = 2 ) Or (F100_AllAcademies = 17183 And FundingBasis = 2) Then  \r\n            If string.IsNullOrEmpty(LondonFringeIandAString) And string.IsNullOrEmpty(LondonFringeCensusString) Then    \r\n                Fringe = 1\r\n            ElseIf string.IsNullOrEmpty(LondonFringeIandAString) Then \r\n                Fringe = LondonFringeCensus\r\n            Else \r\n                Fringe = LondonFringeIandA\r\n            End If                        \r\n            Result = (Fringe*(P006+P011+P016+P028+P039+P045+P051+P057+P063+P069+P075+P081+P087+P093+P099+P105+P111+P118+P134+P140+P156+P172+P178+P184+P236+P247+P248+P262))+P250+P253+P266+P270+P274+P278+P282\r\n                     \r\n        ElseIf (F100_AllAcademies = 17182 Or F100_AllAcademies = 17183) And FundingBasis = 1  Then \r\n        result = APT_NSENSubtotal\r\n        Else\r\n        Exclude(rid)\r\n        End If\r\n    Else \r\n    \r\n        exclude(rid)\r\n     End if\r\n     \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P285_InYearNSENSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P284_NSENSubtotal As Decimal = products.1718_SBS.P284_NSENSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P284_NSENSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P284_NSENSubtotal, \"P284_NSENSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P286_PriorYearAdjustmentSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Adjustments As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.APT_Adjustment_relating_to_prior_year_SBS\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result =  Adjustments\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(Adjustments, \"Adjustments\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n    ","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P287_InYearPriorYearAdjustmentSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P286_PriorYearAdjustmentSubtotal As Decimal = products.1718_SBS.P286_PriorYearAdjustmentSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P286_PriorYearAdjustmentSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P286_PriorYearAdjustmentSubtotal, \"P286_PriorYearAdjustmentSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":6},{"Name":"P298_Growth","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P298Growth As Decimal = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.Growth_Funding_Total\r\n    Dim P298Growthstr As string = datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.Growth_Funding_Total\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If F200 = 1 then\r\n    \r\n        If string.IsNullOrEmpty(P298GrowthStr) then\r\n            result=0\r\n        else\r\n            result=P298Growth\r\n        End if  \r\n\r\n    Else \r\n        exclude(rid)\r\n        \r\n    End if\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P299_InYearGrowth","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P298Growth As Decimal = products.1718_SBS.P298_Growth\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P298Growth * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P298Growth, \"P286_PriorYearAdjustmentSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P300_SBSOutcomeAdjustment","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P300SBSAdj As Decimal = [datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.SBS_outcome_adjustment]\r\n    Dim P300SBSAdjStr As String = [datasets.Academy_Allocations.AY_2017/18.EFA_Adjustments.EFA_Adjustments.SBS_outcome_adjustment]\r\n    Dim F200 As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If F200 = 1 then\r\n    \r\n        If string.IsNullOrEmpty(P300SBSAdjStr) Then \r\n            result=0\r\n        else\r\n            result=P300SBSAdj\r\n        End if        \r\n    \r\n    else\r\n        \r\n        exclude(rid)\r\n    \r\n    End if\r\n     \r\n    Return result\r\n    \r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P301_InYearSBSOutcomeAdjustment","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P300SBSAdj As Decimal = products.1718_SBS.P300_SBSOutcomeAdjustment\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n    result = P300SBSAdj * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n    exclude(rid)\r\n    End if   \r\n     \r\n    Print(P300SBSAdj, \"P286_PriorYearAdjustmentSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P273_Ex4Subtotal","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Ex4String As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_4]\r\n    Dim ISB_Ex4 As Decimal = [Datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.1718_Approved_Exceptional__Circumstance_4]\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(Ex4String) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_Ex4\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_Ex4, \"ISB_Ex4\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":2},{"Name":"P255_Test","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    Dim P005 As Decimal = products.1718_SBS.P005_PriBESubtotal\r\n    Dim P010 As Decimal = products.1718_SBS.P010_KS3_BESubtotal\r\n    Dim P015 As Decimal = products.1718_SBS.P015_KS4_BESubtotal\r\n    Dim P022 As Decimal = products.1718_SBS.P022_PriFSMSubtotal\r\n    Dim P027 As Decimal = products.1718_SBS.P027_PriFSM6Subtotal\r\n    Dim P033 As Decimal = products.1718_SBS.P033_SecFSMSubtotal\r\n    Dim P038 As Decimal = products.1718_SBS.P038_SecFSM6Subtotal\r\n    Dim P044 As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P050 As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P056 As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P062 As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P068 As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P074 As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P080 As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P086 As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P092 As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P098 As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P104 As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P110 As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P145 As Decimal = products.1718_SBS.P145_EAL1PriSubtotal\r\n    Dim P150 As Decimal = products.1718_SBS.P150_EAL2PriSubtotal\r\n    Dim P155 As Decimal = products.1718_SBS.P155_EAL3PriSubtotal\r\n    Dim P161 As Decimal = products.1718_SBS.P161_EAL1SecSubtotal\r\n    Dim P166 As Decimal = products.1718_SBS.P166_EAL2SecSubtotal\r\n    Dim P171 As Decimal = products.1718_SBS.P171_EAL3SecSubtotal\r\n    Dim P117 As Decimal = products.1718_SBS.P117_LACSubtotal\r\n    Dim P133 As Decimal = products.1718_SBS.P133_PPATotalFunding\r\n    Dim P139 As Decimal = products.1718_SBS.P139_SecPASubtotal\r\n    Dim P177 As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P183 As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n    Dim P241 As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P261 As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Other Factors","DecimalPlaces":0},{"Name":"P249_SplitSitesSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim AcadFilter  As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim SplitSiteString As String = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Split_Sites\r\n    Dim ISB_SplitSite As Decimal =  datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Split_Sites\r\n    \r\n    If AcadFilter = 1 Then\r\n        If string.IsNullOrEmpty(SplitSiteString) Then\r\n        result = 0\r\n        Else\r\n        result = ISB_SplitSite\r\n        End If\r\n    Else\r\n    exclude(rid)\r\n    End If\r\n    \r\n    Print(ISB_SplitSite, \"ISB_SplitSite\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Split Sites","DecimalPlaces":2},{"Name":"P250_NSENSplitSites","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n      Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n      Dim P249_SplitSitesSubtotal As Decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\n      Dim P250a_NSENSplitSites_Percent As Decimal = products.1718_SBS.P250a_NSENSplitSites_Percent / 100\r\n      \r\n      If AcadFilter = 1 then\r\n      Result = P249_SplitSitesSubtotal*P250a_NSENSplitSites_Percent\r\n      Else \r\n      exclude(rid)\r\n      End If \r\n      \r\n      Print(P249_SplitSitesSubtotal, \"P249_SplitSitesSubtotal\", rid)\r\n      Print(P250a_NSENSplitSites_Percent, \"P250a_NSENSplitSites_Percent\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Split Sites","DecimalPlaces":6},{"Name":"P250a_NSENSplitSites_Percent","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim Notional_SEN As Decimal = LAtoProv(datasets.Academy_Allocations.AY_2017/18.APT.APT_Proforma_dataset.APT_Proforma_dataset.Split_Sites_Notional_SEN)\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 then\r\n        result = Notional_SEN * 100\r\n    Else\r\n        exclude(rid)\r\n    End if\r\n    \r\n    Print(Notional_SEN, \"Notional_SEN\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Split Sites","DecimalPlaces":6},{"Name":"P251_InYearSplitSitesSubtotal","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim P249_SplitSitesSubtotal As Decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\n    Dim P001_1718DaysOpen As Decimal = products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days1718 As Decimal = products.1718_Global_Variables.P025_YearDays_1718\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    If AcadFilter = 1 Then\r\n        result = P249_SplitSitesSubtotal * (P001_1718DaysOpen/Year_Days1718)\r\n    Else \r\n        exclude(rid)\r\n    End if   \r\n     \r\n    Print(P249_SplitSitesSubtotal, \"P249_SplitSitesSubtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days1718, \"Year_Days1718\", rid)\r\n    \r\n    Return result\r\nEnd Function","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Split Sites","DecimalPlaces":6},{"Name":"P001_1718DaysOpen","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n     Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n     Dim F200_SBS_Academies As Double = Products.1718_Global_Variables.F200_SBS_Academies\r\n     Dim P001_1718DaysOpen As Double = Products.1718_Global_Variables.P027_DaysOpen                     \r\n                                       \r\n     Print(P001_1718DaysOpen, \"Days Open\", rid)\r\n     Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n   \r\n     If F200_SBS_Academies = 1 Then\r\n        Result = P001_1718DaysOpen\r\n     \r\n     Else\r\n     Exclude(rid)\r\n     End If\r\n              \r\n    Return result\r\n      \r\nEnd Function","ProductType":"Other","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"Lump_Sum_Total","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim acadfilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P241 As Decimal = products.1718_SBS.P241_priLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    \r\n    If acadfilter=1 then\r\n        result=P241+P245\r\n    else\r\n        exclude(rid)\r\n    End If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"InYearLumpSum","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim acadfilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P242 As Decimal = products.1718_SBS.P242_InYearPriLumpSumSubtotal\r\n    Dim P246 As Decimal = products.1718_SBS.P246_InYearSecLumpSumSubtotal\r\n    \r\n    If acadfilter=1 then\r\n        result=P242+P246\r\n    else\r\n        exclude(rid)\r\n    End If \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":0},{"Name":"P288_SBSFundingTotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P005 As Decimal = products.1718_SBS.P005_PriBESubtotal\r\n    Dim P010 As Decimal = products.1718_SBS.P010_KS3_BESubtotal\r\n    Dim P015 As Decimal = products.1718_SBS.P015_KS4_BESubtotal\r\n    Dim P022 As Decimal = products.1718_SBS.P022_PriFSMSubtotal\r\n    Dim P027 As Decimal = products.1718_SBS.P027_PriFSM6Subtotal\r\n    Dim P033 As Decimal = products.1718_SBS.P033_SecFSMSubtotal\r\n    Dim P038 As Decimal = products.1718_SBS.P038_SecFSM6Subtotal\r\n    Dim P044 As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P050 As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P056 As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P062 As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P068 As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P074 As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P080 As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P086 As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P092 As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P098 As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P104 As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P110 As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P117 As Decimal = products.1718_SBS.P117_LACSubtotal\r\n    Dim P133 As Decimal = products.1718_SBS.P133_PPATotalFunding\r\n    Dim P139 As Decimal = products.1718_SBS.P139_SecPASubtotal\r\n    Dim P145 As Decimal = products.1718_SBS.P145_EAL1PriSubtotal\r\n    Dim P150 As Decimal = products.1718_SBS.P150_EAL2PriSubtotal\r\n    Dim P155 As Decimal = products.1718_SBS.P155_EAL3PriSubtotal\r\n    Dim P161 As Decimal = products.1718_SBS.P161_EAL1SecSubtotal\r\n    Dim P166 As Decimal = products.1718_SBS.P166_EAL2SecSubtotal\r\n    Dim P171 As Decimal = products.1718_SBS.P171_EAL3SecSubtotal\r\n    Dim P177 As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P183 As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n    Dim P197 As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P198 As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim P241 As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P249 As Decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\n    Dim P252 As Decimal = products.1718_SBS.P252_PFISubtotal\r\n    Dim P255 As Decimal = products.1718_SBS.P255_FringeSubtotal\r\n    Dim P261 As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    Dim P265 As Decimal = products.1718_SBS.P265_Ex2Subtotal\r\n    Dim P269 As Decimal = products.1718_SBS.P269_Ex3Subtotal\r\n    Dim P273 As Decimal = products.1718_SBS.P273_Ex4Subtotal\r\n    Dim P277 As Decimal = products.1718_SBS.P277_Ex5Subtotal\r\n    Dim P281 As Decimal = products.1718_SBS.P281_Ex6Subtotal \r\n    Dim P298 As Decimal = products.1718_SBS.P298_Growth\r\n    Dim P300 As Decimal = products.1718_SBS.P300_SBSOutcomeAdjustment\r\n    \r\n     \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P005+P010+P015+P022+P027+P033+P038+P044+P050+P056+P062+P068+P074+P080+P086+P092+P098+P104+P110+P117+P133+P139+P145+P150+P155+P161+P166+P171+P177+P183+P197+P198+P241+P245+P249+P252+P255+P261+P265+P269+P273+P277+P281+P298+P300\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n                                                               ","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":2},{"Name":"P289_InYearSBSFundingTotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P007 As Decimal = products.1718_SBS.P007_InYearPriBE_Subtotal\r\n    Dim P012 As Decimal = products.1718_SBS.P012_InYearKS3_BESubtotal\r\n    Dim P018 As Decimal = products.1718_SBS.P018_InYearKS4_BESubtotal\r\n    Dim P023 As Decimal = products.1718_SBS.P023_InYearPriFSMSubtotal\r\n    Dim P029 As Decimal = products.1718_SBS.P029_InYearPriFSM6Subtotal\r\n    Dim P034 As Decimal = products.1718_SBS.P034_InYearSecFSMSubtotal\r\n    Dim P040 As Decimal = products.1718_SBS.P040_InYearSecFSM6Subtotal\r\n    Dim P046 As Decimal = products.1718_SBS.P046_InyearIDACIFPriSubtotal\r\n    Dim P052 As Decimal = products.1718_SBS.P052_InYearIDACIEPriSubtotal\r\n    Dim P058 As Decimal = products.1718_SBS.P058_InYearIDACIDPriSubtotal\r\n    Dim P064 As Decimal = products.1718_SBS.P064_InYearIDACICPriSubtotal\r\n    Dim P070 As Decimal = products.1718_SBS.P070_InYearIDACIBPriSubtotal\r\n    Dim P076 As Decimal = products.1718_SBS.P076_InYearIDACIAPriSubtotal\r\n    Dim P082 As Decimal = products.1718_SBS.P082_InYearIDACIFSecSubtotal\r\n    Dim P088 As Decimal = products.1718_SBS.P088_InYearIDACIESecSubtotal\r\n    Dim P094 As Decimal = products.1718_SBS.P094_InYearIDACIDSecSubtotal\r\n    Dim P100 As Decimal = products.1718_SBS.P100_InYearIDACICSecSubtotal\r\n    Dim P106 As Decimal = products.1718_SBS.P106_InYearIDACIBSecSubtotal\r\n    Dim P112 As Decimal = products.1718_SBS.P112_InYearIDACIASecSubtotal\r\n    Dim P119 As Decimal = products.1718_SBS.P119_InYearLACSubtotal\r\n    Dim P135 As Decimal = products.1718_SBS.P135_InYearPPASubtotal\r\n    Dim P141 As Decimal = products.1718_SBS.P141_InYearSecPASubtotal\r\n    Dim P146 As Decimal = products.1718_SBS.P146_InYearEAL1PriSubtotal\r\n    Dim P151 As Decimal = products.1718_SBS.P151_InYearEAL2PriSubtotal\r\n    Dim P157 As Decimal = products.1718_SBS.P157_InYearEAL3PriSubtotal\r\n    Dim P162 As Decimal = products.1718_SBS.P162_InYearEAL1SecSubtotal\r\n    Dim P167 As Decimal = products.1718_SBS.P167_InYearEAL2SecSubtotal\r\n    Dim P173 As Decimal = products.1718_SBS.P173_InYearEAL3SecSubtotal\r\n    Dim P179 As Decimal = products.1718_SBS.P179_InYearMobPriSubtotal\r\n    Dim P185 As Decimal = products.1718_SBS.P185_InYearMobSecSubtotal\r\n    Dim P199 As Decimal = products.1718_SBS.P199_InYearSparsityLumpSumSubtotal\r\n    Dim P200 As Decimal = products.1718_SBS.P200_InYearSparsityTaperSubtotal\r\n    Dim P242 As Decimal = products.1718_SBS.P242_InYearPriLumpSumSubtotal\r\n    Dim P246 As Decimal = products.1718_SBS.P246_InYearSecLumpSumSubtotal\r\n    Dim P251 As Decimal = products.1718_SBS.P251_InYearSplitSitesSubtotal\r\n    Dim P254 As Decimal = products.1718_SBS.P254_InYearPFISubtotal\r\n    Dim P257 As Decimal = products.1718_SBS.P257_InYearFringeSubtotal\r\n    Dim P264 As Decimal = products.1718_SBS.P264_InYearEx1Subtotal\r\n    Dim P267 As Decimal = products.1718_SBS.P267_InYearEx2Subtotal\r\n    Dim P271 As Decimal = products.1718_SBS.P271_InYearEx3Subtotal\r\n    Dim P275 As Decimal = products.1718_SBS.P275_InYearEx4Subtotal\r\n    Dim P279 As Decimal = products.1718_SBS.P279_InYearEx5Subtotal\r\n    Dim P283 As Decimal = products.1718_SBS.P283_InYearEx6Subtotal\r\n    Dim P299 As Decimal = products.1718_SBS.P299_InYearGrowth\r\n    Dim P301 As Decimal = products.1718_SBS.P301_InYearSBSOutcomeAdjustment\r\n    \r\n    print( P007,\"P007\",rid)\r\nprint( P012,\"P012\",rid)\r\nprint( P018,\"P018\",rid)\r\nprint( P023,\"P023\",rid)\r\nprint( P029,\"P029\",rid)\r\nprint( P034,\"P034\",rid)\r\nprint( P040,\"P040\",rid)\r\nprint( P046,\"P046\",rid)\r\nprint( P052,\"P052\",rid)\r\nprint( P058,\"P058\",rid)\r\nprint( P064,\"P064\",rid)\r\nprint( P070,\"P070\",rid)\r\nprint( P076,\"P076\",rid)\r\nprint( P082,\"P082\",rid)\r\nprint( P088,\"P088\",rid)\r\nprint( P094,\"P094\",rid)\r\nprint( P100,\"P100\",rid)\r\nprint( P106,\"P106\",rid)\r\nprint( P112,\"P112\",rid)\r\nprint( P119,\"P119\",rid)\r\nprint( P135,\"P135\",rid)\r\nprint( P141,\"P141\",rid)\r\nprint( P146,\"P146\",rid)\r\nprint( P151,\"P151\",rid)\r\nprint( P157,\"P157\",rid)\r\nprint( P162,\"P162\",rid)\r\nprint( P167,\"P167\",rid)\r\nprint( P173,\"P173\",rid)\r\nprint( P179,\"P179\",rid)\r\nprint( P185,\"P185\",rid)\r\nprint( P199,\"P199\",rid)\r\nprint( P200,\"P200\",rid)\r\nprint( P242,\"P242\",rid)\r\nprint( P246,\"P246\",rid)\r\nprint( P251,\"P251\",rid)\r\nprint( P254,\"P254\",rid)\r\nprint( P257,\"P257\",rid)\r\nprint( P264,\"P264\",rid)\r\nprint( P267,\"P267\",rid)\r\nprint( P271,\"P271\",rid)\r\nprint( P275,\"P275\",rid)\r\nprint( P279,\"P279\",rid)\r\nprint( P283,\"P283\",rid)\r\nprint( P299,\"P299\",rid)\r\nprint( P301,\"P301\",rid)\r\n \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P007+P012+P018+P023+P029+P034+P040+P046+P052+P058+P064+P070+P076+P082+P088+P094+P100+P106+P112+P119+P135+P141+P146+P151+P157+P162+P167+P173+P179+P185+P199+P200+P242+P246+P251+P254+P257+P264+P267+P271+P275+P279+P283+P299+P301\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P290_ISBTotalSBSFunding","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim TotalAllocation As Decimal = datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Total_Allocation\r\n    Dim Rates As Decimal =  datasets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.Rates\r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    \r\n    \r\n    If AcadFilter = 1 Then\r\n    result = TotalAllocation -  Rates\r\n    Else\r\n    exclude(rid)\r\n    End if\r\n    \r\n    Print(TotalAllocation, \"TotalAllocation\", rid)\r\n    Print(Rates,\"Rates\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n    \r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P291_TotalPupilLedFactors","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P005 As Decimal = products.1718_SBS.P005_PriBESubtotal\r\n    Dim P010 As Decimal = products.1718_SBS.P010_KS3_BESubtotal\r\n    Dim P015 As Decimal = products.1718_SBS.P015_KS4_BESubtotal\r\n    Dim P022 As Decimal = products.1718_SBS.P022_PriFSMSubtotal\r\n    Dim P027 As Decimal = products.1718_SBS.P027_PriFSM6Subtotal\r\n    Dim P033 As Decimal = products.1718_SBS.P033_SecFSMSubtotal\r\n    Dim P038 As Decimal = products.1718_SBS.P038_SecFSM6Subtotal\r\n    Dim P044 As Decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\n    Dim P050 As Decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\n    Dim P056 As Decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\n    Dim P062 As Decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\n    Dim P068 As Decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\n    Dim P074 As Decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\n    Dim P080 As Decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\n    Dim P086 As Decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\n    Dim P092 As Decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\n    Dim P098 As Decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\n    Dim P104 As Decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\n    Dim P110 As Decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\n    Dim P117 As Decimal = products.1718_SBS.P117_LACSuBtotal\r\n    Dim P133 As Decimal = products.1718_SBS.P133_PPATotalFunding\r\n    Dim P139 As Decimal = products.1718_SBS.P139_SecPASubtotal\r\n    Dim P145 As Decimal = products.1718_SBS.P145_EAL1PriSubtotal\r\n    Dim P150 As Decimal = products.1718_SBS.P150_EAL2PriSubtotal\r\n    Dim P155 As Decimal = products.1718_SBS.P155_EAL3PriSubtotal\r\n    Dim P161 As Decimal = products.1718_SBS.P161_EAL1SecSubtotal\r\n    Dim P166 As Decimal = products.1718_SBS.P166_EAL2SecSubtotal\r\n    Dim P171 As Decimal = products.1718_SBS.P171_EAL3SecSubtotal\r\n    Dim P177 As Decimal = products.1718_SBS.P177_MobPriSubtotal\r\n    Dim P183 As Decimal = products.1718_SBS.P183_MobSecSubtotal\r\n \r\n \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P005+P010+P015+P022+P027+P033+P038+P044+P050+P056+P062+P068+P074+P080+P086+P092+P098+P104+P110+P117+P133+P139+P145+P150+P155+P161+P166+P171+P177+P183\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":2},{"Name":"P292_InYearTotalPupilLedfactors","Script":"    Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P007 As Decimal = products.1718_SBS.P007_InYearPriBE_Subtotal\r\n    Dim P012 As Decimal = products.1718_SBS.P012_InYearKS3_BESubtotal\r\n    Dim P018 As Decimal = products.1718_SBS.P018_InYearKS4_BESubtotal\r\n    Dim P023 As Decimal = products.1718_SBS.P023_InYearPriFSMSubtotal\r\n    Dim P029 As Decimal = products.1718_SBS.P029_InYearPriFSM6Subtotal\r\n    Dim P034 As Decimal = products.1718_SBS.P034_InYearSecFSMSubtotal\r\n    Dim P040 As Decimal = products.1718_SBS.P040_InYearSecFSM6Subtotal\r\n    Dim P046 As Decimal = products.1718_SBS.P046_InyearIDACIFPriSubtotal\r\n    Dim P052 As Decimal = products.1718_SBS.P052_InYearIDACIEPriSubtotal\r\n    Dim P058 As Decimal = products.1718_SBS.P058_InYearIDACIDPriSubtotal\r\n    Dim P064 As Decimal = products.1718_SBS.P064_InYearIDACICPriSubtotal\r\n    Dim P070 As Decimal = products.1718_SBS.P070_InYearIDACIBPriSubtotal\r\n    Dim P076 As Decimal = products.1718_SBS.P076_InYearIDACIAPriSubtotal\r\n    Dim P082 As Decimal = products.1718_SBS.P082_InYearIDACIFSecSubtotal\r\n    Dim P088 As Decimal = products.1718_SBS.P088_InYearIDACIESecSubtotal\r\n    Dim P094 As Decimal = products.1718_SBS.P094_InYearIDACIDSecSubtotal\r\n    Dim P100 As Decimal = products.1718_SBS.P100_InYearIDACICSecSubtotal\r\n    Dim P106 As Decimal = products.1718_SBS.P106_InYearIDACIBSecSubtotal\r\n    Dim P112 As Decimal = products.1718_SBS.P112_InYearIDACIASecSubtotal\r\n    Dim P119 As Decimal = products.1718_SBS.P119_InYearLACSubtotal\r\n    Dim P135 As Decimal = products.1718_SBS.P135_InYearPPASubtotal\r\n    Dim P141 As Decimal = products.1718_SBS.P141_InYearSecPASubtotal\r\n    Dim P146 As Decimal = products.1718_SBS.P146_InYearEAL1PriSubtotal\r\n    Dim P151 As Decimal = products.1718_SBS.P151_InYearEAL2PriSubtotal\r\n    Dim P157 As Decimal = products.1718_SBS.P157_InYearEAL3PriSubtotal\r\n    Dim P162 As Decimal = products.1718_SBS.P162_InYearEAL1SecSubtotal\r\n    Dim P167 As Decimal = products.1718_SBS.P167_InYearEAL2SecSubtotal\r\n    Dim P173 As Decimal = products.1718_SBS.P173_InYearEAL3SecSubtotal\r\n    Dim P179 As Decimal = products.1718_SBS.P179_InYearMobPriSubtotal\r\n    Dim P185 As Decimal = products.1718_SBS.P185_InYearMobSecSubtotal\r\n    \r\n    \r\n     \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P007+P012+P018+P023+P029+P034+P040+P046+P052+P058+P064+P070+P076+P082+P088+P094+P100+P106+P112+P119+P135+P141+P146+P151+P157+P162+P167+P173+P179+P185\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P293_TotalOtherFactors","Script":" Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P197 As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P198 As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim P241 As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P249 As Decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\n    Dim P252 As Decimal = products.1718_SBS.P252_PFISubtotal\r\n    Dim P255 As Decimal = products.1718_SBS.P255_FringeSubtotal\r\n    Dim P261 As Decimal = products.1718_SBS.P261_Ex1Subtotal\r\n    Dim P265 As Decimal = products.1718_SBS.P265_Ex2Subtotal\r\n    Dim P269 As Decimal = products.1718_SBS.P269_Ex3Subtotal\r\n    Dim P273 As Decimal = products.1718_SBS.P273_Ex4Subtotal\r\n    Dim P277 As Decimal = products.1718_SBS.P277_Ex5Subtotal\r\n    Dim P281 As Decimal = products.1718_SBS.P281_Ex6Subtotal\r\n    Dim P298 As Decimal = products.1718_SBS.P298_Growth\r\n    Dim P300 As Decimal = products.1718_SBS.P300_SBSOutcomeAdjustment\r\n\r\n     \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P197+P198+P241+P245+P249+P252+P255+P261+P265+P269+P273+P277+P281+P298+P300\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P293a_TotalOtherFactors_NoExc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P197 As Decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\n    Dim P198 As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n    Dim P241 As Decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\n    Dim P245 As Decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\n    Dim P249 As Decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\n    Dim P252 As Decimal = products.1718_SBS.P252_PFISubtotal\r\n    Dim P255 As Decimal = products.1718_SBS.P255_FringeSubtotal\r\n  \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P197+P198+P241+P245+P249+P252+P255  \r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":2},{"Name":"P294_InYearTotalOtherFactors","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P199 As Decimal = products.1718_SBS.P199_InYearSparsityLumpSumSubtotal\r\n    Dim P200 As Decimal = products.1718_SBS.P200_InYearSparsityTaperSubtotal\r\n    Dim P242 As Decimal = products.1718_SBS.P242_InYearPriLumpSumSubtotal\r\n    Dim P246 As Decimal = products.1718_SBS.P246_InYearSecLumpSumSubtotal\r\n    Dim P251 As Decimal = products.1718_SBS.P251_InYearSplitSitesSubtotal\r\n    Dim P254 As Decimal = products.1718_SBS.P254_InYearPFISubtotal\r\n    Dim P257 As Decimal = products.1718_SBS.P257_InYearFringeSubtotal\r\n    Dim P264 As Decimal = products.1718_SBS.P264_InYearEx1Subtotal\r\n    Dim P267 As Decimal = products.1718_SBS.P267_InYearEx2Subtotal\r\n    Dim P271 As Decimal = products.1718_SBS.P271_InYearEx3Subtotal\r\n    Dim P275 As Decimal = products.1718_SBS.P275_InYearEx4Subtotal\r\n    Dim P279 As Decimal = products.1718_SBS.P279_InYearEx5Subtotal\r\n    Dim P283 As Decimal = products.1718_SBS.P283_InYearEx6Subtotal \r\n    Dim P299 As Decimal = products.1718_SBS.P299_InYearGrowth\r\n    Dim P301 As Decimal = products.1718_SBS.P301_InYearSBSOutcomeAdjustment\r\n    \r\n     \r\n    \r\n    If AcadFilter = 1 Then       \r\n    Result = P199+P200+P242+P246+P251+P254+P257+P264+p267+P271+P275+P279+P283+P299+P301\r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n            \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P294a_InYearTotalOtherfactors_NoExc","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    \r\n    Dim AcadFilter As Decimal = products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim P199 As Decimal = products.1718_SBS.P199_InYearSparsityLumpSumSubtotal\r\n    Dim P200 As Decimal = products.1718_SBS.P200_InYearSparsityTaperSubtotal\r\n    Dim P242 As Decimal = products.1718_SBS.P242_InYearPriLumpSumSubtotal\r\n    Dim P246 As Decimal = products.1718_SBS.P246_InYearSecLumpSumSubtotal\r\n    Dim P251 As Decimal = products.1718_SBS.P251_InYearSplitSitesSubtotal\r\n    Dim P254 As Decimal = products.1718_SBS.P254_InYearPFISubtotal\r\n    Dim P257 As Decimal = products.1718_SBS.P257_InYearFringeSubtotal\r\n                                                                             \r\n    If AcadFilter = 1  Then       \r\n    Result = P199+P200+P242+P246+P251+P254+P257 \r\n    Else\r\n    Exclude(rid)\r\n    End If\r\n     \r\n    Print(AcadFilter, \"AcadFilter\", rid)     \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":0},{"Name":"P295_DeDelegation","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n  \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim Dedelegation As Decimal = LaToProv([DataSets.Academy_Allocations.AY_2017/18.APT.APT_New_ISB_dataset.APT_New_ISB_dataset.De-delegation]) \r\n    \r\n    \r\n       If F200_SBS_Academies = 1 then \r\n        Result = Dedelegation * -1\r\n        ELSE\r\n        Exclude(rid)\r\n       End If\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n    Print(Dedelegation, \"Dedelegation\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"P296_InYearDedelegation","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P295_Dedelegation As Decimal = Products.1718_SBS.P295_Dedelegation \r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n       If F200_SBS_Academies = 1 then \r\n        Result = (P295_Dedelegation) * P001_1718DaysOpen / Year_Days\r\n        ELSE\r\n        Exclude(rid)\r\n       End If\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n    Print(P295_Dedelegation, \"P295_Dedelegation\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":6},{"Name":"TEST","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\nDim P001 As decimal = products.1718_SBS.P001_1718DaysOpen\r\nDim P004 As decimal = products.1718_SBS.P004_PriRate\r\nDim P005 As decimal = products.1718_SBS.P005_PriBESubtotal\r\nDim P006 As decimal = products.1718_SBS.P006_NSEN_PriBE\r\nDim P006a As decimal = products.1718_SBS.P006a_NSEN_PriBE_percent\r\nDim P007 As decimal = products.1718_SBS.P007_InYearPriBE_Subtotal\r\nDim P009 As decimal = products.1718_SBS.P009_KS3Rate\r\nDim P010 As decimal = products.1718_SBS.P010_KS3_BESubtotal\r\nDim P011 As decimal = products.1718_SBS.P011_NSEN_KS3BE_percent\r\nDim P011a As decimal = products.1718_SBS.P011a_NSEN_KS3BE_percent                    \r\nDim P012 As decimal = products.1718_SBS.P012_InYearKS3_BESubtotal                             \r\nDim P014 As decimal = products.1718_SBS.P014_KS4Rate                                                          \r\nDim P015 As decimal = products.1718_SBS.P015_KS4_BESubtotal                                              \r\nDim P016 As decimal = products.1718_SBS.P016_NSEN_KS4BE                                                            \r\nDim P016a As decimal = products.1718_SBS.P016a_NSEN_KS4BE_percent                                     \r\nDim P018 As decimal = products.1718_SBS.P018_InYearKS4_BESubtotal                               \r\nDim P019 As decimal = products.1718_SBS.P019_PriFSMFactor                                                   \r\nDim P021 As decimal = products.1718_SBS.P021_PriFSMRate                                                             \r\nDim P022 As decimal = products.1718_SBS.P022_PriFSMSubtotal                        \r\nDim P023 As decimal = products.1718_SBS.P023_InYearPriFSMSubtotal\r\nDim P024 As decimal = products.1718_SBS.P024_PriFSM6Factor\r\nDim P026 As decimal = products.1718_SBS.P026_PriFSM6Rate\r\nDim P027 As decimal = products.1718_SBS.P027_PriFSM6Subtotal\r\nDim P028 As decimal = products.1718_SBS.P028_NSENFSMPri\r\nDim P028a As decimal = products.1718_SBS.P028a_NSENFSMPri_Percent\r\nDim P029 As decimal = products.1718_SBS.P029_InYearPriFSM6Subtotal\r\nDim P030 As decimal = products.1718_SBS.P030_SecFSMFactor\r\nDim P032 As decimal = products.1718_SBS.P032_SecFSMRate\r\nDim P033 As decimal = products.1718_SBS.P033_SecFSMSubtotal\r\nDim P034 As decimal = products.1718_SBS.P034_InYearSecFSMSubtotal\r\nDim P035 As decimal = products.1718_SBS.P035_SecFSM6Factor\r\nDim P037 As decimal = products.1718_SBS.P037_SecFSM6Rate\r\nDim P038 As decimal = products.1718_SBS.P038_SecFSM6Subtotal\r\nDim P039 As decimal = products.1718_SBS.P039_NSENFSMSec\r\nDim P039a As decimal = products.1718_SBS.P039a_NSENFSMSec_Percent\r\nDim P040 As decimal = products.1718_SBS.P040_InYearSecFSM6Subtotal\r\nDim P041 As decimal = products.1718_SBS.P041_IDACIFPriFactor\r\nDim P043 As decimal = products.1718_SBS.P043_IDACIFPriRate\r\nDim P044 As decimal = products.1718_SBS.P044_IDACIFPriSubtotal\r\nDim P045 As decimal = products.1718_SBS.P045_NSENIDACIFPri\r\nDim P045a As decimal = products.1718_SBS.P045a_NSENIDACIFPri_Percent\r\nDim P046 As decimal = products.1718_SBS.P046_InYearIDACIFPriSubtotal\r\nDim P047 As decimal = products.1718_SBS.P047_IDACIEPriFactor\r\nDim P049 As decimal = products.1718_SBS.P049_IDACIEPriRate\r\nDim P050 As decimal = products.1718_SBS.P050_IDACIEPriSubtotal\r\nDim P051 As decimal = products.1718_SBS.P051_NSENIDACIEPri\r\nDim P051a As decimal = products.1718_SBS.P051a_NSENIDACIEPri_Percent\r\nDim P052 As decimal = products.1718_SBS.P052_InYearIDACIEPriSubtotal\r\nDim P053 As decimal = products.1718_SBS.P053_IDACIDPriFactor\r\nDim P055 As decimal = products.1718_SBS.P055_IDACIDPriRate\r\nDim P056 As decimal = products.1718_SBS.P056_IDACIDPriSubtotal\r\nDim P057 As decimal = products.1718_SBS.P057_NSENIDACIDPri\r\nDim P057a As decimal = products.1718_SBS.P057a_NSENIDACIDPri_Percent\r\nDim P058 As decimal = products.1718_SBS.P058_InYearIDACIDPriSubtotal\r\nDim P059 As decimal = products.1718_SBS.P059_IDACICPriFactor\r\nDim P061 As decimal = products.1718_SBS.P061_IDACICPriRate\r\nDim P062 As decimal = products.1718_SBS.P062_IDACICPriSubtotal\r\nDim P063 As decimal = products.1718_SBS.P063_NSENIDACICPri\r\nDim P063a As decimal = products.1718_SBS.P063a_NSENIDACICPri_Percent\r\nDim P064 As decimal = products.1718_SBS.P064_InYearIDACICPriSubtotal\r\nDim P065 As decimal = products.1718_SBS.P065_IDACIBPriFactor\r\nDim P067 As decimal = products.1718_SBS.P067_IDACIBPriRate\r\nDim P068 As decimal = products.1718_SBS.P068_IDACIBPriSubtotal\r\nDim P069 As decimal = products.1718_SBS.P069_NSENIDACIBPri\r\nDim P069a As decimal = products.1718_SBS.P069a_NSENIDACIBPri_Percent\r\nDim P070 As decimal = products.1718_SBS.P070_InYearIDACIBPriSubtotal\r\nDim P071 As decimal = products.1718_SBS.P071_IDACIAPriFactor\r\nDim P073 As decimal = products.1718_SBS.P073_IDACIAPriRate\r\nDim P074 As decimal = products.1718_SBS.P074_IDACIAPriSubtotal\r\nDim P075 As decimal = products.1718_SBS.P075_NSENIDACIAPri\r\nDim P075a As decimal = products.1718_SBS.P075a_NSENIDACIAPri_Percent\r\nDim P076 As decimal = products.1718_SBS.P076_InYearIDACIAPriSubtotal\r\nDim P077 As decimal = products.1718_SBS.P077_IDACIFSecFactor\r\nDim P079 As decimal = products.1718_SBS.P079_IDACIFSecRate\r\nDim P080 As decimal = products.1718_SBS.P080_IDACIFSecSubtotal\r\nDim P081 As decimal = products.1718_SBS.P081_NSENIDACIFSec\r\nDim P081a As decimal = products.1718_SBS.P081a_NSENIDACIFSec_Percent\r\nDim P082 As decimal = products.1718_SBS.P082_InYearIDACIFSecSubtotal\r\nDim P083 As decimal = products.1718_SBS.P083_IDACIESecFactor\r\nDim P085 As decimal = products.1718_SBS.P085_IDACIESecRate\r\nDim P086 As decimal = products.1718_SBS.P086_IDACIESecSubtotal\r\nDim P087 As decimal = products.1718_SBS.P087_NSENIDACIESec\r\nDim P87a As decimal = products.1718_SBS.P087a_NSENIDACIESec_Percent\r\nDim P088 As decimal = products.1718_SBS.P088_InYearIDACIESecSubtotal\r\nDim P089 As decimal = products.1718_SBS.P089_IDACIDSecFactor\r\nDim P091 As decimal = products.1718_SBS.P091_IDACIDSecRate\r\nDim P092 As decimal = products.1718_SBS.P092_IDACIDSecSubtotal\r\nDim P093 As decimal = products.1718_SBS.P093_NSENIDACIDSec\r\nDim P093a As decimal = products.1718_SBS.P093a_NSENIDACIDSec_Percent\r\nDim P094 As decimal = products.1718_SBS.P094_InYearIDACIDSecSubtotal\r\nDim P095 As decimal = products.1718_SBS.P095_IDACICSecFactor\r\nDim P097 As decimal = products.1718_SBS.P097_IDACICSecRate\r\nDim P098 As decimal = products.1718_SBS.P098_IDACICSecSubtotal\r\nDim P099 As decimal = products.1718_SBS.P099_NSENIDACICSec\r\nDim P099a As decimal = products.1718_SBS.P099a_NSENIDACISec_Percent\r\nDim P100 As decimal = products.1718_SBS.P100_InYearIDACICSecSubtotal\r\nDim P101 As decimal = products.1718_SBS.P101_IDACIBSecFactor\r\nDim P103 As decimal = products.1718_SBS.P103_IDACIBSecRate\r\nDim P104 As decimal = products.1718_SBS.P104_IDACIBSecSubtotal\r\nDim P105 As decimal = products.1718_SBS.P105_NSENIDACIBSec\r\nDim P105a As decimal = products.1718_SBS.P105a_NSENIDACIBSec_Percent\r\nDim P106 As decimal = products.1718_SBS.P106_InYearIDACIBSecSubtotal\r\nDim P107 As decimal = products.1718_SBS.P107_IDACIASecFactor\r\nDim P109 As decimal = products.1718_SBS.P109_IDACIASecRate\r\nDim P110 As decimal = products.1718_SBS.P110_IDACIASecSubtotal\r\nDim P111 As decimal = products.1718_SBS.P111_NSENIDACIASec\r\nDim P111a As decimal = products.1718_SBS.P111a_NSENIDACIASec_Percent\r\nDim P112 As decimal = products.1718_SBS.P112_InYearIDACIASecSubtotal\r\nDim P114 As decimal = products.1718_SBS.P114_LACFactor\r\nDim P116 As decimal = products.1718_SBS.P116_LACRate\r\nDim P117 As decimal = products.1718_SBS.P117_LACSubtotal\r\nDim P118 As decimal = products.1718_SBS.P118_NSENLAC\r\nDim P118a As decimal = products.1718_SBS.P118a_NSENLAC_Percent\r\nDim P119 As decimal = products.1718_SBS.P119_InYearLACSubtotal\r\nDim P120 As decimal = products.1718_SBS.P120_PPAindicator\r\nDim P121 As decimal = products.1718_SBS.P121_PPAY5to6Proportion73\r\nDim P122 As decimal = products.1718_SBS.P122_PPAY5to6Proportion78\r\nDim P122a As decimal = products.1718_SBS.P122a_PPAY7378ForFAPOnly\r\nDim P123 As decimal = products.1718_SBS.P123_PPAY1to4ProportionUnder\r\nDim P124 As decimal = products.1718_SBS.P124_PPAY5to6NOR\r\nDim P125 As decimal = products.1718_SBS.P125_PPAY1to4NOR\r\nDim P126 As decimal = products.1718_SBS.P126_PPAPriNOR\r\nDim P127 As decimal = products.1718_SBS.P127_PPARate\r\nDim P128 As decimal = products.1718_SBS.P128_PPAWeighting\r\nDim P129 As decimal = products.1718_SBS.P129_PPAPupilsY5to6NotAchieving\r\nDim P130 As decimal = products.1718_SBS.P130_PPAPupilsY1to4NotAchieving\r\nDim P131 As decimal = products.1718_SBS.P131_PPATotalPupilsY1to6NotAchieving\r\nDim P132 As decimal = products.1718_SBS.P132_PPATotalProportionNotAchieving\r\nDim P133 As decimal = products.1718_SBS.P133_PPATotalFunding\r\nDim P134 As decimal = products.1718_SBS.P134_NSENPPA\r\nDim P134a As decimal = products.1718_SBS.P134a_NSENPPA_Percent\r\nDim P135 As decimal = products.1718_SBS.P135_InYearPPASubtotal\r\nDim P136 As decimal = products.1718_SBS.P136_SecPAFactor\r\nDim P138 As decimal = products.1718_SBS.P138_SecPARate\r\nDim P139 As decimal = products.1718_SBS.P139_SecPASubtotal\r\nDim P140 As decimal = products.1718_SBS.P140_NSENSecPA\r\nDim P140a As decimal = products.1718_SBS.P140a_NSENSecPA_Percent\r\nDim P141 As decimal = products.1718_SBS.P141_InYearSecPASubtotal\r\nDim P142 As decimal = products.1718_SBS.P142_EAL1PriFactor\r\nDim P144 As decimal = products.1718_SBS.P144_EAL1PriRate\r\nDim P145 As decimal = products.1718_SBS.P145_EAL1PriSubtotal\r\nDim P146 As decimal = products.1718_SBS.P146_InYearEAL1PriSubtotal\r\nDim P147 As decimal = products.1718_SBS.P147_EAL2PriFactor\r\nDim P149 As decimal = products.1718_SBS.P149_EAL2PriRate\r\nDim P150 As decimal = products.1718_SBS.P150_EAL2PriSubtotal\r\nDim P151 As decimal = products.1718_SBS.P151_InYearEAL2PriSubtotal\r\nDim P152 As decimal = products.1718_SBS.P152_EAL3PriFactor\r\nDim P154 As decimal = products.1718_SBS.P154_EAL3PriRate\r\nDim P155 As decimal = products.1718_SBS.P155_EAL3PriSubtotal\r\nDim P156 As decimal = products.1718_SBS.P156_NSENPriEAL\r\nDim P156a As decimal = products.1718_SBS.P156a_NSENPriEAL_Percent\r\nDim P157 As decimal = products.1718_SBS.P157_InYearEAL3PriSubtotal\r\nDim P158 As decimal = products.1718_SBS.P158_EAL1SecFactor\r\nDim P160 As decimal = products.1718_SBS.P160_EAL1SecRate\r\nDim P161 As decimal = products.1718_SBS.P161_EAL1SecSubtotal\r\nDim P162 As decimal = products.1718_SBS.P162_InYearEAL1SecSubtotal\r\nDim P163 As decimal = products.1718_SBS.P163_EAL2SecFactor\r\nDim P165 As decimal = products.1718_SBS.P165_EAL2SecRate\r\nDim P166 As decimal = products.1718_SBS.P166_EAL2SecSubtotal\r\nDim P167 As decimal = products.1718_SBS.P167_InYearEAL2SecSubtotal\r\nDim P168 As decimal = products.1718_SBS.P168_EAL3SecFactor\r\nDim P170 As decimal = products.1718_SBS.P170_EAL3SecRate\r\nDim P171 As decimal = products.1718_SBS.P171_EAL3SecSubtotal\r\nDim P172 As decimal = products.1718_SBS.P172_NSENSecEAL\r\nDim P172a As decimal = products.1718_SBS.P172a_NSENSecEAL_Percent\r\nDim P173 As decimal = products.1718_SBS.P173_InYearEAL3SecSubtotal\r\nDim P174 As decimal = products.1718_SBS.P174_MobPriFactor\r\nDim P176 As decimal = products.1718_SBS.P176_MobPriRate\r\nDim P177 As decimal = products.1718_SBS.P177_MobPriSubtotal\r\nDim P178 As decimal = products.1718_SBS.P178_NSENMobPri\r\nDim P178a As decimal = products.1718_SBS.P178a_NSENMobPri_Percent\r\nDim P179 As decimal = products.1718_SBS.P179_InYearMobPriSubtotal\r\nDim P180 As decimal = products.1718_SBS.P180_MobSecFactor\r\nDim P182 As decimal = products.1718_SBS.P182_MobSecRate\r\nDim P183 As decimal = products.1718_SBS.P183_MobSecSubtotal\r\nDim P184 As decimal = products.1718_SBS.P184_NSENMobSec\r\nDim P184a As decimal = products.1718_SBS.P184a_NSENMobSec_Percent\r\nDim P185 As decimal = products.1718_SBS.P185_InYearMobSecSubtotal\r\nDim P185a As decimal = products.1718_SBS.P185a_Phase\r\nDim P186 As decimal = products.1718_SBS.P186_SparsityTaperFlagPri\r\nDim P187 As decimal = products.1718_SBS.P187_SparsityTaperFlagMid\r\nDim P188 As decimal = products.1718_SBS.P188_SparsityTaperFlagSec\r\nDim P189 As decimal = products.1718_SBS.P189_SparsityTaperFlagAllthru\r\nDim P190 As decimal = products.1718_SBS.P190_SparsityUnit\r\nDim P191 As decimal = products.1718_SBS.P191_SparsityDistance\r\nDim P192 As decimal = products.1718_SBS.P192_SparsityDistThreshold\r\nDim P193 As decimal = products.1718_SBS.P193_SparsityDistMet_YN\r\nDim P194 As decimal = products.1718_SBS.P194_SparsityAveYGSize\r\nDim P195 As decimal = products.1718_SBS.P195_SparsityYGThreshold\r\nDim P196 As decimal = products.1718_SBS.P196_SparsityYGThresholdMet_YN\r\nDim P197 As decimal = products.1718_SBS.P197_SparsityLumpSumSubtotal\r\nDim P198 As decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\nDim P198a As decimal = products.1718_SBS.P198a_SubtotalLump_Taper_For_FAP_Only\r\nDim P199 As decimal = products.1718_SBS.P199_InYearSparsityLumpSumSubtotal\r\nDim P200 As decimal = products.1718_SBS.P200_InYearSparsityTaperSubtotal\r\nDim P200a As decimal = products.1718_SBS.P200a_InYear_SubtotalLump_Taper_for_FAP_Only\r\nDim P212 As decimal = products.1718_SBS.P212_PYG\r\nDim P213 As decimal = products.1718_SBS.P213_SYG\r\nDim P236 As decimal = products.1718_SBS.P236_NSENSparsity\r\nDim P236a As decimal = products.1718_SBS.P236a_NSENSparsity_Percent\r\nDim P239 As decimal = products.1718_SBS.P239_PriLumpSumFactor\r\nDim P240 As decimal = products.1718_SBS.P240_PriLumpSumRate\r\nDim P241 As decimal = products.1718_SBS.P241_PriLumpSumSubtotal\r\nDim P242 As decimal = products.1718_SBS.P242_InYearPriLumpSumSubtotal\r\nDim P243 As decimal = products.1718_SBS.P243_SecLumpSumFactor\r\nDim P244 As decimal = products.1718_SBS.P244_SecLumpSumRate\r\nDim P245 As decimal = products.1718_SBS.P245_SecLumpSumSubtotal\r\nDim P246 As decimal = products.1718_SBS.P246_InYearSecLumpSumSubtotal\r\nDim P247 As decimal = products.1718_SBS.P247_NSENLumpSumPri\r\nDim P247a As decimal = products.1718_SBS.P247a_NSENLumpSumPri_Percent\r\nDim P248 As decimal = products.1718_SBS.P248_NSENLumpSumSec\r\nDim P248a As decimal = products.1718_SBS.P248a_NSENLumpSumSec_Percent\r\nDim P249 As decimal = products.1718_SBS.P249_SplitSitesSubtotal\r\nDim P250 As decimal = products.1718_SBS.P250_NSENSplitSites\r\nDim P250a As decimal = products.1718_SBS.P250a_NSENSplitSites_Percent\r\nDim P251 As decimal = products.1718_SBS.P251_InYearSplitSitesSubtotal\r\nDim P252 As decimal = products.1718_SBS.P252_PFISubtotal\r\nDim P253 As decimal = products.1718_SBS.P253_NSENPFI\r\nDim P253a As decimal = products.1718_SBS.P253a_NSENPFI_Percent\r\nDim P254 As decimal = products.1718_SBS.P254_InYearPFISubtotal\r\nDim P255 As decimal = products.1718_SBS.P255_FringeSubtotal\r\nDim P257 As decimal = products.1718_SBS.P257_InYearFringeSubtotal\r\nDim P261 As decimal = products.1718_SBS.P261_Ex1Subtotal\r\nDim P262 As decimal = products.1718_SBS.P262_NSENEx1\r\nDim P262a As decimal = products.1718_SBS.P262a_NSENEx1_Percent\r\nDim P264 As decimal = products.1718_SBS.P264_InYearEx1Subtotal\r\nDim P265 As decimal = products.1718_SBS.P265_Ex2Subtotal\r\nDim P266 As decimal = products.1718_SBS.P266_NSENEx2                                       \r\nDim P266a As decimal = products.1718_SBS.P266a_NSENEx2_Percent\r\nDim P267 As decimal = products.1718_SBS.P267_InYearEx2Subtotal\r\nDim P269 As decimal = products.1718_SBS.P269_Ex3Subtotal\r\nDim P270 As decimal = products.1718_SBS.P270_NSENEx3\r\nDim P270a As decimal = products.1718_SBS.P270a_NSENEx3Percent\r\nDim P271 As decimal = products.1718_SBS.P271_InYearEx3Subtotal\r\nDim P273 As decimal = products.1718_SBS.P273_Ex4Subtotal\r\nDim P274 As decimal = products.1718_SBS.P274_NSENEx4\r\nDim P274a As decimal = products.1718_SBS.P274a_NSENEx4_Percent\r\nDim P275 As decimal = products.1718_SBS.P275_InYearEx4Subtotal\r\nDim P277 As decimal = products.1718_SBS.P277_Ex5Subtotal\r\nDim P278 As decimal = products.1718_SBS.P278_NSENEx5\r\nDim P278a As decimal = products.1718_SBS.P278a_NSENEx5_Percent\r\nDim P279 As decimal = products.1718_SBS.P279_InYearEx5Subtotal\r\nDim P281 As decimal = products.1718_SBS.P281_Ex6Subtotal\r\nDim P282 As decimal = products.1718_SBS.P282_NSENEx6\r\nDim P282a As decimal = products.1718_SBS.P282a_NSENEx6_Percent\r\nDim P283 As decimal = products.1718_SBS.P283_InYearEx6Subtotal\r\nDim P284 As decimal = products.1718_SBS.P284_NSENSubtotal\r\nDim P285 As decimal = products.1718_SBS.P285_InYearNSENSubtotal\r\nDim P286 As decimal = products.1718_SBS.P286_PriorYearAdjustmentSubtotal\r\nDim P287 As decimal = products.1718_SBS.P287_InYearPriorYearAdjustmentSubtotal\r\nDim P298 As decimal = products.1718_SBS.P298_Growth\r\nDim P299 As decimal = products.1718_SBS.P299_InYearGrowth\r\nDim P300 As decimal = products.1718_SBS.P300_SBSOutcomeAdjustment\r\nDim P301 As decimal = products.1718_SBS.P301_InYearSBSOutcomeAdjustment\r\nDim Lump As decimal = products.1718_SBS.Lump_Sum_Total\r\nDim InYe As decimal = products.1718_SBS.InYearLumpSum\r\nDim P288 As decimal = products.1718_SBS.P288_SBSFundingTotal\r\nDim P289 As decimal = products.1718_SBS.P289_InYearSBSFundingTotal\r\nDim P290 As decimal = products.1718_SBS.P290_ISBTotalSBSFunding\r\nDim P291 As decimal = products.1718_SBS.P291_TotalPupilLedFactors\r\nDim P292 As decimal = products.1718_SBS.P292_InYearTotalPupilLedfactors\r\nDim P293 As decimal = products.1718_SBS.P293_TotalOtherFactors\r\nDim P293a As decimal = products.1718_SBS.P293a_TotalOtherFactors_NoExc\r\nDim P294 As decimal = products.1718_SBS.P294_InYearTotalOtherFactors\r\nDim P294A As decimal = products.1718_SBS.P294a_InYearTotalOtherFactors_NoExc\r\nDim P295 As decimal = products.1718_SBS.P295_Dedelegation\r\nDim P296 As decimal = products.1718_SBS.P296_InYearDedelegation\r\nDim P297 As decimal = products.1718_SBS.P297_DedelegationRetained\r\nDim ExSu As decimal = products.1718_SBS.ExSubtotal\r\nDim Spar As decimal = products.1718_SBS.SparsityTotal\r\n\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Totals","DecimalPlaces":0},{"Name":"P297_DedelegationRetained","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As String = datasets.Administration.Providers.Academy_Information.Academy_Parameters.Funding_Basis(2017181)\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P295_Dedelegation As Decimal = Products.1718_SBS.P295_Dedelegation \r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n    \r\n      If F200_SBS_Academies = 1 then \r\n            If F100_AllAcademies = 17183 then\r\n                IF P001_1718DaysOpen = 365 THEN \r\n                    Result = 0\r\n                ELSE \r\n                    Result = (P001_1718DaysOpen - 153) / Year_Days * - P295_Dedelegation\r\n                End If\r\n            End If\r\n            If (F100_AllAcademies = 17181) Or (F100_AllAcademies = 17182) then\r\n                Result = 0\r\n            End If        \r\n      ELSE\r\n            Exclude(rid)\r\n      End If\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n    Print(P295_Dedelegation, \"P295_Dedelegation\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"Dedelegation retained by LA","DecimalPlaces":6},{"Name":"ExSubtotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F100_AllAcademies As Decimal = Products.1718_Global_Variables.F100_AllAcademies \r\n    Dim FundingBasis As Decimal = products.1718_Global_Variables.F900_FundingBasis\r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P261_Ex1Subtotal As Decimal = Products.1718_SBS.P261_Ex1Subtotal\r\n    Dim P265_Ex2Subtotal As Decimal = Products.1718_SBS.P265_Ex2Subtotal\r\n    Dim P269_Ex3Subtotal As Decimal = Products.1718_SBS.P269_Ex3Subtotal\r\n    Dim P273_Ex4Subtotal As Decimal = Products.1718_SBS.P273_Ex4Subtotal\r\n    Dim P277_Ex5Subtotal As Decimal = Products.1718_SBS.P277_Ex5Subtotal\r\n    Dim P281_Ex6Subtotal As Decimal = Products.1718_SBS.P281_Ex6Subtotal\r\n    Dim P001_1718DaysOpen As Decimal = Products.1718_SBS.P001_1718DaysOpen\r\n    Dim Year_Days As Decimal = 365\r\n\r\n    \r\n       If F200_SBS_Academies = 1 then \r\n            \r\n            Result = P261_Ex1Subtotal + P265_Ex2Subtotal + P269_Ex3Subtotal + P273_Ex4Subtotal + P277_Ex5Subtotal + P281_Ex6Subtotal\r\n             \r\n       ELSE\r\n       Exclude(rid)\r\n      End If\r\n\r\n    Print(F100_AllAcademies, \"F100_AllAcademies\", rid)\r\n    Print(FundingBasis, \"FundingBasis\", rid)\r\n    Print(F200_SBS_Academies, \"F200_SBS_Academies\", rid)\r\n    Print(P261_Ex1Subtotal, \"P261_Ex1Subtotal\", rid)\r\n    Print(P265_Ex2Subtotal, \"P265_Ex2Subtotal\", rid)\r\n    Print(P269_Ex3Subtotal, \"P269_Ex3Subtotal\", rid)\r\n    Print(P273_Ex4Subtotal, \"P273_Ex4Subtotal\", rid)\r\n    Print(P277_Ex5Subtotal, \"P277_Ex5Subtotal\", rid)\r\n    Print(P281_Ex6Subtotal, \"P281_Ex6Subtotal\", rid)\r\n    Print(P001_1718DaysOpen, \"P001_1718DaysOpen\", rid)\r\n    Print(Year_Days, \"Year_Days\", rid)\r\n    \r\n    \r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FAP Products","DecimalPlaces":6},{"Name":"SparsityTotal","Script":"Public Function GetProductResult(rid As String) As Decimal 'change to As String if text product\r\n    Dim result As Decimal = 0 'change to As String if text product\r\n    \r\n    Dim F200_SBS_Academies As Decimal = Products.1718_Global_Variables.F200_SBS_Academies\r\n    Dim P197 As Decimal = products.1718_SBS.P197_SparsitylumpSumSubtotal\r\n    Dim P198 As Decimal = products.1718_SBS.P198_SparsityTaperSubtotal\r\n\r\n    \r\n       If F200_SBS_Academies = 1 then \r\n            \r\n            Result = P197 + P198\r\n             \r\n       ELSE\r\n       Exclude(rid)\r\n      End If\r\n\r\n    Return result\r\nEnd Function\r\n","ProductType":"Funding","ScenarioName":"1718_SBS","FolderName":"FAP Products","DecimalPlaces":6}]