name: $(Rev:r)

pool:
  vmImage: windows-2019

resources:
  repositories:
  - repository: self
  - repository: funding-blocks
    type: github
    name: SkillsFundingAgency/funding-platform-building-blocks
    ref: refs/heads/master
    endpoint: 'Github (ESFA)'

trigger:
  branches:
    include:
    - providers
    - fdps
  paths:
    include:
    - CalculateFunding.Api.Providers
    - CalculateFunding.Functions.Providers
    - CalculateFunding.Services.Providers
    - CalculateFunding.Services.Providers.UnitTests
    - CalculateFunding.Services.Core
    - DevOps/search-indexes/providersindex
    - DevOps/search-indexers/providersindexer
    - CalculateFunding.Models.Providers
    - DevOps/provider-storage
    - DevOps/search-datasources/providersdatasource
    - CalculateFunding.Models.ProviderLegacy

variables:
 - name: ProjectName
   value: 'Providers'
 - name: BuildApi
   value: true
 - name: BuildFunction
   value: true
 - name: DOTNET_SKIP_FIRST_TIME_EXPERIENCE
   value: '1'
 - name: DOTNET_CLI_TELEMETRY_OPTOUT
   value: '1'
 - group: 'Dotnet Core SDK Version'


steps:
- template: azure-pipelines-templates/cfs/standard-service-ci-build.yml@funding-blocks
  parameters:
    ProjectName: $(ProjectName)
    DotnetCoreSdkVersion: $(DotnetCoreSdkVersion)
    BuildApi: ${{ variables.BuildApi }}
    BuildFunction: ${{ variables.BuildFunction }}
    