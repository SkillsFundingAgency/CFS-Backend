name: $(Rev:r)

pool:
  vmImage: windows-2019

resources:
  repositories:
  - repository: self
  - repository: funding-blocks
    type: github
    name: SkillsFundingAgency/funding-platform-building-blocks
    ref: refs/heads/master
    endpoint: 'Github (ESFA)'

trigger:
  branches:
    include:
    - master
    - providers
    - fdps
  paths:
    include:
    - CalculateFunding.Api.Policy
    - CalculateFunding.Functions.Policy
    - CalculateFunding.Services.Policy
    - CalculateFunding.Services.Core
    - CalculateFunding.Models.Policy
    - CalculateFunding.Api.Policy.UnitTests
    - CalculateFunding.Functions.Policy.UnitTests
    - CalculateFunding.Services.Policy.UnitTests

variables:
 - name: ProjectName
   value: 'Policy'
 - name: BuildApi
   value: true
 - name: BuildFunction
   value: true
 - name: DOTNET_SKIP_FIRST_TIME_EXPERIENCE
   value: '1'
 - name: DOTNET_CLI_TELEMETRY_OPTOUT
   value: '1'
 - group: 'Dotnet Core SDK Version'


steps:
- template: azure-pipelines-templates/cfs/standard-service-ci-build.yml@funding-blocks
  parameters:
    ProjectName: $(ProjectName)
    DotnetCoreSdkVersion: $(DotnetCoreSdkVersion)
    BuildApi: ${{ variables.BuildApi }}
    BuildFunction: ${{ variables.BuildFunction }}
    